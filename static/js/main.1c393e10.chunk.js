(this["webpackJsonptool-catalogue"]=this["webpackJsonptool-catalogue"]||[]).push([[0],{104:function(e,t,r){e.exports=r(159)},109:function(e,t,r){},111:function(e,t,r){},112:function(e,t,r){},113:function(e,t,r){},114:function(e,t,r){},145:function(e,t){},146:function(e,t){},152:function(e,t){},154:function(e,t){},159:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),o=r(31),i=r.n(o),c=(r(109),r(2)),l=r.n(c),s=r(13),u=r(28),p=r(11);r(111),r(112),r(113),r(114);var f=r(26),m=r.n(f),d=r(44),h=r.n(d),v=function(e){return e&&e.references?a.a.createElement("div",{className:"tags",style:{display:"flex",flexWrap:"wrap"}},e.references.map((function(e,t){return a.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px",backgroundColor:e.color,color:e.textColor}},e.title)}))):null},g=function(e){var t=e.tile?e.tile:{},r=Object(n.useState)(""),o=Object(p.a)(r,2);o[0],o[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},a.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:300,maxHeight:300,overflow:"auto"}},a.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){e.onClick&&e.onClick(t)}},a.a.createElement("div",null,t.title),a.a.createElement("div",{style:{textAlign:"center",margin:20,marginTop:40,height:120}},a.a.createElement("img",{style:{height:"auto",width:80},src:t.icon})),a.a.createElement(v,{references:t.references}))),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&a.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,rel:"noopener noreferrer",target:"_blank"},"Jump to"),t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,rel:"noopener noreferrer",target:"_blank"},"Details"))))},b=r(84),x=function(e){var t=e.tile?e.tile:{},r=Object(n.useState)(""),o=Object(p.a)(r,2),i=o[0],c=o[1],l=Object(n.useState)(null),s=Object(p.a)(l,2),u=s[0],f=s[1];return Object(n.useEffect)((function(){t.contentRef&&m.a.get(t.contentRef).then((function(e){var t=new b.QuillDeltaToHtmlConverter(e.data.ops);c(t.convert())})).catch((function(e){404!==e.response.status&&f(e.message)}))})),a.a.createElement(a.a.Fragment,null,u&&a.a.createElement("div",null,u),a.a.createElement("div",{onClick:e.onClose,style:{backgroundColor:t.color,color:t.textcolor,width:"100vw",height:"100vh",overflow:"auto"}},a.a.createElement("div",null,a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",null," ",a.a.createElement("img",{style:{margin:"1vh",height:"10vh",width:"auto"},src:t.icon})),a.a.createElement("div",{style:{height:"10vh",width:"auto"}},a.a.createElement("div",{className:"fullSizeHeading",style:{padding:"3vh",fontSize:"5vh",textOverflow:"nowrap",whiteSpace:"no-wrap"}},t.title),a.a.createElement("div",{className:"fullSizeDescription",style:{paddingLeft:"3vh",fontSize:"3vh"}},t.inShort))),a.a.createElement("div",{style:{height:"80vh",overflow:"auto",backgroundColor:"#ffffff",color:"#000000",padding:"20px"}},a.a.createElement(v,{references:t.references}),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&a.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,target:"_blank"},"Jump to"),t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:i}})),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&a.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,target:"_blank"},"Jump to"),t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")))))},w=r(180),y=r(97),E=r(32),O=r(96),j=r(86),k=r(87),S=r(143),C=(r(147),["User.Read.All","User.ReadWrite.All","mail.send","Files.ReadWrite.All"]),T={auth:{clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",redirectUri:window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,authority:"https://login.microsoftonline.com/common"}};new E.UserAgentApplication(T).handleRedirectCallback((function(e,t){}));var A=new E.UserAgentApplication(T),I=new j.MSALAuthenticationProviderOptions(C),P={authProvider:new k.ImplicitMSALAuthenticationProvider(A,I)};function N(){return O.a.initWithMiddleware(P)}function _(e){return new Promise(function(){var t=Object(s.a)(l.a.mark((function t(r,n){var a,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=N(),t.next=4,a.api("/me/drive/items/".concat(e.id,":/tile.json:")).get();case 4:o=t.sent,m.a.get(o["@microsoft.graph.downloadUrl"]).then((function(e){r(e.data)})),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r){return t.apply(this,arguments)}}())}var R={me:function(){return new Promise(function(){var e=Object(s.a)(l.a.mark((function e(t,r){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N(),e.prev=1,e.next=4,n.api("/me").get();case 4:return a=e.sent,e.abrupt("return",t(a));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}())},initStorage:function(){return new Promise(function(){var e=Object(s.a)(l.a.mark((function e(t,r){var n,a,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N(),e.prev=1,e.next=4,n.api("/me/drive/root:/ZTICKYBAR").get();case 4:return a=e.sent,e.abrupt("return",t(a));case 8:if(e.prev=8,e.t0=e.catch(1),404!==e.t0.statusCode){e.next=24;break}return e.prev=11,o={name:"ZTICKYBAR",folder:{},"@microsoft.graph.conflictBehavior":"rename"},e.next=15,n.api("/me/drive/root/children").post(o);case 15:return i=e.sent,e.abrupt("return",t(i));case 19:return e.prev=19,e.t1=e.catch(11),e.abrupt("return",r(e.t1));case 22:e.next=25;break;case 24:return e.abrupt("return",r(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,8],[11,19]])})));return function(t,r){return e.apply(this,arguments)}}())},initTileStorage:function(){return new Promise(function(){var e=Object(s.a)(l.a.mark((function e(t,r){var n,a,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=N(),e.prev=1,e.next=4,n.api("/me/drive/root:/ZTICKYBAR/tiles").get();case 4:return a=e.sent,e.abrupt("return",t(a));case 8:if(e.prev=8,e.t0=e.catch(1),404!==e.t0.statusCode){e.next=24;break}return e.prev=11,o={name:"tiles",folder:{},"@microsoft.graph.conflictBehavior":"rename"},e.next=15,n.api("/me/drive/root:/ZTICKYBAR:/children").post(o);case 15:return i=e.sent,e.abrupt("return",t(i));case 19:return e.prev=19,e.t1=e.catch(11),e.abrupt("return",r(e.t1));case 22:e.next=25;break;case 24:return e.abrupt("return",r(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,8],[11,19]])})));return function(t,r){return e.apply(this,arguments)}}())},addTile:function(e,t){return new Promise(function(){var r=Object(s.a)(l.a.mark((function r(n,a){var o,i,c,u,p,f,d,v,g,b;return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return o=N(),r.prev=1,i={name:t.title,folder:{},"@microsoft.graph.conflictBehavior":"replace"},r.next=5,o.api("/me/drive/items/".concat(e.id,"/children")).post(i);case 5:return c=r.sent,r.next=8,o.api("/me/drive/items/".concat(c.id,":/tile.json:/content")).put(t);case 8:return u=r.sent,p=h.a.keys(t),f=[],p.forEach((function(e){"references"!==e&&f.push([e,t[e]])})),d=S.utils.book_new(),v=S.utils.aoa_to_sheet(f),S.utils.book_append_sheet(d,v,"ZTICKYBAR"),g={bookType:"xlsx",bookSST:!1,type:"array"},b=S.write(d,g),r.next=20,o.api("/me/drive/items/".concat(c.id,":/tile.xlsx:/content")).put(b);case 20:return r.sent,m.a.request({responseType:"arraybuffer",url:t.icon,method:"get"}).then(function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.api("/me/drive/items/".concat(c.id,":/image.png:/content")).put(t.data);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){})),r.abrupt("return",n(u));case 26:return r.prev=26,r.t0=r.catch(1),r.abrupt("return",a(r.t0));case 30:case"end":return r.stop()}}),r,null,[[1,26]])})));return function(e,t){return r.apply(this,arguments)}}())},getMyTools:function(e,t){return new Promise(function(){var r=Object(s.a)(l.a.mark((function r(n,a){var o,i,c,u;return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,t){r.next=5;break}if(!(o=localStorage.getItem("mytools"))){r.next=5;break}return r.abrupt("return",n(JSON.parse(o)));case 5:return i=N(),r.next=8,i.api("/me/drive/items/".concat(e.id,"/children")).get();case 8:if(c=r.sent,u=0,0!==c.value.length){r.next=12;break}return r.abrupt("return",n(c.value));case 12:c.value.forEach(function(){var e=Object(s.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u++,e.next=3,_(t);case 3:if(t.tile=e.sent,0!==--u){e.next=8;break}return localStorage.setItem("mytools",JSON.stringify(c.value)),e.abrupt("return",n(c.value));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),r.next=18;break;case 15:r.prev=15,r.t0=r.catch(0),a(r.t0);case 18:case"end":return r.stop()}}),r,null,[[0,15]])})));return function(e,t){return r.apply(this,arguments)}}())},teamMemberships:function(){return new Promise(function(){var e=Object(s.a)(l.a.mark((function e(t,r){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],e.prev=1,(a=N()).api("/me/joinedTeams").get(function(){var e=Object(s.a)(l.a.mark((function e(o,i){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",r(o));case 2:c=0,i.value.map(function(){var e=Object(s.a)(l.a.mark((function e(r){var o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c++,e.next=3,a.api("/groups/".concat(r.id,"/photo/$value")).get();case 3:return o=e.sent,e.next=6,a.api("/teams/".concat(r.id)).get();case 6:if(i=e.sent,n.push({key:r.id,text:r.displayName,title:r.description,data:{details:i,photo:o}}),0!==--c){e.next=11;break}return e.abrupt("return",t(n.sort((function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}))));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,r){return e.apply(this,arguments)}}())}},B=r(179),L=r(95),M=function(e){return e&&e.errors?a.a.createElement("div",{className:"tags"},e.errors.map((function(e,t){return a.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px"}},e.context)}))):null},W=function(e){return e&&e.memberShips?a.a.createElement("div",{className:"tags"},e.memberShips.map((function(e,t){var r=e.data&&e.data.details?e.data.details.webUrl:"";if(r){var n=r.split("https://teams.microsoft.com/l/team/")[1].split("/conversations?"),o=r.split("groupId=")[1].split("&"),i=r.split("tenantId="),c=n[0],l=o[0],s=i[1];r="https://teams.microsoft.com/_?tenantId=".concat(s,"#/conversations/unknown?groupId=").concat(l,"&threadId=").concat(c,"&ctx=channel")}return a.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px"}},a.a.createElement("a",{href:r,rel:"noopener noreferrer",target:"_blank"},e.title))}))):null};function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}Object(y.a)();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement((function(){var e=Object(n.useState)(""),t=Object(p.a)(e,2),r=t[0],o=t[1],i=Object(n.useState)(""),c=Object(p.a)(i,2),f=c[0],d=c[1],v=Object(n.useState)([]),b=Object(p.a)(v,2),y=b[0],E=b[1],O=Object(n.useState)(!1),j=Object(p.a)(O,2),k=j[0],S=j[1],C=Object(n.useState)(null),T=Object(p.a)(C,2),A=T[0],I=T[1],P=Object(n.useState)({}),N=Object(p.a)(P,2),_=(N[0],N[1]),J=Object(n.useState)({}),F=Object(p.a)(J,2),U=F[0],z=F[1],K=Object(n.useState)([]),Y=Object(p.a)(K,2),Z=Y[0],G=Y[1],H=Object(n.useState)(""),$=Object(p.a)(H,2),q=$[0],Q=$[1],V=Object(n.useState)([]),X=Object(p.a)(V,2),ee=X[0],te=X[1],re=Object(n.useState)([]),ne=Object(p.a)(re,2),ae=ne[0],oe=ne[1];function ie(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(s.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.initStorage();case 2:(r=sessionStorage.getItem("memberships"))?oe(JSON.parse(r)):R.teamMemberships().then((function(e){sessionStorage.setItem("memberships",JSON.stringify(e)),oe(e)})).catch((function(e){ee.push({context:"OfficeGraph.teamMemberships()",error:e}),te(ee)})),R.initTileStorage().then(function(){var e=Object(s.a)(l.a.mark((function e(r){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(r),e.next=3,R.getMyTools(r,t);case 3:n=e.sent,G(n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){ee.push({context:"OfficeGraph.initStorage()",error:e}),te(ee)}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e){var t=e.title&&-1!==e.title.toLowerCase().indexOf(f.toLowerCase());return t||(t=e.inShort&&-1!==e.inShort.toLowerCase().indexOf(f.toLowerCase())),t||(t=e.subTitle&&-1!==e.subTitle.toLowerCase().indexOf(f.toLowerCase())),t}Object(n.useEffect)((function(){ie(),R.me().then((function(e){_(e),window.document.title=e.displayName+" Tools"})).catch((function(e){ee.push({context:"OfficeGraph.me()",error:e}),te(ee)}));var e=function(e){if(!e)return{};var t={},r=e.split("?");if(r.length>1)for(var n=r[1].split("&"),a=0;a<n.length;a++){var o=n[a].split("=");t[o[0]]=decodeURIComponent(o[1])}return t}(window.location.href);e.ztickyref&&Q(e.ztickyref);var t=e.src?e.src:"https://api.jumpto365.com/table/hexatown.com/PTO365";m.a.get(t).then((function(e){var t=e.data;o(t.titlegraphics);var r=[];if(t.grid){var n={},a={};t.grid.forEach((function(e){return e.forEach((function(e){e.groupSetting&&(n[e.groupSetting.title]={groupSetting:e.groupSetting,members:e.members},e.members&&e.members.forEach((function(t){var r=a[t]?a[t]:[];r.push(e.groupSetting),a[t]=r})))}))})),t.grid.forEach((function(e){return e.forEach((function(e){if(e.tile&&e.tile.title){var t=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(r,!0).forEach((function(t){Object(u.a)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e.tile),n=a[e.id];t.references=n,r.push(t)}}))}))}E(h.a.sortBy(r,["title","href"]))}))}),[]);var se=f?[]:y,ue=f?[]:Z;return f&&(y.forEach((function(e){le(e)&&se.push(e)})),Z.forEach((function(e){le(e.tile)&&ue.push(e)}))),a.a.createElement(a.a.Fragment,null,a.a.createElement("img",{style:{height:"64px",margin:"13px",position:"fixed",bottom:"0px",right:"0px"},src:r}),k&&a.a.createElement("div",null,a.a.createElement(x,{tile:A||(y?y[0]:null),onClose:function(){S(!1)}})),!k&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{padding:"20px"}},a.a.createElement(w.a,{label:"Filter",value:f,onChange:function(e,t){d(t)},placeholder:"Filter the list of tools",iconProps:{iconName:"Filter"}})),a.a.createElement(B.a,{style:{padding:"20px"}},a.a.createElement(L.a,{headerText:"My Tools",itemCount:ue.length},a.a.createElement("div",null,a.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},ue.map((function(e,t){var r=e.tile?e.tile:{title:e.name,color:"#dddddd"};return a.a.createElement(g,{key:t,tile:r,onClick:function(e){I(e),S(!0)}})}))),a.a.createElement("i",{class:"ms-Icon ms-Icon--Refresh",onClick:function(){ie(!0)},"aria-hidden":"true"}))),a.a.createElement(L.a,{headerText:"Team Tools",itemCount:ae.length},a.a.createElement(W,{memberShips:ae})),a.a.createElement(L.a,{headerText:"Site Tools"},a.a.createElement("h3",null,"Which tools do you find good for this site?"),a.a.createElement("div",null,q)),a.a.createElement(L.a,{headerText:"Global Tools",itemCount:se.length},a.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},se.map((function(e,t){return a.a.createElement(g,{key:t,filter:f,tile:e,onClick:function(e){!function(e){R.addTile(U,e)}(e),I(e),S(!0)}})})))),a.a.createElement(L.a,{headerText:"Errors",itemCount:ee.length},a.a.createElement(M,{errors:ee})))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},75:function(e,t){}},[[104,1,2]]]);
//# sourceMappingURL=main.1c393e10.chunk.js.map