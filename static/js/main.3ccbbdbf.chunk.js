(this["webpackJsonptool-catalogue"]=this["webpackJsonptool-catalogue"]||[]).push([[0],{167:function(e,t,n){},168:function(e,t,n){},169:function(e,t,n){},170:function(e,t,n){},258:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v}));var a=n(162),r=n(48),i=n(23),o=n(64),c=n(115),s=n(117),l=n(116),u=n(0),m=n.n(u),p=n(22),d=n.n(p),f=n(110),h=(n(525),Object(f.WidthProvider)(f.Responsive)),g=function(e){Object(s.a)(n,e);var t=Object(l.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){return m.a.createElement("div",{className:"toolbox__items__item",onClick:this.props.onTakeItem.bind(void 0,this.props.item)},this.props.item.i)}}]),n}(m.a.Component),v=(m.a.Component,function(t){Object(s.a)(u,t);var n=Object(l.a)(u);function u(t){var c;return Object(o.a)(this,u),(c=n.call(this,t)).onBreakpointChange=function(e){c.setState((function(t){return{currentBreakpoint:e,toolbox:Object(i.a)(Object(i.a)({},t.toolbox),{},Object(r.a)({},e,t.toolbox[e]||t.toolbox[t.currentBreakpoint]||[]))}}))},c.onCompactTypeChange=function(){var e=c.state.compactType,t="horizontal"===e?"vertical":"vertical"===e?null:"horizontal";c.setState({compactType:t})},c.onTakeItem=function(e){c.setState((function(t){return{toolbox:Object(i.a)(Object(i.a)({},t.toolbox),{},Object(r.a)({},t.currentBreakpoint,t.toolbox[t.currentBreakpoint].filter((function(t){return t.i!==e.i})))),layouts:Object(i.a)(Object(i.a)({},t.layouts),{},Object(r.a)({},t.currentBreakpoint,[].concat(Object(a.a)(t.layouts[t.currentBreakpoint]),[e])))}}))},c.onPutItem=function(e){c.setState((function(t){return{toolbox:Object(i.a)(Object(i.a)({},t.toolbox),{},Object(r.a)({},t.currentBreakpoint,[].concat(Object(a.a)(t.toolbox[t.currentBreakpoint]||[]),[e]))),layouts:Object(i.a)(Object(i.a)({},t.layouts),{},Object(r.a)({},t.currentBreakpoint,t.layouts[t.currentBreakpoint].filter((function(t){return t.i!==e.i}))))}}))},c.onLayoutChange=function(t,n){var a,i;a="layouts",i=n,e.localStorage&&e.localStorage.setItem("rgl-8",JSON.stringify(Object(r.a)({},a,i))),c.props.persist&&c.props.persist(n),c.setState({layouts:n})},c.onNewLayout=function(){c.setState({layouts:{lg:b()}})},c.state={currentBreakpoint:"lg",compactType:"vertical",mounted:!1,layouts:t.layouts?t.layouts:{lg:t.tools?t.tools.map((function(e,t){return{x:0,y:t,w:3,h:3,i:t.toString(),static:0}})):t.initialLayout},toolbox:{lg:[]}},c}return Object(c.a)(u,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"generateDOM",value:function(){var e=this,t=this;return d.a.map(this.state.layouts[this.state.currentBreakpoint],(function(n){var a=t.props.tools&&t.props.tools[n.i]&&t.props.tools[n.i].tile?t.props.tools[n.i].tile:{title:n.i};return m.a.createElement("div",{style:{backgroundColor:a.color,color:a.textcolor,cursor:e.props.editingLayout?"default":"pointer"},onClick:function(){e.props.onTileClick&&!e.props.editingLayout&&e.props.onTileClick(a)},key:n.i,className:n.static?"static":""},m.a.createElement("img",{src:a.icon,style:{height:"100%",maxHeight:"128px",width:"auto",padding:"8px"}}),m.a.createElement("span",{className:"text"},a.title," "))}))}},{key:"render",value:function(){return m.a.createElement("div",null,m.a.createElement(h,Object.assign({},this.props,{isDraggable:this.editingLayout,layouts:this.state.layouts,onBreakpointChange:this.onBreakpointChange,onLayoutChange:this.onLayoutChange,measureBeforeMount:!1,useCSSTransforms:this.state.mounted,compactType:this.state.compactType,preventCollision:!this.state.compactType}),this.generateDOM()))}}]),u}(m.a.Component));function b(){return d.a.map(d.a.range(0,25),(function(e,t){var n=Math.ceil(4*Math.random())+1;return{x:2*d.a.random(0,5)%12,y:Math.floor(t/6)*n,w:2,h:n,i:t.toString(),static:Math.random()<.05}}))}v.defaultProps={className:"layout",rowHeight:30,onLayoutChange:function(){},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},initialLayout:b()}}).call(this,n(19))},259:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABidJREFUeNrtnc1vHdUZh5/3nBlf29dJbOLgOOAoSkwwIBKgsVIRGqkSq1AhqNIVC6Ru2j+gfwe7dsMCWIBUsajKh6qibKCtKqSGCgioNB+kSTCRUUzs4I/Y95yXxb1JiO+YAGfiI5f38ca+I78+M898nDm/OWNRVcXIhsvdgB87JiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzxeoPFJia+oJLM7MgklRcVRlo9rFr5yjebyzXMUZmPpvh6uLV9GIKzcEmgyODXYu6BcTI8y+9xst//CtF4ZP+bgiRgwfu5/fP/Y7Nm5rrtvHqYHlxmTf+8CZnPziLS9x5YghMPjHJkd8eQdzNO3W3AIWFhSVmvpyrRcDclQU2YuamqizNLzE/O1+DgMjy4nLlsmKtXxIRJPEUJJJ8FsuIAFLPdmDtDbGxTsz/h5iAzJiAzJiAzJiAzJiAzBTpJb47c3PLzC+0SO2ZKtDocQwONnBuw/ZzgXUWMPX5AufPf4VLPO5UYWiwwf79PSbg+9B+DFVRTR9j2oA315XYNSAzJiAzJiAzJiAzJiAzJmA9+JZOX2U3VIGomtTdEyBG5ZszoIR2H76ejOB2d0QVrm2DxERJY7tWu823SMScE57+xWHuHd+ZfJOjqoyObKWvtweAkZF+ms0yWYAqNHr9bb0JKxslP/vVIfb9/MHkQEajsn3P9so9Tyon6YUIMdazJiLQiTZbUdtHRQ1lnUDZiQqXWy2iai1DHIVzFP5ae6GmrYATKCoaWBHKK+dePcb0O/9GUscMYmTT3p2M/+aXuN4Gbxw/zz8/mU7ec6Mqu0c28ezhcZDAi387xpnpi7jEPTWo8ug99/HUIz9laUV4/u0VTl7U5KGTEJXD93qOThasXvXua4Aqsx+dYerNf+ASQ/kYIsMzc+z+9ZNIbw//+WyWYx9OUSSG3K0YOTA/zDOP7QECx8+e4l+fnqRwnh96fEmn7h3NAfSRg6xE4d0zkXdPR1KfqGkF2DrgODrZvaxbgIA4hys8kijAiSDeX7/uOCd47/DJ525301HknaNwHp+4qyqCc45OjI53UDiSBQB4oeoavHY3tL4+hq76fgMNo61DU+0+IDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDNrCqgv7JNV32+gZznXoakVgUx7qmpsheTDI4aIhnB9WDdGJYSIJFZuxUiMN8aKQ4y0Yug0/4cHMiFGYoydKkKI7VgydVS6FSBUZAFQGcgIWx7YzY4nDtUWSbqyQBAm7trC4w/uqC2SLJyAeH6ya5yh/oFaIsmJHWMIQung4G7HHf1SSyT5wF3VbasO5VutdjBfB06gLK83JNQ0aVhEKDsiW6EdytdxyvDi8K6dBK4EiDWUVW6ka6upfFXBicvKp7OB1OQwKgz3OSa3K4UIJ/97kfMXZtIf81AYGurnof1jIMJ7py8zc+VqDXWVndua3Dc2SIgtPj73AZfnv+wElGl1d2y9m/HRvV1trJwp//aFJV4/vYhPWSFpH0T7tpXs29aD98pf3jrBn/78XvJ7I0JQHn5ojImJUfCeF46d4vipS8lZc4iRo4d2MTG2hasrS7z691c4cfZ9nEt8Y0AMHDnwJHtG7+mSWflknFz7SjwCRG7u90RVQlRE0k5D8dpFWG/UjaokliVEbnoKrl03QuKEkqixfYqsoHJX3ECxeb1Idx/qdm8LuxFbhdzi57oxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAatY79HQNV/YpJ1gOmlldNVK3K4pYnXV1Ft+kFC4ulalgF4vbG649sy+BKJCf3kjAypLR29vgffp76TuKQtE2qvVUzoapU9OxAovncnf7Rip9D00ygZeUhOxgsKXlcsqQ/kvFiKzy/WE8n2FMNr0CPC/c5eYnp6r5VUFmzb3snd8BET45MIsc4sryWP3UWH7UB+7RgaIMXDm4im+WryCiCS9M0NVGd5yJ3cPj3VFkmL/TzgvdhHOjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIzNezxiKEIKwxBgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wOS0xMFQwNTo0MDowNiswMDowMFT52voAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDktMTBUMDU6NDA6MDYrMDA6MDAlpGJGAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTQtMDUtMTIgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn3IbtAAAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQAMTkyDwByhQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAxOTLTrCEIAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE1MzY1NTgwMDZiJ+JmAAAAD3RFWHRUaHVtYjo6U2l6ZQAwQkKUoj7sAAAAVnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vbW50bG9nL2Zhdmljb25zLzIwMTgtMDktMTAvZWI1MTNmMmE5ZWRkMzA1ZjhkZWEyODgzYTllYTNhNzguaWNvLnBuZ3XQqTUAAAAASUVORK5CYII="},260:function(e){e.exports=JSON.parse('{"name":"tool-catalogue","version":"0.1.1","private":true,"xhomepage":"https://apps.ztickybar.com/tools","dependencies":{"@microsoft/microsoft-graph-client":"^2.0.0","animejs":"^3.1.0","axios":"^0.19.0","dexie":"^2.0.4","dexie-observable":"^1.0.0-beta.5","dexie-syncable":"^1.0.0-beta.4","exceljs":"^3.5.0","https":"^1.0.0","into-stream":"5.1.1","lodash":"^4.17.15","mammoth":"^1.4.9","moment":"^2.25.3","format-json":"^1.0.3","quill-delta-to-html":"^0.11.0","react":"^16.12.0","react-dom":"^16.12.0","react-dropzone":"^10.2.1","react-grid-layout":"^0.17.1","react-resizable":"^1.10.1","react-scripts":"3.2.0","react-masonry-css":"^1.0.14","string-to-stream":"^3.0.1","xlsx":"^0.15.4","@fluentui/react":"^7.115.3","@uifabric/icons":"^7.3.44","@uifabric/fluent-theme":"^7.1.84","react-tag-autocomplete":"^5.13.1","@reach/router":"^1.3.3"},"devDependencies":{"gh-pages":"^2.1.1"},"scripts":{"yarn":"yarn","start":"PORT=3001 react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","config-default":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js","config-nttdata":"cp src/config/nttdata/index.html public/index.html && cp src/config/nttdata.js src/config/index.js","config-nets":"cp src/config/nets/index.html public/index.html && cp src/config/nets.js src/config/index.js","deploy":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js && react-scripts build && echo tools.ztickybar.com > build/CNAME && cp build/index.html build/404.html && gh-pages -b master -d build -r https://github.com/ztickybar/tools","deploy-nttdata":"cp src/config/nttdata/index.html public/index.html && cp src/config/nttdata.js src/config/index.js && react-scripts build && echo nttdata-tools.zbar.app > build/CNAME && cp build/index.html build/404.html && gh-pages -b master -d build -r https://github.com/zbar-nttdata/tools","deploy-nets":"cp src/config/nets/index.html public/index.html && cp src/config/nets.js src/config/index.js && react-scripts build && echo tools.nets-intranets.com > build/CNAME && cp build/index.html build/404.html && gh-pages -b master -d build -r https://github.com/nets-intranets/tools"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},272:function(e,t,n){e.exports=n(532)},278:function(e,t,n){},295:function(e,t,n){},320:function(e,t){},322:function(e,t){},354:function(e,t){},355:function(e,t){},420:function(e,t){},513:function(e,t,n){},514:function(e,t,n){},525:function(e,t,n){},532:function(e,t,n){"use strict";n.r(t);var a=n(6),r=n.n(a),i=n(16),o=n(0),c=n.n(o),s=n(46),l=n.n(s),u=(n(278),n(23)),m=n(4);n(167),n(168),n(169),n(170);var p=n(36),d=n.n(p),f=n(22),h=n.n(f),g=function(e){return e&&e.references?c.a.createElement("div",{className:"tags",style:{display:"flex",flexWrap:"wrap"}},e.references.map((function(e,t){return c.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px",backgroundColor:e.color,color:e.textColor}},e.title)}))):null},v=function(e){if(!e.text)return null;if(!e.filter)return e.text;var t=e.text.toLowerCase().indexOf(e.filter.toLowerCase());if(-1===t)return e.text;var n=e.text.substr(0,t),a=e.text.substr(t,e.filter.length),r=e.text.substr(t+e.filter.length);return c.a.createElement(c.a.Fragment,null,c.a.createElement("span",null,n),c.a.createElement("span",{style:e.style},a),c.a.createElement("span",null,r))},b=(n(295),function(e){var t=e.tile?e.tile:{},n=Object(o.useState)(""),a=Object(m.a)(n,2);a[0],a[1];return c.a.createElement(c.a.Fragment,null,1===e.tileSize&&c.a.createElement("div",{className:"supertile",style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},c.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:70,maxHeight:70,borderRadius:35,overflow:"hide"}},c.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){e.onClick&&e.onClick(t)}},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement("div",{style:{margin:8,marginTop:8,height:40}},c.a.createElement("img",{style:{height:"auto",width:40},src:t.icon})),c.a.createElement("div",{title:t.title,style:{flexGrow:1,height:"40px",width:"300px",overflow:"hidden",lineHeight:"40px",marginTop:"6px",marginLeft:"4px",fontSize:"24px"}},c.a.createElement(v,{text:t.title,filter:e.filter,style:e.highlightStyle})),c.a.createElement("div",{style:{alignItems:"flex-end"}},c.a.createElement("i",{style:{cursor:"pointer",display:"none"},class:e.isPinned?"ms-Icon ms-Icon--PinnedFill":"ms-Icon ms-Icon--Pinned",onClick:function(t){e.onPinnedClicked&&(t.preventDefault(),t.stopPropagation(),e.onPinnedClicked(e))},"aria-hidden":"true"}))," ")))),0===e.tileSize&&c.a.createElement("div",{style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},c.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:300,maxHeight:300,overflow:"auto"}},c.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){e.onClick&&e.onClick(t)}},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement("div",{style:{flexGrow:1}},c.a.createElement(v,{text:t.title,filter:e.filter,style:e.highlightStyle})," "),c.a.createElement("div",{style:{alignItems:"flex-end"}},c.a.createElement("i",{style:{cursor:"pointer",display:"none"},class:e.isPinned?"ms-Icon ms-Icon--PinnedFill":"ms-Icon ms-Icon--Pinned",onClick:function(t){e.onPinnedClicked&&(t.preventDefault(),t.stopPropagation(),e.onPinnedClicked(e))},"aria-hidden":"true"}))),c.a.createElement("div",{style:{textAlign:"center",margin:20,marginTop:40,height:120}},c.a.createElement("img",{style:{height:"auto",width:112},src:t.icon})),c.a.createElement("div",{style:{maxHeight:60,height:60,overflow:"auto"}},t.inShort),c.a.createElement(g,{references:t.references}))),c.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.externalArticle&&c.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,rel:"noopener noreferrer",target:"_blank"},"More info"))))}),x=n(249),y=function(e){var t=e.tile?e.tile:{},n=Object(o.useState)(""),a=Object(m.a)(n,2),r=a[0],i=a[1],s=Object(o.useState)(null),l=Object(m.a)(s,2),u=l[0],p=l[1];return Object(o.useEffect)((function(){t.contentRef&&d.a.get(t.contentRef).then((function(e){var t=new x.QuillDeltaToHtmlConverter(e.data.ops);i(t.convert())})).catch((function(e){404!==e.response.status&&p(e.message)}))})),c.a.createElement(c.a.Fragment,null,u&&c.a.createElement("div",null,u),c.a.createElement("div",{onClick:e.onClose,style:{backgroundColor:t.color,color:t.textcolor,height:"80px",borderRadius:"40px",overflow:"auto"}},c.a.createElement("div",null,c.a.createElement("div",{style:{display:"flex"}},c.a.createElement("div",null," ",c.a.createElement("img",{style:{margin:"10px",marginLeft:"20px",height:"60px",width:"auto"},src:t.icon})),c.a.createElement("div",{style:{width:"auto"}},c.a.createElement("div",{className:"fullSizeHeading",style:{padding:"10px",marginTop:"20px",fontSize:"48px",textOverflow:"nowrap",whiteSpace:"no-wrap"}},t.title),c.a.createElement("div",{className:"fullSizeDescription",style:{paddingLeft:"3vh",fontSize:"3vh"}},t.inShort))))),c.a.createElement("div",{style:{margin:"20px",xheight:"80vh",overflow:"auto",backgroundColor:"#ffffff",color:"#000000",padding:"20px"}},c.a.createElement("div",{style:{fontSize:"22px",lineHeight:"24px"}},t.messageBeforeLaunch,c.a.createElement("div",{style:{marginTop:"20px"}},c.a.createElement("div",null,c.a.createElement("a",{href:t.jumpto},t.jumpto)))),c.a.createElement("div",null),c.a.createElement(g,{references:t.references}),c.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.externalArticle&&c.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")),c.a.createElement("div",{dangerouslySetInnerHTML:{__html:r}})))},E=n(572),A=n(263),w=n(64),O=(n(305),n(156)),j=n.n(O),k={};k.analyseMembers=function(e,t,n){var a=[];t.split("\n").forEach((function(e){e.split(";").forEach((function(e){e.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi).forEach((function(e){a.push({checked:!1,smtp:e})}))}))}));var r=[],i=a.length;a.forEach((function(t){k.readUser(e,t.smtp,0,(function(e,a){i--,t.user=a,t.err=e,r.push(t),i<1&&(n(null,r),t.checked=!0)}))}))},k.invite=function(e,t,n,a){_(e,"https://graph.microsoft.com/v1.0/invitations",{invitedUserEmailAddress:t,inviteRedirectUrl:n,invitedUserDisplayName:t,sendInvitationMessage:!1,invitedUserMessageInfo:{customizedMessageBody:"We are really happy to invite you to the JUMPTO365 #Insider program ",ccRecipients:[{emailAddress:{name:"Niels",address:"niels@jumpto365.com"}}]}},(function(e,t){if(e)return a(e);a(null,t)}))},k.addcrm=function(e,t,n,a,r,i){var o={properties:[{property:"firstname",value:n},{property:"lastname",value:a},{property:"internal_categories",value:r}]};C(e,"https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/".concat(t,"/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2"),o,(function(e,t){if(e)return i(e);i(null,t)}))},k.addmember=function(e,t,n,a){var r={"@odata.id":"https://graph.microsoft.com/beta/directoryObjects/".concat(t)};_(e,"https://graph.microsoft.com/beta/groups/".concat(n,"/members/$ref"),r,(function(e,t){if(e)return a(e);a(null)}))},k.getSharePointList=function(e,t,n,a,r,i,o){Q(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n,":/lists/").concat(a,"/items?").concat(r),(function(r,c){if(r)return o(r);var s=[];!function r(){if(0===c.length)return o(null,s);var l=c.pop();Q(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n,":/lists/").concat(a,"/items/").concat(l.id,"?").concat(i),(function(e,t){if(e)return o(e);s.push(t),r()}))}()}))},k.getPages=function(e,t,n,a){Q(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":").concat(n),(function(t,n){if(t)return a(t);Q(e,"https://graph.microsoft.com/beta/sites/".concat(n.id,"/pages"),(function(e,t){return e?a(e):a(null,t)}))}))},k.readGroupMembers=function(e,t,n){Q(e,"https://graph.microsoft.com/beta/groups/"+t+"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id",n)},k.readGroupMemberShipFor=function(e,t,n){Q(e,"https://graph.microsoft.com/v1.0/users/"+t+"/memberOf",n)},k.readManager=function(e,t,n,a){Q(e,"https://graph.microsoft.com/v1.0/users/"+t+"/manager",a,null,n)},k.readUser=function(e,t,n,a){Q(e,"https://graph.microsoft.com/v1.0/users/"+t,a,null,n)},k.readUser=function(e,t,n,a){Q(e,"https://graph.microsoft.com/v1.0/users/"+t,a,null,n)},k.matchingGroups=function(e,t,n){Q(e,"https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'".concat(t,"')"),n)},k.findGroup=function(e,t,n){Q(e,"https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '".concat(t,"'"),n)},k.getGroupDocuments=function(e,t,n,a){Q(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/root:").concat(n,":/children"),a)},k.getGroupDrive=function(e,t,n){Q(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive"),n)},k.getGroupSite=function(e,t,n){Q(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/sites/root"),n)},k.getDriveChildren=function(e,t,n,a){Q(e,"https://graph.microsoft.com/beta/drives/".concat(t,"/items/").concat(n,"/children"),a)},k.getGroupRootFolders=function(e,t,n){Q(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/root/children"),n)},k.getSharePointSiteByName=function(e,t,n,a){Q(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":/sites/").concat(n),a)},k.getSharePointSiteDrive=function(e,t,n,a){Q(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,"/drive/root:/").concat(n,":/children"),a)},k.getSharePointSiteByName=function(e,t,n,a){Q(e,"https://graph.microsoft.com/v1.0/sites/".concat(t,":/sites/").concat(n),a)},k.copyfile=function(e,t,n,a,r,i,o){k.findGroup(e,t,(function(t,c){if(t)return o(t);if(1!==c.length)return o("Did't find a unique group");var s=c[0];k.getGroupDocuments(e,s.id,"/"+n,(function(t,n){if(t)return o(t);var c=h.a.find(n,{name:a});k.getGroupRootFolders(e,s.id,(function(t,n){if(t)return o(t);var a=h.a.find(n,{name:r});if(!a)return o("Did't find target folder");k.newDoc(e,s.id,c.id,a.parentReference.driveId,a.id,i,(function(e,t){return e?o(e):o(null,t)}))}))}))}))},k.newDoc=function(e,t,n,a,r,i,o){_(e,"https://graph.microsoft.com/beta/groups/".concat(t,"/drive/items/").concat(n,"/copy"),{parentReference:{driveId:a,id:r},name:i},(function(t){if(t)return o(t);!function e(t,n,a,r,i,o){k.getDriveChildren(t,n,a,(function(c,s){if(c)return o(c);for(var l=0;l<s.length;l++){var u=s[l];if(console.log("Comparing",u.name,r),u.name===r)return console.log("Match found"),o(null,u)}var m=0;setTimeout((function(){if(console.log("Retrying",i),m>10)return o("Think that the file has been created, but could not find a reference to if. Filename is ".concat(r," - Tryed ").concat(i," to find it "));e(t,n,a,r,i+1,o)}),1e3)}))}(e,a,r,i,0,o)}))};var S=function e(){var t=this;Object(w.a)(this,e),this.get=function(e){return new Promise((function(n,a){Q(t.token,e,(function(e,t){return e?a(e):n(t)}))}))},this.post=function(e,n){return new Promise((function(a,r){_(t.token,e,n,(function(e,t){return e?r(e):a(t)}))}))},this.patch=function(e,n){return new Promise((function(a,r){!function(e,t,n,a){d.a.patch(t,n,{headers:{"content-type":"application/json",authorization:"Bearer "+e}}).then((function(e){a(null,e.data)})).catch((function(e){a(e)}))}(t.token,e,n,(function(e,t){return e?r(e):a(t)}))}))},this.put=function(e,n){return new Promise((function(a,r){!function(e,t,n,a){d.a.put(t,n,{headers:{"content-type":"application/json",authorization:"Bearer "+e}}).then((function(e){a(null,e.data)})).catch((function(e){a(e)}))}(t.token,e,n,(function(e,t){return e?r(e):a(t)}))}))},this.getRaw=function(e){return function(e,t){return console.log("getting",t),new Promise((function(n,a){j.a.get({url:t,headers:{authorization:"Bearer "+e}},(function(e,t,r){if(e)return a(e);n({body:r,response:t})}))}))}(t.token,e)},this.getImage=function(e){return function(e,t){return new Promise((function(n,a){try{var r=new XMLHttpRequest;r.onload=function(){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(r.response)},r.open("GET",t),r.setRequestHeader("Authorization","Bearer "+e),r.responseType="blob",r.send()}catch(i){a(i)}}))}(t.token,e)},this.token=H.getAccessToken()};var I=function(e){return(new S).get(e)},C=function(e,t){return(new S).post(e,t)},N=function(e,t){return(new S).put(e,t)},T=function(){return I("https://graph.microsoft.com/v1.0/me")},D=function(){return I("https://graph.microsoft.com/v1.0/me/memberOf")},L=function(e){return I("https://graph.microsoft.com/v1.0/groups/"+e)},z=function(e){return I("https://graph.microsoft.com/v1.0/me/extensions/".concat(e))},P=function(e){return I("https://graph.microsoft.com/v1.0/me/drive/root:/".concat(e))},M=function(e,t){return new Promise(function(){var n=Object(i.a)(r.a.mark((function n(a,i){var o;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,P(e).catch((function(e){i(e)}));case 2:if(o=n.sent){n.next=5;break}return n.abrupt("return");case 5:I("https://graph.microsoft.com/v1.0/me/drive/items/".concat(o.id,":/").concat(t)).then((function(e){d.a.get(e["@microsoft.graph.downloadUrl"]).then((function(e){a(e.data)})).catch((function(e){i(e)}))})).catch((function(e){i(e)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},B=function(e,t,n){return new Promise(function(){var a=Object(i.a)(r.a.mark((function a(i,o){var c;return r.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("Size of payload",n.length),a.next=3,P(e).catch((function(e){o(e)}));case 3:if(c=a.sent){a.next=6;break}return a.abrupt("return");case 6:N("https://graph.microsoft.com/v1.0/me/drive/items/".concat(c.id,":/").concat(t,":/content"),n).then((function(e){i(e)})).catch((function(e){o(e)}));case 7:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())},R=function(e){return C("https://graph.microsoft.com/v1.0/me/drive/root/children",{name:e,folder:{},"@microsoft.graph.conflictBehavior":"rename"})},W=function(e,t){var n={name:t,folder:{},"@microsoft.graph.conflictBehavior":"rename"};return C("https://graph.microsoft.com/v1.0/me/drive/root:/".concat(e,":/children"),n)},U=function(e,t){return new Promise(function(){var n=Object(i.a)(r.a.mark((function n(a,i){return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,z(e).catch((function(e){}));case 2:n.sent?G(e,t).then((function(e){a(e)})).catch((function(e){i(e)})):J(e,t).then((function(e){a(e)})).catch((function(e){i(e)}));case 4:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},G=function(e,t){var n=Object(u.a)({"@odata.type":"#microsoft.graph.openTypeExtension",extensionName:e},t);return function(e,t){return(new S).patch(e,t)}("https://graph.microsoft.com/v1.0/me/extensions/".concat(e),n)},J=function(e,t){var n=Object(u.a)({"@odata.type":"#microsoft.graph.openTypeExtension",extensionName:e},t);return C("https://graph.microsoft.com/v1.0/me/extensions",n)},F=function(e){var t=new S;return new Promise(function(){var n=Object(i.a)(r.a.mark((function n(a,o){var c,s,l,u,m;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.get("https://graph.microsoft.com/v1.0/me/memberOf").catch((function(e){return o(e)}));case 3:if(c=n.sent,s=0,l=[],c){n.next=8;break}return n.abrupt("return",o("Not able to read membership"));case 8:u=c.length,m=0,e&&e(0),c.map(function(){var n=Object(i.a)(r.a.mark((function n(i){var o;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s++,n.next=3,q(i,t);case 3:if(o=n.sent,m++,e&&e(m/u),l.push(o),0!==--s){n.next=10;break}return n.abrupt("return",a(l.sort((function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}))));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),n.next=18;break;case 14:n.prev=14,n.t0=n.catch(0),o(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})));return function(e,t){return n.apply(this,arguments)}}(),null)},H={};function q(e,t){return new Promise(function(){var n=Object(i.a)(r.a.mark((function n(a,i){var o,c,s,l,m;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=Object(u.a)(Object(u.a)({},e),{},{key:e.id,text:e.title?e.title:e.displayName,title:e.description}),n.next=3,t.getImage("https://graph.microsoft.com/v1.0/groups/".concat(e.id,"/photo/$value")).catch((function(e){console.log("Photo read error")}));case 3:return(c=n.sent)&&c.indexOf("data:application/json")>-1&&(c=null),n.next=7,t.get("https://graph.microsoft.com/v1.0/teams/".concat(e.id)).catch((function(e){return console.log("Team details read error")}));case 7:return s=n.sent,(e.creationOptions?e.creationOptions:[]).forEach((function(e){"YammerProvisioning"===e&&(o.hasYammer=!0),"ProvisionGroupHomepage"===e&&(o.hasSharePoint=!0)})),(e.resourceProvisioningOptions?e.resourceProvisioningOptions:[]).forEach((function(e){"YammerProvisioning"===e&&(o.hasYammer=!0),"ProvisionGroupHomepage"===e&&(o.hasSharePoint=!0)})),n.next=12,Y(t,e).catch((function(e){}));case 12:return l=n.sent,n.next=15,Z(t,e).catch((function(e){}));case 15:m=n.sent,o.hasTeams=void 0!==l,o.data={endPoints:m,details:s,photo:c,channels:l},a(o);case 19:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}function Y(e,t){return V.apply(this,arguments)}function V(){return(V=Object(i.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=0,e.abrupt("return",new Promise(function(){var e=Object(i.a)(r.a.mark((function e(o,c){var s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("https://graph.microsoft.com/beta/teams/".concat(n.id,"/channels")).catch((function(e){console.log("Channel read error")}));case 2:if(s=e.sent){e.next=5;break}return e.abrupt("return",o());case 5:s.forEach(function(){var e=Object(i.a)(r.a.mark((function e(i){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a++,e.next=3,t.get("https://graph.microsoft.com/beta/teams/".concat(n.id,"/channels/").concat(i.id,"/tabs")).catch((function(e){console.log("Channel read tabs",e)}));case 3:c=e.sent,i.tabs=c,0===--a&&o(s);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return K.apply(this,arguments)}function K(){return(K=Object(i.a)(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.get("https://graph.microsoft.com/beta/groups/".concat(n.id,"/endpoints")));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t,n,a){d.a.post(t,n,{headers:{"content-type":"application/json",authorization:"Bearer "+e}}).then((function(e){a(null,e.data)})).catch((function(e){a(e)}))}function Q(e,t,n,a,r,i){console.log("getting",t,!0===a),j.a.get({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e}},(function(o,c,s){var l,u;if(o){var m=i?i+1:1;return m>3?n(o,null,r):(console.log("retry #",m),Q(e,t,n,a,r,m))}return(l=JSON.parse(s)).error?n(l.error,null,r):l["@odata.nextLink"]?(u=a?a.concat(l.value):l.value,Q(e,l["@odata.nextLink"],n,u,r)):void(a?n(null,a.concat(l.value),r):l.value?n(null,l.value,r):n(null,l,r))}))}H.getAccessToken=function(){return sessionStorage.getItem("access_token")};n(571),n(261);var X=n(250),$=n.n(X),ee=n(65),te=n.n(ee),ne=(n(513),n(514),n(569)),ae=n(2),re=n(570),ie=n(577),oe={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:ne.a},ce={iconName:"Cancel"},se=Object(ae.u)(),le=Object(ae.y)({container:{display:"flex",flexFlow:"column nowrap",alignItems:"stretch"},header:[se.fonts.xLargePlus,{flex:"1 1 auto",borderTop:"4px solid ".concat(se.palette.themePrimary),color:se.palette.neutralPrimary,display:"flex",alignItems:"center",fontWeight:ae.d.semibold,padding:"12px 12px 14px 24px"}],body:{flex:"4 4 auto",padding:"0 24px 24px 24px",overflowY:"hidden",selectors:{p:{margin:"14px 0"},"p:first-child":{marginTop:0},"p:last-child":{marginBottom:0}}}}),ue={root:{color:se.palette.neutralPrimary,marginLeft:"auto",marginTop:"4px",marginRight:"2px"},rootHovered:{color:se.palette.neutralDark}},me=function(e){var t=Object(o.useState)(!1),n=Object(m.a)(t,2),a=n[0],r=n[1];return c.a.createElement("div",{className:"groupOver"},c.a.createElement("div",{className:"groupOverLink",onClick:function(e){r(!0),e.preventDefault()}},"Open "),c.a.createElement(re.a,{titleAriaId:1,isOpen:a,onDismiss:function(){return r(!1)},isBlocking:!1,containerClassName:le.container,dragOptions:oe},c.a.createElement("div",null,c.a.createElement("span",null,"Lorem Ipsum"),c.a.createElement(ie.a,{styles:ue,iconProps:ce,ariaLabel:"Close popup modal",onClick:function(){return r(!1)}})),c.a.createElement("div",{className:le.body},c.a.createElement("p",null,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas lorem nulla, malesuada ut sagittis sit amet, vulputate in leo. Maecenas vulputate congue sapien eu tincidunt. Etiam eu sem turpis. Fusce tempor sagittis nunc, ut interdum ipsum vestibulum non. Proin dolor elit, aliquam eget tincidunt non, vestibulum ut turpis. In hac habitasse platea dictumst. In a odio eget enim porttitor maximus. Aliquam nulla nibh, ullamcorper aliquam placerat eu, viverra et dui. Phasellus ex lectus, maximus in mollis ac, luctus vel eros. Vivamus ultrices, turpis sed malesuada gravida, eros ipsum venenatis elit, et volutpat eros dui et ante. Quisque ultricies mi nec leo ultricies mollis. Vivamus egestas volutpat lacinia. Quisque pharetra eleifend efficitur."),c.a.createElement("p",null,"Mauris at nunc eget lectus lobortis facilisis et eget magna. Vestibulum venenatis augue sapien, rhoncus faucibus magna semper eget. Proin rutrum libero sagittis sapien aliquet auctor. Suspendisse tristique a magna at facilisis. Duis rhoncus feugiat magna in rutrum. Suspendisse semper, dolor et vestibulum lacinia, nunc felis malesuada ex, nec hendrerit justo ex et massa. Quisque quis mollis nulla. Nam commodo est ornare, rhoncus odio eu, pharetra tellus. Nunc sed velit mi."),c.a.createElement("p",null,"Sed condimentum ultricies turpis convallis pharetra. Sed sagittis quam pharetra luctus porttitor. Cras vel consequat lectus. Sed nec fringilla urna, a aliquet libero. Aenean sed nisl purus. Vivamus vulputate felis et odio efficitur suscipit. Ut volutpat dictum lectus, ac rutrum massa accumsan at. Sed pharetra auctor finibus. In augue libero, commodo vitae nisi non, sagittis convallis ante. Phasellus malesuada eleifend mollis. Curabitur ultricies leo ac metus venenatis elementum."),c.a.createElement("p",null,"Aenean egestas quam ut erat commodo blandit. Mauris ante nisl, pellentesque sed venenatis nec, aliquet sit amet enim. Praesent vitae diam non diam aliquet tristique non ut arcu. Pellentesque et ultrices eros. Fusce diam metus, mattis eu luctus nec, facilisis vel erat. Nam a lacus quis tellus gravida euismod. Nulla sed sem eget tortor cursus interdum. Sed vehicula tristique ultricies. Aenean libero purus, mollis quis massa quis, eleifend dictum massa. Fusce eu sapien sit amet odio lacinia placerat. Mauris varius risus sed aliquet cursus. Aenean lectus magna, tincidunt sit amet sodales a, volutpat ac leo. Morbi nisl sapien, tincidunt sit amet mauris quis, sollicitudin auctor est."),c.a.createElement("p",null,"Nam id mi justo. Nam vehicula vulputate augue, ac pretium enim rutrum ultricies. Sed aliquet accumsan varius. Quisque ac auctor ligula. Fusce fringilla, odio et dignissim iaculis, est lacus ultrices risus, vitae condimentum enim urna eu nunc. In risus est, mattis non suscipit at, mattis ut ante. Maecenas consectetur urna vel erat maximus, non molestie massa consequat. Duis a feugiat nibh. Sed a hendrerit diam, a mattis est. In augue dolor, faucibus vel metus at, convallis rhoncus dui."))))},pe={LANDING:"landing",ONBOARDING:"onboarding",SEARCHING:"user-searched-for",TILECLICKED:"user-clicked-tile",TABCLICKED:"user-clicked-tab",DETAILSTOGGLED:"user-toggle-details",MEMBERSHIPSREAD:"memberships-read"};function de(e){if(window.amplitude&&e){var t=window.amplitude.getInstance();if(t){t.setUserId(e);var n=e.split("@");2===n.length&&t.setDomain(n[1])}}}function fe(e,t){if(window.amplitude){var n=window.amplitude.getInstance();n&&(n.logEvent(e,t),console.log("trace",e,t))}}Object.freeze(pe);var he={default:10,3500:9,3100:8,2700:7,2300:6,1900:5,1500:4,1100:3,700:2,500:1},ge=function(e){var t=Object(o.useState)(e.details),n=Object(m.a)(t,2),a=(n[0],n[1],Object(o.useState)(!1)),r=Object(m.a)(a,2),i=r[0];r[1];if(e&&e.memberShips){var s=h.a.cloneDeep(e.memberShips);return e.tiles&&(e.tiles.forEach((function(e){s.push({displayName:e.title,tile:e})})),s=h.a.sortBy(s,["title"])),c.a.createElement("div",{className:"tags",style:{padding:"4px",margin:"4px",fontSize:"16px",display:"flex",flexWrap:"wrap",minWidth:"300px"}},c.a.createElement($.a,{breakpointCols:he,className:"my-masonry-grid",columnClassName:"my-masonry-grid_column"},s.map((function(t,n){return c.a.createElement(ve,Object.assign({key:n,team:t,viewChannels:e.details,viewDates:i},e))}))))}return null};function ve(e){var t=e.viewChannels,n=Object(o.useState)(e.viewDates),a=Object(m.a)(n,2),r=a[0],i=(a[1],Object(o.useState)(!1)),s=Object(m.a)(i,2),l=s[0],u=s[1],p=e.team;function d(e,t){if(!e)return null;var n="ms-fontSize-28 ms-Icon ms-Icon--"+t;return c.a.createElement("i",{className:n,style:{padding:"4px"},"aria-hidden":"true"})}var f=p.data&&p.data.details?p.data.details.webUrl:"";if(p.tile)return c.a.createElement("div",{style:{paddingLeft:"0px",margin:"10px",fontSize:"16px",xdisplay:"flex",border:"1px solid #dddddd",minWidth:"290px",maxWidth:"290px"}},c.a.createElement("span",{onClick:function(){fe(pe.TILECLICKED,{"tile-key":p.tile.key,href:p.tile.externalArticle})}},c.a.createElement("a",{className:"TeamLink",href:p.tile.externalArticle,rel:"noopener noreferrer",target:"_blank"},c.a.createElement("div",null,c.a.createElement("div",{style:{minWidth:"288px",paddingLeft:"0px",paddingBottom:"0px"}},p.tile.icon&&c.a.createElement("div",{className:"teamTitleBar",style:{backgroundColor:p.tile.color,marginTop:"-20px"}},c.a.createElement("img",{src:p.tile.icon,style:{margin:"70px",height:"140px",width:"140px"}}))),c.a.createElement("div",{className:"teamTitleBar",style:{minWidth:"280px"}},c.a.createElement("div",{className:"ms-font-xl ",style:{padding:"8px",lineHeight:"32px",textAlign:"center"}},c.a.createElement(v,{text:p.tile.title,filter:e.filter,style:e.highlightStyle})))),p.tile.inShort&&c.a.createElement("div",{className:"ms-font-m",style:{fontStyle:"italic",marginTop:"10px",paddingLeft:"20px",paddingRight:"20px",margin:"0px"}},c.a.createElement("div",{style:{fontStyle:"italic",marginTop:"8px"}},c.a.createElement(v,{text:p.tile.inShort,filter:e.filter,style:e.highlightStyle}))))),c.a.createElement("div",null,l&&c.a.createElement(me,null)));var g=h.a.groupBy(p.data.endPoints?p.data.endPoints:[],(function(e){return e.providerName})),b=g.Yammer?g.Yammer[0].uri:function(e){if(e){var t=e.split("https://teams.microsoft.com/l/team/")[1].split("/conversations?"),n=e.split("groupId=")[1].split("&"),a=e.split("tenantId="),r=t[0],i=n[0],o=a[1],c="https://teams.microsoft.com/_?tenantId=".concat(o,"#/conversations/unknown?groupId=").concat(i,"&threadId=").concat(r,"&ctx=channel");"https://teams.microsoft.com/_?tenantId=".concat(o,"#/files/unknown?groupId=").concat(i,"&threadId=").concat(r,"&ctx=channel");return c}}(f),x=p.data&&p.data.details?p.data.details:{displayName:p.title?p.title:p.displayName?p.displayName:p["@odata.type"]},y=p.data?p.data.photo:null,E=p.data&&p.data.channels?p.data.channels:[];return c.a.createElement("div",{onMouseEnter:function(){u(!0)},onMouseLeave:function(){u(!1)},style:{paddingLeft:"0px",margin:"10px",fontSize:"16px",xdisplay:"flex",border:"1px solid #dddddd",minWidth:"290px",maxWidth:"290px"}},c.a.createElement("a",{className:"TeamLink",href:b,rel:"noopener noreferrer",target:"_blank"},c.a.createElement("div",null,c.a.createElement("div",{style:{minWidth:"290px",paddingLeft:"0px",paddingBottom:"0px"}},l&&c.a.createElement("div",{style:{position:"absolute"}}," ",c.a.createElement(me,null)),y&&c.a.createElement("img",{className:"teamImage",src:y,style:{height:"288px",width:"288px",marginLeft:"0px"}})),c.a.createElement("div",{className:"teamTitleBar",style:{minWidth:"280px"}},c.a.createElement("div",{className:"ms-font-xl ",style:{padding:"8px",lineHeight:"32px",textAlign:"center"}},c.a.createElement(v,{text:x.displayName,filter:e.filter,style:e.highlightStyle}))),c.a.createElement("div",{style:{border:"0px solid #dddddd",paddingBottom:"4px"}},c.a.createElement("div",{style:{display:"flex",marginRight:"10px",marginLeft:"10px",marginTop:"10px"}},c.a.createElement("div",{style:{flexGrow:1}},p.visibility),c.a.createElement("div",null,d(p.hasTeams,"TeamsLogo"),d(p.hasSharePoint,"SharepointLogo"),d(p.hasYammer,"YammerLogo"))))),x.displayName!==x.description&&c.a.createElement("div",{className:"ms-font-m",style:{fontStyle:"italic",marginTop:"10px",paddingLeft:"20px",paddingRight:"20px",margin:"0px"}},x.description),t&&c.a.createElement("div",{className:"ms-font-l ms-fontWeight-bold"},E.length>1&&c.a.createElement("div",{style:{marginTop:"10px",marginLeft:"20px"}},"Channels"),c.a.createElement("div",{className:"channelListing"},c.a.createElement("ul",{style:{xdisplay:"none",marginTop:"10px"}},E.map((function(t,n){return"$General"===t.displayName?null:c.a.createElement("li",{key:n,className:"ms-font-m"},c.a.createElement("div",{style:{color:"private"===t.membershipType?"red":"#000000"}},c.a.createElement(v,{text:t.displayName,filter:e.filter,style:e.highlightStyle})),t.description&&c.a.createElement("div",{style:{fontSize:"smaller",fontStyle:"italic"}},c.a.createElement(v,{text:t.description,filter:e.filter,style:e.highlightStyle})),t.tabs&&c.a.createElement("div",{className:"channelTabs"},c.a.createElement("ul",null,c.a.createElement("li",null," ",c.a.createElement("span",{onClick:function(){fe(pe.TABCLICKED,{"team-name":x.displayName,"channel-name":t.displayName,href:t.filesLink})}},c.a.createElement("a",{href:t.generalLink,target:"_blank"},"General"))),c.a.createElement("li",null,c.a.createElement("span",{onClick:function(){fe(pe.TABCLICKED,{"team-name":x.displayName,"channel-name":t.displayName,href:t.filesLink})}},c.a.createElement("a",{href:t.filesLink,target:"_blank"},"Files"))),h.a.sortBy(t.tabs,["sortOrderIndex"]).map((function(n,a){return c.a.createElement("li",{key:a},c.a.createElement("span",{onClick:function(){fe(pe.TABCLICKED,{"team-name":x.displayName,"channel-name":t.displayName,"tab-name":n.displayName,href:t.filesLink})}},c.a.createElement("a",{href:n.configuration&&n.configuration.websiteUrl?n.configuration.websiteUrl:n.webUrl,target:"_blank"},c.a.createElement(v,{text:decodeURIComponent(n.displayName),filter:e.filter,style:e.highlightStyle}))))})))))}))))),c.a.createElement("div",null,r&&c.a.createElement("div",{style:{display:"xflex"}},p.expirationDateTime&&c.a.createElement("div",{style:{flexGrow:1}},"Expires in ",te()(p.expirationDateTime).fromNow(!0)))," ")))}var be,xe,ye=n(578),Ee=n(579),Ae=(n(243),n(515),n(516),n(110),n(258),n(259)),we={clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",directoryId:"common",scopes:"user.readwrite.all group.read.all Files.ReadWrite.All",title:"Tools",logo:n.n(Ae).a,defaultTableAPI:"https://api.jumpto365.com/table/hexatown.com/PTO365",niels:"niels@jumpto365.com",teamsIntegration:!0,options:[],components:{header:c.a.createElement("div",{style:{marginTop:"80px"}},c.a.createElement("div",{style:{borderBottom:"1px solid #cccccc",position:"fixed",backgroundColor:"#ffffff",width:"100vw",left:0,top:0,zIndex:1}},c.a.createElement("div",{style:{display:"flex",padding:"10px"}},c.a.createElement("div",{style:{flexGrow:1,display:"flex"}},c.a.createElement("div",null,c.a.createElement("a",{style:{color:"inherit",textDecoration:"none"},href:"/",target:"_blank"}," ",c.a.createElement("div",{className:"ms-font-xxl",style:{marginLeft:"16px",lineHeight:"36px",padding:"0px",color:"333"}},"LAUNZH\u2122 by jumpto365")))),c.a.createElement("div",null),c.a.createElement("div",{style:{flexGrow:1}},c.a.createElement("div",{style:{minWidth:"150px"}},"\xa0")))))}},Oe=n(155),je=n.n(Oe),ke=n(260),Se="com.ztickybar.tools",Ie="Apps/jumpto365.com",Ce="launchpad.json";function Ne(e){return new Promise((function(t,n){var a=[],r=0;e.forEach((function(e){a.push(e.id),r++,B(Ie,Te(e.id),e).then((function(){--r<1&&B(Ie,"memberships.json",a).then((function(){t(a)})).catch((function(e){n(e)}))}))}))}))}function Te(e){return"membership."+e+".json"}function De(e,t,n,a,r,i){return Le.apply(this,arguments)}function Le(){return(Le=Object(i.a)(r.a.mark((function e(t,n,a,o,c,s){var l,u,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m=function(){return(m=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(Ie,Ce).catch(function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B(Ie,Ce,{version:ke.version}).catch((function(e){o(e.message)}));case 2:e.sent&&o("OK");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:e.sent&&o("OK");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)},u=function(){return m.apply(this,arguments)},T().then((function(e){t("OK")})).catch((function(e){t(e.message)})),e.next=5,U(Se,{hello:"world"}).catch((function(e){n(e.message)}));case 5:((l=e.sent)||""===l)&&n("OK"),P(Ie).then((function(e){a("OK"),u()})).catch(function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P("Apps").catch((function(e){}));case 2:if(!e.sent){e.next=10;break}return e.next=6,W("Apps","jumpto365.com").catch((function(e){a(e.message)}));case 6:e.sent&&(a("OK"),u()),e.next=17;break;case 10:return e.next=12,R("Apps").catch((function(e){a(e.message)}));case 12:return e.sent,e.next=15,W("Apps","jumpto365.com").catch((function(e){a(e.message)}));case 15:e.sent&&(a("OK"),u());case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),D().then((function(e){var t;c("OK"),e.forEach((function(e){e.displayName&&(t||(t=e.id))})),t?L(t).then((function(e){s("OK")})).catch((function(e){s(e.message)})):s("Didn't find any Microsoft Teams memberships")})).catch((function(e){c(e.message)}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ze(e){var t=Object(o.useState)(we.teamsIntegration||function(t){try{return e.auth.user.userPrincipalName===t}catch(n){return!1}}(we.niels)),n=Object(m.a)(t,2),a=n[0],s=(n[1],Object(o.useState)("")),l=Object(m.a)(s,2),p=l[0],f=l[1],g=Object(o.useState)(""),v=Object(m.a)(g,2),x=v[0],A=v[1],w=Object(o.useState)(""),O=Object(m.a)(w,2),j=O[0],k=O[1],S=Object(o.useState)([]),I=Object(m.a)(S,2),C=I[0],N=I[1],T=Object(o.useState)(!1),D=Object(m.a)(T,2),L=(D[0],D[1],Object(o.useState)(!1)),z=Object(m.a)(L,2),P=(z[0],z[1],Object(o.useState)(!1)),B=Object(m.a)(P,2),R=B[0],W=B[1],U=Object(o.useState)(null),G=Object(m.a)(U,2),J=G[0],H=G[1],q=Object(o.useState)({}),Y=Object(m.a)(q,2),V=(Y[0],Y[1],Object(o.useState)({})),Z=Object(m.a)(V,2),K=(Z[0],Z[1],Object(o.useState)([])),_=Object(m.a)(K,2),Q=_[0],X=(_[1],Object(o.useState)("")),$=Object(m.a)(X,2),ee=$[0],te=$[1],ne=Object(o.useState)(1),ae=Object(m.a)(ne,2),re=ae[0],ie=(ae[1],Object(o.useState)([])),oe=Object(m.a)(ie,2),ce=oe[0],se=oe[1],le=Object(o.useState)([]),ue=Object(m.a)(le,2),me=ue[0],de=ue[1],he=Object(o.useState)(""),ve=Object(m.a)(he,2),Ae=(ve[0],ve[1],Object(o.useState)("")),Oe=Object(m.a)(Ae,2),ke=(Oe[0],Oe[1],Object(o.useState)(!1)),Se=Object(m.a)(ke,2),Ce=Se[0],De=Se[1],Le=Object(o.useState)(""),ze=Object(m.a)(Le,2),Pe=ze[0],Me=ze[1],Be=Object(o.useState)(null),Re=Object(m.a)(Be,2),We=Re[0],Ue=Re[1],Ge=Object(o.useState)(!1),Je=Object(m.a)(Ge,2),Fe=Je[0],He=(Je[1],Object(o.useState)(!0)),qe=Object(m.a)(He,2),Ye=(qe[0],qe[1],Object(o.useState)(!1)),Ve=Object(m.a)(Ye,2),Ze=Ve[0],Ke=(Ve[1],Object(o.useState)("")),_e=Object(m.a)(Ke,2),Qe=_e[0],Xe=_e[1],$e=Object(o.useState)({}),et=Object(m.a)($e,2),tt=(et[0],et[1],Object(o.useState)("pinned")),nt=Object(m.a)(tt,2),at=(nt[0],nt[1],Object(o.useState)(0)),rt=Object(m.a)(at,2),it=rt[0],ot=rt[1],ct=Object(o.useState)([]),st=Object(m.a)(ct,2),lt=st[0],ut=st[1],mt=Object(o.useState)(!1),pt=Object(m.a)(mt,2),dt=pt[0],ft=pt[1],ht=Object(o.useState)("https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE"),gt=Object(m.a)(ht,2),vt=(gt[0],gt[1],Object(o.useState)("")),bt=Object(m.a)(vt,2),xt=bt[0],yt=(bt[1],Object(o.useState)([])),Et=Object(m.a)(yt,2),At=(Et[0],Et[1]),wt=function(){try{return window.self!==window.top}catch(e){return!0}}();function Ot(e){k(e),h.a.startsWith(e,".")||A(e)}function jt(e){return kt.apply(this,arguments)}function kt(){return(kt=Object(i.a)(r.a.mark((function e(t){var n,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=0,a=localStorage.getItem("memberships"),e.prev=4,!a||t){e.next=9;break}return o=JSON.parse(a),de(o),e.abrupt("return");case 9:e.next=13;break;case 11:e.prev=11,e.t0=e.catch(4);case 13:return De(!0),e.next=16,new Promise(function(){var e=Object(i.a)(r.a.mark((function e(t,n){var a,i,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(Ie,"memberships.json").catch((function(e){n(e)}));case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:i=0,o=[],a.forEach((function(e){i++,M(Ie,Te(e)).then((function(e){o.push(e),--i<1&&t(o)})).catch((function(e){n(e)}))}));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()).catch((function(e){ce.push({context:"readCache",error:e}),se(ce)}));case 16:return(o=e.sent)&&!t?(de(o),localStorage.setItem("memberships",JSON.stringify(me)),De(!1)):(n++,Me("Loading"),F((function(e){Ue(e)})).then(function(){var e=Object(i.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ne(t).catch((function(e){ce.push({context:"saveCache",error:e}),se(ce)}));case 2:localStorage.setItem("memberships",JSON.stringify(t)),0===--n&&De(!1),fe(pe.MEMBERSHIPSREAD,{"count-memberships":t.length}),de(t),Me("");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){--n<=0&&De(!1),ce.push({context:"OfficeGraph.teamMemberships()",error:e}),se(ce),Me("")}))),e.abrupt("return");case 21:e.prev=21,e.t1=e.catch(0),ce.push({context:"initGraph",error:e.t1}),se(ce);case 25:case"end":return e.stop()}}),e,null,[[0,21],[4,11]])})))).apply(this,arguments)}function St(e){if(!x)return!0;var t=e&&e.title&&-1!==e.title.toLowerCase().indexOf(x.toLowerCase());return t||(t=e&&e.inShort&&-1!==e.inShort.toLowerCase().indexOf(x.toLowerCase())),t||(t=e&&e.subTitle&&-1!==e.subTitle.toLowerCase().indexOf(x.toLowerCase())),t}Object(o.useEffect)((function(){a&&jt(!1);var e=function(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var a=n[1].split("&"),r=0;r<a.length;r++){var i=a[r].split("=");t[i[0]]=decodeURIComponent(i[1])}return t}(window.location.href);e.ztickyref&&te(e.ztickyref);var t=e.src?e.src:we.defaultTableAPI;Xe(we.defaultTableAPI),function(e,t){d.a.get(e).then((function(n){var a=n.data;f(a.titlegraphics);var r=[];if(a.grid){var i={},o={};a.grid.forEach((function(e){return e.forEach((function(e){e.groupSetting&&(i[e.groupSetting.title]={groupSetting:e.groupSetting,members:e.members},e.members&&e.members.forEach((function(t){var n=o[t]?o[t]:[];n.push(e.groupSetting),o[t]=n})))}))}));var c=h.a.keys(i).map((function(e){return Object(u.a)({title:e},i[e])}));At(h.a.sortBy(c,["title"])),a.grid.forEach((function(n){return n.forEach((function(n){if(n.tile&&n.tile.title){var a=Object(u.a)({},n.tile);a.sortKey=h.a.toLower(n.tile.title),a.tableId=t,a.correlation=e+"#"+(a.key?a.key:a.title?a.title.toLowerCase():a.id);var i=o[n.id];a.references=i,r.push(a)}}))}))}N(h.a.sortBy(r,["sortKey"]))}))}(t,we.defaultTableKey)}),[it]);var It=x||0!==lt.length?[]:C,Ct=x||0!==lt.length?[]:Q,Nt=x||0!==lt.length?[]:me;x||lt.length,ee&&new URL(ee);if(x||lt.length>0){if(C.forEach((function(e){St(e)&&It.push(e)})),Q.forEach((function(e){St(e.tile)&&Ct.push(e)})),me.forEach((function(e){(function(e){var t=!0;if(lt.length>0&&(t=!1,lt.forEach((function(n){switch(n.id){case"sharepoint":e.hasSharePoint&&(t=!0);break;case"teams":e.hasTeams&&(t=!0);break;case"yammer":e.hasYammer&&(t=!0);break;case"private":"Private"===e.visibility&&(t=!0);break;case"public":"Public"===e.visibility&&(t=!0)}}))),!t)return!1;if(!x)return!0;var n=e.data&&e.data.details?e.data.details:{},a=e.data&&e.data.channels?e.data.channels:[],r=n.displayName&&-1!==n.displayName.toLowerCase().indexOf(x.toLowerCase());return r||(r=n.description&&-1!==n.description.toLowerCase().indexOf(x.toLowerCase())),a.forEach((function(e){r||(r=e.displayName&&-1!==e.displayName.toLowerCase().indexOf(x.toLowerCase())),r||(r=e.description&&-1!==e.description.toLowerCase().indexOf(x.toLowerCase()))})),r})(e)&&Nt.push(e)})),xe&&xe["search-for"]&&xe["search-for"]===x)return;xe={"search-for":x,"found-memberships":Nt.length,"found-tiles":Ct.length},be&&(console.log("Postponing search trace"),clearTimeout(be)),console.log("Timeing search trace"),be=setTimeout((function(){console.log("sending search trace"),fe(pe.SEARCHING,xe),be=null}),1e3)}return!e||!e.auth&&e.auth.user?c.a.createElement("div",null,c.a.createElement("h1",null,"Sorry - You cannot get in here"),JSON.stringify(e&&e.auth&&e.auth.error?e.auth.error:"")):c.a.createElement("div",null,!wt&&we.components.header,c.a.createElement("div",{style:{paddingRight:"20px",paddingLeft:"20px"}}," ",Pe&&c.a.createElement("div",{style:{backgroundColor:"white",width:"100vw",position:"fixed",top:"0px",zIndex:2}},c.a.createElement(ye.a,{percentComplete:We,xlabel:"Example title",xdescription:Pe})),c.a.createElement("img",{style:{display:"none",height:"64px",margin:"13px",position:"fixed",bottom:"0px",right:"0px"},src:p}),R&&c.a.createElement("div",null,c.a.createElement(y,{tile:J||(C?C[0]:null),onClose:function(){W(!1)}})),!R&&c.a.createElement("div",{style:{display:"flex"}}," ",c.a.createElement("div",{style:{display:"xnone",paddingRight:"8px",position:"fixed",bottom:"0px",backgroundColor:"white"}},a&&c.a.createElement("div",null,c.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},className:"ms-Icon ms-Icon--Refresh",onClick:function(){jt(!0)},"aria-hidden":"true"})," ",Ce&&c.a.createElement(c.a.Fragment,null,"Loading"))),c.a.createElement("div",{style:{position:"fixed",right:0,top:0,zIndex:32,marginRight:"16px"}},c.a.createElement("div",{style:{display:"flex"}},c.a.createElement("div",{style:{padding:"16px",marginTop:"0px"}},"Details"),c.a.createElement("div",{style:{marginTop:"16px"}},c.a.createElement(Ee.a,{xlabel:"Show Table",checked:dt,xonText:"Table view On",xoffText:"Table view Off",onChange:function(e,t){var n;ft(n=t),fe(pe.DETAILSTOGGLED,{on:n}),ot(it+1)}})))),c.a.createElement("div",{style:{flexGrow:"1"}},c.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",marginTop:"8px"}},c.a.createElement("div",{style:{padding:"0px",marginLeft:"8px",flexGrow:1}},c.a.createElement(E.a,{autoFocus:!0,disabled:Fe,xlabel:"Filter",value:j,onChange:function(e,t){Ot(t)},placeholder:"Start typing any characters to filter ",iconProps:{iconName:"Filter"}}),c.a.createElement(je.a,{placeholder:"Filter by tag, like Yammer, Teams ...",autofocus:!1,tags:lt,suggestions:[{name:"Teams",id:"teams"},{name:"SharePoint",id:"sharepoint"},{name:"Yammer",id:"yammer"},{name:"Private",id:"private"},{name:"Public",id:"public"}],handleDelete:function(e){var t=lt.slice(0);t.splice(e,1),ut(t),ot(it+1)},handleAddition:function(e){var t=[].concat(lt,e);ut(t),ot(it+1)}}))," "),a&&!1,Ct.length>0&&c.a.createElement("div",null,c.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},Ct.map((function(e,t){var n=e.tile?e.tile:{title:e.name,color:"#dddddd"};return c.a.createElement(b,{tileSize:re,isPinned:!0,key:t,tile:n,filter:x,highlightStyle:{backgroundColor:"yellow",color:"#333"},onClick:function(e){if(!e.messageBeforeLaunch&&e.jumpto)return window.open(e.jumpto,"_blank");H(e),W(!0)}})})))),Fe&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{style:{textAlign:"right"}},c.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},class:"ms-Icon ms-Icon--OpenInNewWindow",onClick:function(){window.open(Qe,"_blank")},"aria-hidden":"true"})),c.a.createElement("iframe",{style:{border:"0",height:"calc(100vh - 150px",width:"95vw"},src:Qe})),a&&me.length>0&&c.a.createElement(ge,{refreshCounter:it,tiles:It,details:dt,memberShips:Nt,filter:x,highlightStyle:{backgroundColor:"yellow"}}),!Fe&&!a&&c.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},0===It.length&&c.a.createElement("div",null,c.a.createElement("h2",null,'Sorry. No matches for "',x,'"')),It.map((function(t,n){if(xt){var a=!1;if(!t.references)return c.a.createElement(c.a.Fragment,null);if(t.references.forEach((function(e){e.title===xt&&(a=!0)})),!a)return c.a.createElement(c.a.Fragment,null)}return c.a.createElement(b,{tileSize:re,key:n,filter:x,highlightStyle:{backgroundColor:"yellow",color:"#333"},tile:t,onPinnedClicked:function(e){e.tile&&(e.tile,Me("Adding pin"))},onClick:function(t){if(window.amplitude&&(e&&e.auth&&e.auth.user&&e.auth.user.userPrincipalName&&window.amplitude.getInstance().identify(e.auth.user.userPrincipalName),window.amplitude.getInstance().logEvent("tool",t)),t.jumpto&&!t.messageBeforeLaunch)return window.open(t.jumpto,"_blank");H(t),W(!0)}})})))),Ze&&c.a.createElement("div",{style:{borderLeft:"1px solid #dddddd",borderTop:"1px solid #dddddd",padding:"8px",float:"right",minWidth:"300px"}},c.a.createElement("div",{style:{padding:"0px"}},c.a.createElement(E.a,{label:"Filter",value:j,onChange:function(e,t){Ot(t)},placeholder:"Filter the list of tools",iconProps:{iconName:"Filter"}}))))),e&&e.auth&&e.auth.user&&c.a.createElement("div",{style:{textAlign:"center"}},'Your are signed in as "',e.auth.user.displayName,'" with upn'," ",e.auth.user.userPrincipalName,'". Visit your Office profile at \xa0',c.a.createElement("a",{href:"https://portal.office.com/account/#apps",target:"_blank"},"https://portal.office.com/account/#apps")))}function Pe(e){var t=Object(o.useState)("pending"),n=Object(m.a)(t,2),a=n[0],s=n[1],l=Object(o.useState)("pending"),u=Object(m.a)(l,2),p=u[0],d=u[1],f=Object(o.useState)("pending"),h=Object(m.a)(f,2),g=h[0],v=h[1],b=Object(o.useState)("pending"),x=Object(m.a)(b,2),y=x[0],E=x[1],A=Object(o.useState)("pending"),w=Object(m.a)(A,2),O=w[0],j=w[1],k=Object(o.useState)("pending"),S=Object(m.a)(k,2),I=S[0],C=S[1],N=function(){try{return window.self!==window.top}catch(e){return!0}}();return Object(o.useEffect)((function(){function e(){return(e=Object(i.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,De(s,E,j,C,d,v);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),c.a.createElement("div",null,c.a.createElement("div",{className:"OnboardingContainer",dir:"ltr"},!N&&we.components.header,c.a.createElement("div",null,c.a.createElement("p",{className:"ms-fontSize-20"},"Verifying access"),c.a.createElement("ul",null,c.a.createElement("li",null,"Checking access to your profile: (",a,")"),c.a.createElement("li",null,"Checking access to your extension: (",y,")"),c.a.createElement("li",null,"Checking access to your memberships: (",p,")"),c.a.createElement("li",null,"Checking access to your teams: (",g,")"),c.a.createElement("li",null,"Checking access to your OneDriver folders: (",O,")"),c.a.createElement("li",null,"Checking access to the OneDrive files which we maintain: (",I,")")))))}Object(A.a)();var Me="getAccessToken",Be="restoreUrl",Re="getGraphUser",We="login",Ue="access_token",Ge="access_expires";function Je(e,t){return new Promise((function(n,a){var r=("localhost"===window.location.hostname?window.location.protocol:"https:")+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+"/",i="https://login.microsoftonline.com/".concat(e.directoryId,"/oauth2/v2.0/authorize"),o=e.clientId,c=e.scopes,s="",l=function(e){if(!e)return{};var t={},n=e.split("#");if(n.length>1)for(var a=n[1].split("&"),r=0;r<a.length;r++){var i=a[r].split("=");t[i[0]]=decodeURIComponent(i[1])}return t}(window.location.href),u=function(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var a=n[1].split("&"),r=0;r<a.length;r++){var i=a[r].split("=");t[i[0]]=decodeURIComponent(i[1])}return t}(window.location.href);if(l.id_token?s=Me:l.access_token?s=Be:l.login?s=We:""===s&&(s=sessionStorage.getItem(Ue)?function(){try{var e=sessionStorage.getItem(Ge),t=te()(e);return te()().diff(t)>0}catch(n){return!0}}()?Me:Re:Me),l.error||u.error){var m=!1;switch(l.error?l.error:u.error){case"interaction_required":t&&t(),sessionStorage.removeItem("accesstoken"),sessionStorage.removeItem("idtoken");var p="".concat(i,"?client_id=").concat(o,"&response_type=").concat("id_token","&redirect_uri=").concat(r,"&response_mode=").concat("fragment","&scope=openid&nonce=1");return void(window.location.href=p);case"consent_required":t&&t(),sessionStorage.removeItem("accesstoken"),sessionStorage.removeItem("idtoken");p="".concat(i,"?client_id=").concat(o,"&prompt=consent&response_type=token&redirect_uri=").concat(r,"&response_mode=").concat("fragment","&scope=openid&nonce=1");return void(window.location.href=p);case"invalid_request":break;default:return void(sessionStorage.setItem("returnto","/")&&(window.location.href="#login"))}if(!m)return alert(l.error_description?l.error_description:u.error_description),void a(l.error_description)}switch(s){case We:sessionStorage.setItem("returnto",window.location.href);p="".concat(i,"?client_id=").concat(o,"&prompt=none&response_type=token&redirect_uri=").concat(r,"&response_mode=").concat("fragment","&scope=").concat(c,"&nonce=1");return void(window.location.href=p);case Me:sessionStorage.setItem("returnto",window.location.href);p="".concat(i,"?client_id=").concat(o,"&prompt=none&response_type=token&redirect_uri=").concat(r,"&response_mode=").concat("fragment","&scope=").concat(c);return void(window.location.href=p);case Re:sessionStorage.removeItem("returnto"),d.a.get("https://graph.microsoft.com/v1.0/me",{headers:{"content-type":"application/json",authorization:"Bearer ".concat(sessionStorage.getItem(Ue))}}).then((function(e){n({user:e.data})})).catch((function(e){e.response.data.error.message;e&&e.response&&e.response.data&&e.response.data.error?n({error:e.response.data.error.message}):n({error:e})}));break;case Be:if(l.access_token){sessionStorage.setItem(Ue,l.access_token);var f=te()().add(l.expires_in,"s");return sessionStorage.setItem(Ge,f.toISOString()),void(sessionStorage.getItem("returnto")&&(window.location.href=sessionStorage.getItem("returnto")))}window.location.reload(),n();break;default:n({error:"Sorry to have put you in this situation, but our authentication logic is not able to detect the next step to taka so we cannot let you in"})}}))}var Fe=n(568),He=n(581),qe=n(575),Ye=n(264),Ve=Object(ae.x)({defaultFontStyle:{fontFamily:"Monaco, Menlo, Consolas",fontWeight:"regular"},fonts:{small:{fontSize:"11px"},medium:{fontSize:"13px"},large:{fontSize:"20px",fontWeight:"semibold"},xLarge:{fontSize:"22px",fontWeight:"semibold"}}});function Ze(){return(Ze=Object(i.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Je(we,(function(){})).catch((function(e){console.log(e),document.getElementById("root").innerHTML=e}));case 2:(t=e.sent)&&t.user&&(de(t.user.userPrincipalName),"HASLANDED",sessionStorage.getItem("HASLANDED")||(fe(pe.LANDING),sessionStorage.setItem("HASLANDED","1"))),l.a.render(c.a.createElement(He.a,Fe.a,c.a.createElement(qe.a,{theme:Ve},c.a.createElement(Ye.a,null,c.a.createElement(Pe,{path:"check"}),c.a.createElement(ze,{auth:t,path:"/"})))),document.getElementById("root"));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){Ze.apply(this,arguments)}()}},[[272,1,2]]]);
//# sourceMappingURL=main.3ccbbdbf.chunk.js.map