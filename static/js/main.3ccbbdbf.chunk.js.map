{"version":3,"sources":["components/ToolboxLayout.js","config/default/favicon-96x96.png","components/Tags.js","components/Highlight.js","components/AppSuperTile.js","components/AppFullSizeTile.js","helpers/OfficeGraph/index.js","components/GroupMouseOver.js","helpers/trace.js","components/ViewTeams.js","App.js","config/index.js","helpers/LaunchPad.js","helpers/index.js","Onboard.js","authenticate.js","index.js"],"names":["ResponsiveReactGridLayout","WidthProvider","Responsive","ToolBoxItem","className","onClick","this","props","onTakeItem","bind","undefined","item","i","React","Component","ToolboxLayout","onBreakpointChange","breakpoint","setState","prevState","currentBreakpoint","toolbox","onCompactTypeChange","oldCompactType","state","compactType","filter","layouts","onPutItem","onLayoutChange","layout","key","value","global","localStorage","setItem","JSON","stringify","persist","onNewLayout","lg","generateLayout","mounted","tools","map","tool","ix","x","y","w","h","toString","static","initialLayout","that","_","l","tile","title","style","backgroundColor","color","textcolor","cursor","editingLayout","onTileClick","src","icon","height","maxHeight","width","padding","isDraggable","measureBeforeMount","useCSSTransforms","preventCollision","generateDOM","range","Math","ceil","random","floor","defaultProps","rowHeight","cols","md","sm","xs","xxs","module","exports","Tags","references","display","flexWrap","group","margin","textColor","Highlight","text","toLowerCase","indexOf","first","substr","middle","length","last","AppSuperTile","useState","tileSize","border","maxWidth","borderRadius","overflow","marginTop","flexGrow","lineHeight","marginLeft","fontSize","highlightStyle","alignItems","class","isPinned","e","onPinnedClicked","preventDefault","stopPropagation","aria-hidden","textAlign","inShort","justifyContent","externalArticle","href","rel","target","AppFullSizeTile","html","setHtml","error","setError","useEffect","contentRef","axios","get","then","result","converter","QuillDeltaToHtmlConverter","data","ops","convert","catch","response","status","message","onClose","textOverflow","whiteSpace","paddingLeft","xheight","messageBeforeLaunch","jumpto","dangerouslySetInnerHTML","__html","graph","analyseMembers","token","emailAddresses","cb","addresses","split","forEach","element1","element2","match","smtp","push","checked","results","address","readUser","err","user","invite","emailAddress","invitationRedirectUrl","post","invitedUserEmailAddress","inviteRedirectUrl","invitedUserDisplayName","sendInvitationMessage","invitedUserMessageInfo","customizedMessageBody","ccRecipients","name","addcrm","tag","msg","properties","property","post2","addmember","userId","groupId","getSharePointList","host","site","list","listfilter","itemfilter","items","itemList","next","pop","id","getPages","readGroupMembers","readGroupMemberShipFor","upn","readManager","userPrincipalName","index","matchingGroups","searchText","findGroup","getGroupDocuments","folderName","getGroupDrive","getGroupSite","getDriveChildren","driveId","itemId","getGroupRootFolders","getSharePointSiteByName","hostName","relativePath","getSharePointSiteDrive","path","copyfile","groupNickName","fromFolder","fromName","toFolder","toName","groups","fromItems","find","targetFolders","destFolder","newDoc","parentReference","sourceGroupId","lookupFile","iterations","file","console","log","iteration","setTimeout","Client","url","Promise","resolve","reject","payload","patch","body","headers","authorization","put","getRaw","request","getImage","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","readAsDataURL","open","setRequestHeader","responseType","send","auth","getAccessToken","get2","put2","me","myGroups","readTeam","getMyExtention","extensionName","getOneDriveFolder","folderNameWithOutInitialSlash","getOneDriveFile","filename","a","folder","saveOneDriveFile","createOneDriveFolder","createOneDriveFolderChild","parentFolderNameWithOutInitialSlash","driveItem","saveMyExtention","updateMyExtention","r","addMyExtention","patch2","teamMemberships","reportProgessPercent","client","memberships","pending","total","processed","readGroup","sort","b","displayName","description","photo","details","creationOptions","v","hasYammer","hasSharePoint","resourceProvisioningOptions","readChannels","channels","readEndpoints","endPoints","hasTeams","queue","channel","tabs","appendTo","retrycount","parsedBody","errCounter","parse","concat","sessionStorage","getItem","dragOptions","moveMenuItemText","closeMenuItemText","menu","ContextualMenu","cancelIcon","iconName","theme","getTheme","contentStyles","mergeStyleSets","container","flexFlow","header","fonts","xLargePlus","flex","borderTop","palette","themePrimary","neutralPrimary","fontWeight","FontWeights","semibold","overflowY","selectors","p","marginBottom","iconButtonStyles","root","marginRight","rootHovered","neutralDark","GroupMouseOver","isModalOpen","setIsModalOpen","Modal","titleAriaId","isOpen","onDismiss","isBlocking","containerClassName","IconButton","styles","iconProps","ariaLabel","EVENT","LANDING","ONBOARDING","SEARCHING","TILECLICKED","TABCLICKED","DETAILSTOGGLED","MEMBERSHIPSREAD","who","window","amplitude","amp","getInstance","setUserId","s","setDomain","trace","event","logEvent","Object","freeze","breakpointColumnsObj","default","3500","3100","2700","2300","1900","1500","1100","700","500","ViewTeams","viewDates","memberShips","cloneDeep","tiles","sortBy","minWidth","breakpointCols","columnClassName","team","ViewTeam","viewChannels","mouseOver","setMouseOver","logo","show","c","webUrl","xdisplay","paddingBottom","fontStyle","paddingRight","uniqueEndPoints","groupBy","endPoint","providerName","conversationsHref","uri","part2","part4","part5","threadId","tenantId","teamsLink","onMouseEnter","onMouseLeave","position","visibility","membershipType","filesLink","generalLink","tab","configuration","websiteUrl","decodeURIComponent","expirationDateTime","moment","fromNow","logSearchTimer","searchInfo","clientId","directoryId","scopes","defaultTableAPI","niels","teamsIntegration","options","components","borderBottom","left","top","zIndex","textDecoration","extentionName","OURPATH","OURCONFIGFILENAME","saveCache","membershipIndex","membership","cachedFileName","verifyAccessForLanuchPad","setCheckMe","setCheckMyExtention","setCheckOneDrive","setCheckOneDriveFiles","setCheckMemberships","setCheckTeam","checkAccessToConfig","version","projectInfo","m","hello","extention","teamId","member","App","config","upnIs","showTabFeature","titlegraphics","setTitlegraphics","_setFilter","search","setSearch","setTiles","isZoomed","setIsZoomed","currentTile","setCurrentTile","myTools","ztickyRef","setZtickyRef","errors","setErrors","setMemberships","refreshing","setRefresing","progress","setProgress","progressPercent","setProgressPercent","showTable","showFilterOptions","tableUrl","setTableUrl","refreshCounter","setRefreshCounter","tags","setTags","showDetails","_setShowDetails","selectedGroup","setGroups","inFrame","self","inIframe","setFilter","startsWith","initGraph","refresh","queueCount","localCache","cachedMemberships","context","percent","matchFilter","subTitle","s1","s2","s3","getSearchParametersFromHRef","location","ztickyref","tableId","grid","groupRefs","row","cell","groupSetting","members","refs","ga","keys","sortKey","toLower","correlation","readGrid","defaultTableKey","filteredTiles","filteredMyTools","filteredMemberShips","URL","include","matchTeam","clearTimeout","ProgressIndicator","percentComplete","xlabel","xdescription","bottom","right","Toggle","xonText","xoffText","onChange","on","TextField","autoFocus","disabled","newValue","placeholder","autofocus","suggestions","handleDelete","tgs","slice","splice","handleAddition","identify","borderLeft","float","label","Onboard","checkMe","checkMemberships","checkTeam","checkMyExtention","checkOneDrive","checkOneDriveFiles","run","dir","initializeIcons","GETACCESSTOKEN","RESTOREURL","GETGRAPHUSER","LOGIN","ACCESSTOKEN","ACCESSEXPIRES","authenticate","callBackNotifyIfInteractionIsRequired","redirect_uri","hostname","protocol","port","client_id","scope","seq","getSearchParametersFromHash","search2","id_token","access_token","login","exp","expiresIn","diff","isAccessTokenExpired","handled","removeItem","alert","error_description","Axios","expires","add","expires_in","toISOString","reload","loadTheme","defaultFontStyle","fontFamily","small","medium","large","xLarge","document","getElementById","innerHTML","ReactDOM","render","Customizer","FluentCustomizations","Fabric","start"],"mappings":"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","file":"static/js/main.3ccbbdbf.chunk.js","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport { Responsive, WidthProvider } from \"react-grid-layout\";\nimport \"./Toolbox.css\";\nconst ResponsiveReactGridLayout = WidthProvider(Responsive);\n\nclass ToolBoxItem extends React.Component {\n  render() {\n    return (\n      <div\n        className=\"toolbox__items__item\"\n        onClick={this.props.onTakeItem.bind(undefined, this.props.item)}\n      >\n        {this.props.item.i}\n      </div>\n    );\n  }\n}\nclass ToolBox extends React.Component {\n  render() {\n    return (\n      <div className=\"toolbox\">\n        <span className=\"toolbox__title\">Toolbox</span>\n        <div className=\"toolbox__items\">\n          {this.props.items.map(item => (\n            <ToolBoxItem\n              key={item.i}\n              item={item}\n              onTakeItem={this.props.onTakeItem}\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default class ToolboxLayout extends React.Component {\n  static defaultProps = {\n    className: \"layout\",\n    rowHeight: 30,\n    onLayoutChange: function() {},\n    cols: { lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 },\n    initialLayout: generateLayout()\n  };\n\n  constructor(props) {\n    super(props);\n    \n    this.state = {\n      currentBreakpoint: \"lg\",\n      compactType: \"vertical\",\n      mounted: false,\n      layouts: props.layouts ? props.layouts : {\n        lg: props.tools\n          ? props.tools.map((tool, ix) => {\n              return {\n                x: 0,\n                y: ix,\n                w:3,\n                h:3,\n               \n                i: ix.toString(),\n\n                static: 0 //Math.random() < 0.05,\n              };\n            })\n          : props.initialLayout\n      },\n      toolbox: { lg: [] }\n    };\n  }\n\n  componentDidMount() {\n    this.setState({ mounted: true });\n  }\n\n  generateDOM() {\n    var that = this;\n    return _.map(this.state.layouts[this.state.currentBreakpoint], l => {\n      var tile = that.props.tools && that.props.tools[l.i] &&  that.props.tools[l.i].tile?   that.props.tools[l.i].tile : {title:l.i};\n      return (\n        <div  style={{backgroundColor:tile.color,color:tile.textcolor,cursor:!this.props.editingLayout ? \"pointer\" :\"default\"}}  \n        onClick={()=>{if (this.props.onTileClick &&  !this.props.editingLayout){this.props.onTileClick(tile)}}}\n        key={l.i} className={l.static ? \"static\" : \"\"}>\n          \n              <img src={tile.icon} style={{height:\"100%\",maxHeight:\"128px\",width:\"auto\",padding:\"8px\"}}></img>\n            <span className=\"text\">{tile.title } </span>\n          \n        </div>\n      );\n    });\n  }\n\n  \n \n  onBreakpointChange = breakpoint => {\n    this.setState(prevState => ({\n      currentBreakpoint: breakpoint,\n      toolbox: {\n        ...prevState.toolbox,\n        [breakpoint]:\n          prevState.toolbox[breakpoint] ||\n          prevState.toolbox[prevState.currentBreakpoint] ||\n          []\n      }\n    }));\n  };\n\n  onCompactTypeChange = () => {\n    const { compactType: oldCompactType } = this.state;\n    const compactType =\n      oldCompactType === \"horizontal\"\n        ? \"vertical\"\n        : oldCompactType === \"vertical\"\n        ? null\n        : \"horizontal\";\n    this.setState({ compactType });\n  };\n\n  onTakeItem = item => {\n    this.setState(prevState => ({\n      toolbox: {\n        ...prevState.toolbox,\n        [prevState.currentBreakpoint]: prevState.toolbox[\n          prevState.currentBreakpoint\n        ].filter(({ i }) => i !== item.i)\n      },\n      layouts: {\n        ...prevState.layouts,\n        [prevState.currentBreakpoint]: [\n          ...prevState.layouts[prevState.currentBreakpoint],\n          item\n        ]\n      }\n    }));\n  };\n\n  onPutItem = item => {\n    this.setState(prevState => {\n      return {\n        toolbox: {\n          ...prevState.toolbox,\n          [prevState.currentBreakpoint]: [\n            ...(prevState.toolbox[prevState.currentBreakpoint] || []),\n            item\n          ]\n        },\n        layouts: {\n          ...prevState.layouts,\n          [prevState.currentBreakpoint]: prevState.layouts[\n            prevState.currentBreakpoint\n          ].filter(({ i }) => i !== item.i)\n        }\n      };\n    });\n  };\n\n  onLayoutChange = (layout, layouts) => {\n    saveToLS(\"layouts\", layouts);\n    \n    if (this.props.persist){\n        this.props.persist(layouts)\n    }\n    this.setState({ layouts });\n  };\n\n  onNewLayout = () => {\n    this.setState({\n      layouts: { lg: generateLayout() }\n    });\n  };\n\n  render() {\n    return (\n      <div>\n        \n        {/* <div>\n          Current Breakpoint: {this.state.currentBreakpoint} (\n          {this.props.cols[this.state.currentBreakpoint]} columns)\n        </div>\n        <div>\n          Compaction type:{\" \"}\n          {_.capitalize(this.state.compactType) || \"No Compaction\"}\n        </div>\n        <button onClick={this.onNewLayout}>Generate New Layout</button>\n        <button onClick={this.onCompactTypeChange}>\n          Change Compaction Type\n        </button>\n\n        <ToolBox\n          items={this.state.toolbox[this.state.currentBreakpoint] || []}\n          onTakeItem={this.onTakeItem}\n        /> */}\n\n        <ResponsiveReactGridLayout\n\n          {...this.props}\n          isDraggable={this.editingLayout}\n          layouts={this.state.layouts}\n          onBreakpointChange={this.onBreakpointChange}\n          onLayoutChange={this.onLayoutChange}\n          // WidthProvider option\n          measureBeforeMount={false}\n          // I like to have it animate on mount. If you don't, delete `useCSSTransforms` (it's default `true`)\n          // and set `measureBeforeMount={true}`.\n          useCSSTransforms={this.state.mounted}\n          compactType={this.state.compactType}\n          preventCollision={!this.state.compactType}\n        >\n          {this.generateDOM()}\n        </ResponsiveReactGridLayout>\n      </div>\n    );\n  }\n}\n\nfunction getFromLS(key) {\n    let ls = {};\n    if (global.localStorage) {\n      try {\n        ls = JSON.parse(global.localStorage.getItem(\"rgl-8\")) || {};\n      } catch (e) {\n        /*Ignore*/\n      }\n    }\n    return ls[key];\n  }\n  \n  function saveToLS(key, value) {\n    if (global.localStorage) {\n      global.localStorage.setItem(\n        \"rgl-8\",\n        JSON.stringify({\n          [key]: value\n        })\n      );\n    }\n  }\nfunction generateLayout() {\n    return _.map(_.range(0, 25), function(item, i) {\n      var y = Math.ceil(Math.random() * 4) + 1;\n      return {\n        x: (_.random(0, 5) * 2) % 12,\n        y: Math.floor(i / 6) * y,\n        w: 2,\n        h: y,\n        i: i.toString(),\n        static: Math.random() < 0.05\n      };\n    });\n  }\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABidJREFUeNrtnc1vHdUZh5/3nBlf29dJbOLgOOAoSkwwIBKgsVIRGqkSq1AhqNIVC6Ru2j+gfwe7dsMCWIBUsajKh6qibKCtKqSGCgioNB+kSTCRUUzs4I/Y95yXxb1JiO+YAGfiI5f38ca+I78+M898nDm/OWNRVcXIhsvdgB87JiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzxeoPFJia+oJLM7MgklRcVRlo9rFr5yjebyzXMUZmPpvh6uLV9GIKzcEmgyODXYu6BcTI8y+9xst//CtF4ZP+bgiRgwfu5/fP/Y7Nm5rrtvHqYHlxmTf+8CZnPziLS9x5YghMPjHJkd8eQdzNO3W3AIWFhSVmvpyrRcDclQU2YuamqizNLzE/O1+DgMjy4nLlsmKtXxIRJPEUJJJ8FsuIAFLPdmDtDbGxTsz/h5iAzJiAzJiAzJiAzJiAzBTpJb47c3PLzC+0SO2ZKtDocQwONnBuw/ZzgXUWMPX5AufPf4VLPO5UYWiwwf79PSbg+9B+DFVRTR9j2oA315XYNSAzJiAzJiAzJiAzJiAzJmA9+JZOX2U3VIGomtTdEyBG5ZszoIR2H76ejOB2d0QVrm2DxERJY7tWu823SMScE57+xWHuHd+ZfJOjqoyObKWvtweAkZF+ms0yWYAqNHr9bb0JKxslP/vVIfb9/MHkQEajsn3P9so9Tyon6YUIMdazJiLQiTZbUdtHRQ1lnUDZiQqXWy2iai1DHIVzFP5ae6GmrYATKCoaWBHKK+dePcb0O/9GUscMYmTT3p2M/+aXuN4Gbxw/zz8/mU7ec6Mqu0c28ezhcZDAi387xpnpi7jEPTWo8ug99/HUIz9laUV4/u0VTl7U5KGTEJXD93qOThasXvXua4Aqsx+dYerNf+ASQ/kYIsMzc+z+9ZNIbw//+WyWYx9OUSSG3K0YOTA/zDOP7QECx8+e4l+fnqRwnh96fEmn7h3NAfSRg6xE4d0zkXdPR1KfqGkF2DrgODrZvaxbgIA4hys8kijAiSDeX7/uOCd47/DJ525301HknaNwHp+4qyqCc45OjI53UDiSBQB4oeoavHY3tL4+hq76fgMNo61DU+0+IDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDNrCqgv7JNV32+gZznXoakVgUx7qmpsheTDI4aIhnB9WDdGJYSIJFZuxUiMN8aKQ4y0Yug0/4cHMiFGYoydKkKI7VgydVS6FSBUZAFQGcgIWx7YzY4nDtUWSbqyQBAm7trC4w/uqC2SLJyAeH6ya5yh/oFaIsmJHWMIQung4G7HHf1SSyT5wF3VbasO5VutdjBfB06gLK83JNQ0aVhEKDsiW6EdytdxyvDi8K6dBK4EiDWUVW6ka6upfFXBicvKp7OB1OQwKgz3OSa3K4UIJ/97kfMXZtIf81AYGurnof1jIMJ7py8zc+VqDXWVndua3Dc2SIgtPj73AZfnv+wElGl1d2y9m/HRvV1trJwp//aFJV4/vYhPWSFpH0T7tpXs29aD98pf3jrBn/78XvJ7I0JQHn5ojImJUfCeF46d4vipS8lZc4iRo4d2MTG2hasrS7z691c4cfZ9nEt8Y0AMHDnwJHtG7+mSWflknFz7SjwCRG7u90RVQlRE0k5D8dpFWG/UjaokliVEbnoKrl03QuKEkqixfYqsoHJX3ECxeb1Idx/qdm8LuxFbhdzi57oxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAatY79HQNV/YpJ1gOmlldNVK3K4pYnXV1Ft+kFC4ulalgF4vbG649sy+BKJCf3kjAypLR29vgffp76TuKQtE2qvVUzoapU9OxAovncnf7Rip9D00ygZeUhOxgsKXlcsqQ/kvFiKzy/WE8n2FMNr0CPC/c5eYnp6r5VUFmzb3snd8BET45MIsc4sryWP3UWH7UB+7RgaIMXDm4im+WryCiCS9M0NVGd5yJ3cPj3VFkmL/TzgvdhHOjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIzNezxiKEIKwxBgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wOS0xMFQwNTo0MDowNiswMDowMFT52voAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDktMTBUMDU6NDA6MDYrMDA6MDAlpGJGAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTQtMDUtMTIgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn3IbtAAAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQAMTkyDwByhQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAxOTLTrCEIAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE1MzY1NTgwMDZiJ+JmAAAAD3RFWHRUaHVtYjo6U2l6ZQAwQkKUoj7sAAAAVnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vbW50bG9nL2Zhdmljb25zLzIwMTgtMDktMTAvZWI1MTNmMmE5ZWRkMzA1ZjhkZWEyODgzYTllYTNhNzguaWNvLnBuZ3XQqTUAAAAASUVORK5CYII=\"","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Tags = props => {\n  if (props && props.references) {\n    return (<div className=\"tags\" style={{ display: \"flex\",flexWrap:\"wrap\" }}>\n      {props.references.map((group,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", backgroundColor: group.color, color: group.textColor }}>\n          {group.title}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nTags.propTypes = {\n  references: PropTypes.array\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Highlight = props => {\n  \nif (!props.text) return null\nif (!props.filter) return  props.text\n\n    var ix = props.text.toLowerCase().indexOf(props.filter.toLowerCase())\n   if (ix===-1){\n     return props.text\n   }\n\n   \n   var first = props.text.substr(0,ix)\n   var middle = props.text.substr(ix,props.filter.length)\n   var last = props.text.substr(ix+props.filter.length)\n  return (\n    <>\n   \n      <span>{first}</span>\n      <span style={props.style}>{middle}</span>\n       <span>{last}</span>\n    \n    </>\n  );\n};\nHighlight.propTypes = {\n  style: PropTypes.object,\n\n  filter: PropTypes.string,\n  text: PropTypes.string\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nimport { Highlight } from \"./Highlight\";\nimport  \"./tile.css\"\nexport const AppSuperTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n\n  return (<>\n\n  {props.tileSize===1 &&\n    <div className=\"supertile\" style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n     <div  style={{\n       \n       margin: 10,\n       padding: 10,\n       backgroundColor: tile.color,\n       color: tile.textcolor,\n       width: 300,\n       height: 70,\n       maxHeight: 70,\n       borderRadius:35,\n       overflow: \"hide\"\n       \n     }}>\n       <div style={{ cursor: \"pointer\" }} onClick={() => {\n         if (props.onClick){\n           props.onClick(tile);\n                }\n   \n       }}>\n         <div style={{display:\"flex\"}}>\n           \n         <div style={{  margin: 8, marginTop:8, height: 40 }}>\n           <img style={{ height: \"auto\", width: 40 }} src={tile.icon} />\n         </div>\n           <div title={tile.title} style={{flexGrow:1,height:\"40px\",width:\"300px\", overflow:\"hidden\",lineHeight:\"40px\",marginTop:\"6px\",marginLeft:\"4px\", fontSize:\"24px\"}}>\n           <Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> \n           </div>\n          \n         <div style={{alignItems:\"flex-end\"}}>\n         <i\n                   style={{cursor:\"pointer\",display:\"none\"}}\n                     class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                     onClick={(e) => {\n                       if (props.onPinnedClicked){\n                         e.preventDefault()\n                         e.stopPropagation()\n                         props.onPinnedClicked(props)\n                       }\n                       \n                     }}\n                     aria-hidden=\"true\"\n                   ></i> \n         </div> </div>\n       \n         {/* <Tags references={tile.references} /> */}\n   \n       </div>\n     </div>\n     \n\n     </div>\n  }\n  {props.tileSize === 0 &&\n  <div style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n  <div style={{\n    margin: 10,\n    padding: 10,\n    backgroundColor: tile.color,\n    color: tile.textcolor,\n    width: 300,\n    height: 300,\n    maxHeight: 300,\n    overflow: \"auto\"\n  }}>\n    <div style={{ cursor: \"pointer\" }} onClick={() => {\n      if (props.onClick){\n        props.onClick(tile);\n             }\n\n    }}>\n      <div style={{display:\"flex\"}}><div style={{flexGrow:1}}><Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> </div>\n      <div style={{alignItems:\"flex-end\"}}>\n      <i\n                style={{cursor:\"pointer\",display:\"none\"}}\n                  class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                  onClick={(e) => {\n                    if (props.onPinnedClicked){\n                      e.preventDefault()\n                      e.stopPropagation()\n                      props.onPinnedClicked(props)\n                    }\n                    \n                  }}\n                  aria-hidden=\"true\"\n                ></i> \n      </div>\n      </div>\n      \n      <div style={{ textAlign: \"center\", margin: 20, marginTop:40, height: 120 }}>\n        <img style={{ height: \"auto\", width: 112 }} src={tile.icon} />\n      </div>\n\n      <div style={{ maxHeight: 60, height: 60, overflow: \"auto\" }}>\n    \n\n        {tile.inShort}\n      </div>\n       <Tags references={tile.references} /> \n\n    </div>\n  </div>\n  \n  <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} rel=\"noopener noreferrer\"  target=\"_blank\">\n          Jump to\n            </a>)} */}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} rel=\"noopener noreferrer\"  target=\"_blank\">\n           More info\n            </a>)}\n      </div>\n  </div>\n  }\n  </>);\n};\nAppSuperTile.propTypes = {\n  tile: PropTypes.object,\n  onClose: PropTypes.func,\n  filter : PropTypes.string,\n  highlightStyle : PropTypes.object,\n  isPinned : PropTypes.bool,\n  onPinnedClicked:PropTypes.func,\n  tileSize:PropTypes.number\n};\n","import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { QuillDeltaToHtmlConverter } from \"quill-delta-to-html\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nexport const AppFullSizeTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    if (tile.contentRef) {\n      axios\n        .get(tile.contentRef)\n        .then(result => {\n          var converter = new QuillDeltaToHtmlConverter(result.data.ops);\n          setHtml(converter.convert());\n        })\n        .catch(error => {\n          if (error.response.status !== 404) {\n            setError(error.message);\n          }\n        });\n    }\n  });\n  return (<>\n    {error && <div>{error}</div>}\n    <div onClick={props.onClose} style={{\n      backgroundColor: tile.color,\n      color: tile.textcolor,\n      height: \"80px\",\n      borderRadius:\"40px\",\n      \n      overflow: \"auto\"\n    }}>\n      <div>\n        <div style={{ display: \"flex\" }}>\n          <div >\n            {\" \"}\n            <img style={{ margin: \"10px\", marginLeft:\"20px\", height: \"60px\", width: \"auto\" }} src={tile.icon} />\n          </div>\n          <div style={{ \n          width: \"auto\" }}>\n            <div className=\"fullSizeHeading\" style={{\n              padding: \"10px\",\n              marginTop:\"20px\",\n              fontSize: \"48px\",\n              textOverflow: \"nowrap\",\n              whiteSpace: \"no-wrap\"\n            }}>\n              {tile.title}\n            </div>\n            <div className=\"fullSizeDescription\" style={{ paddingLeft: \"3vh\", fontSize: \"3vh\" }}>\n          \n              {tile.inShort}\n            </div>\n          </div>\n        </div>\n\n\n        {/* <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n          {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} target=\"_blank\">\n           Launch\n              </a>)}\n          {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} target=\"_blank\">\n            Details\n              </a>)}\n        </div> */}\n      </div>\n\n    </div>\n    <div style={{\n          margin : \"20px\",\n          xheight: \"80vh\",\n         \n          overflow: \"auto\",\n          backgroundColor: \"#ffffff\",\n          color: \"#000000\",\n          padding: \"20px\"\n        }}>\n          <div style={{fontSize:\"22px\",lineHeight:\"24px\"}}>\n            {tile.messageBeforeLaunch}\n<div style={{marginTop:\"20px\"}}>\n            {/* <textarea style={{width:\"100%\",height:\"30px\"}}>{tile.jumpto}</textarea> */}\n            <div>\n\n<a href={tile.jumpto}>{tile.jumpto}</a>\n\n            </div>\n            </div>\n            </div>\n            <div>\n\n    \n            </div>\n          <Tags references={tile.references} />\n          <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} target=\"_blank\">\n        Launch\n            </a>)} */}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} target=\"_blank\">\n          Details\n            </a>)}\n      </div>\n          <div dangerouslySetInnerHTML={{ __html: html }}></div>\n        </div>\n  </>);\n};\nAppFullSizeTile.propTypes = {\n  tile: Object,\n  onClick: PropTypes.func\n};\n","import json from \"format-json\";\nimport _ from \"lodash\";\nimport request from \"request\";\nimport axios from \"axios\";\nimport { addElementAtIndex } from \"@fluentui/react\";\nexport var graph = {};\n\nfunction extractEmails(text) {\n  return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\n}\n\ngraph.analyseMembers = (token, emailAddresses, cb) => {\n  var addresses = [];\n\n  var ar1 = emailAddresses.split(\"\\n\");\n  ar1.forEach((element1) => {\n    var ar2 = element1.split(\";\");\n    ar2.forEach((element2) => {\n      var smptAddresses = extractEmails(element2);\n      smptAddresses.forEach((smtp) => {\n        addresses.push({\n          checked: false,\n          smtp,\n        });\n      });\n    });\n  });\n\n  var results = [];\n  var x = addresses.length;\n  addresses.forEach((address) => {\n    graph.readUser(token, address.smtp, 0, (err, user) => {\n      x--;\n      address.user = user;\n      address.err = err;\n      results.push(address);\n      if (x < 1) {\n        cb(null, results);\n        address.checked = true;\n      }\n    });\n  });\n};\ngraph.invite = (token, emailAddress, invitationRedirectUrl, cb) => {\n  var msg = {\n    invitedUserEmailAddress: emailAddress,\n    inviteRedirectUrl: invitationRedirectUrl,\n    invitedUserDisplayName: emailAddress,\n    sendInvitationMessage: false,\n    invitedUserMessageInfo: {\n      customizedMessageBody:\n        \"We are really happy to invite you to the JUMPTO365 #Insider program \",\n      ccRecipients: [\n        {\n          emailAddress: {\n            name: \"Niels\",\n            address: \"niels@jumpto365.com\",\n          },\n        },\n      ],\n    },\n  };\n  post(token, `https://graph.microsoft.com/v1.0/invitations`, msg, function (\n    err,\n    response\n  ) {\n    if (err) {\n      return cb(err);\n    }\n    cb(null, response);\n  });\n};\ngraph.addcrm = (token, emailAddress, first, last, tag, cb) => {\n  var msg = {\n    properties: [\n      {\n        property: \"firstname\",\n        value: first,\n      },\n      {\n        property: \"lastname\",\n        value: last,\n      },\n      {\n        property: \"internal_categories\",\n        value: tag,\n      },\n      // {\n      //   \"property\": \"phone\",\n      //   \"value\": \"@{body('Signin')['mobilePhone']}\"\n      // },\n      // {\n      //   \"property\": \"jobtitle\",\n      //   \"value\": \"@{body('Signin')['jobTitle']}\"\n      // },\n      // {\n      //   \"property\": \"country\",\n      //   \"value\": \"@{body('Signin')['country']}\"\n      // }\n    ],\n  };\n\n  post2(\n    token,\n    `https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/${emailAddress}/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null, response);\n    }\n  );\n};\ngraph.addmember = (token, userId, groupId, cb) => {\n  var msg = {\n    \"@odata.id\": `https://graph.microsoft.com/beta/directoryObjects/${userId}`,\n  };\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/members/$ref`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null);\n    }\n  );\n};\n\ngraph.getSharePointList = (\n  token,\n  host,\n  site,\n  list,\n  listfilter,\n  itemfilter,\n  cb\n) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items?${listfilter}`,\n    function (e, items) {\n      if (e) return cb(e);\n      var itemList = [];\n\n      function next() {\n        if (items.length === 0) return cb(null, itemList);\n        var item = items.pop();\n\n        get(\n          token,\n          `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items/${item.id}?${itemfilter}`,\n          function (e, item) {\n            if (e) return cb(e);\n            itemList.push(item);\n            next();\n          }\n        );\n      }\n\n      next();\n    }\n  );\n};\n\ngraph.getPages = (token, host, site, cb) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}`,\n    function (e, site) {\n      if (e) return cb(e);\n\n      get(\n        token,\n        `https://graph.microsoft.com/beta/sites/${site.id}/pages`,\n        function (e, items) {\n          if (e) return cb(e);\n\n          return cb(null, items);\n        }\n      );\n    }\n  );\n};\ngraph.readGroupMembers = function (token, groupId, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/beta/groups/\" +\n      groupId +\n      \"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id\",\n    cb\n  );\n};\n\ngraph.readGroupMemberShipFor = function (token, upn, cb) {\n  get(token, \"https://graph.microsoft.com/v1.0/users/\" + upn + \"/memberOf\", cb);\n};\n\ngraph.readManager = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName + \"/manager\",\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.matchingGroups = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'${searchText}')`,\n    cb\n  );\n};\n\ngraph.findGroup = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '${searchText}'`,\n    cb\n  );\n};\n\ngraph.getGroupDocuments = function (token, groupId, folderName, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root:${folderName}:/children`,\n    cb\n  );\n};\n\ngraph.getGroupDrive = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive`, cb);\n};\ngraph.getGroupSite = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/sites/root`,\n    cb\n  );\n};\n\ngraph.getDriveChildren = function (token, driveId, itemId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/drives/${driveId}/items/${itemId}/children`,\n    cb\n  );\n};\n\ngraph.getGroupRootFolders = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteDrive = function (token, id, path, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${id}/drive/root:/${path}:/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.copyfile = function (\n  token,\n  groupNickName,\n  fromFolder,\n  fromName,\n  toFolder,\n  toName,\n  cb\n) {\n  graph.findGroup(token, groupNickName, function (err, groups) {\n    if (err) return cb(err);\n    if (groups.length !== 1) return cb(\"Did't find a unique group\");\n    var group = groups[0];\n    graph.getGroupDocuments(token, group.id, \"/\" + fromFolder, function (\n      err,\n      fromItems\n    ) {\n      if (err) return cb(err);\n      var match = _.find(fromItems, { name: fromName });\n      graph.getGroupRootFolders(token, group.id, function (err, targetFolders) {\n        if (err) return cb(err);\n        var destFolder = _.find(targetFolders, { name: toFolder });\n        if (!destFolder) return cb(\"Did't find target folder\");\n        graph.newDoc(\n          token,\n          group.id,\n          match.id,\n          destFolder.parentReference.driveId,\n          destFolder.id,\n          toName,\n          function (err, result) {\n            if (err) return cb(err);\n            return cb(null, result);\n          }\n        );\n      });\n    });\n  });\n};\n\nfunction lookupFile(token, driveId, id, name, iterations, cb) {\n  // Content have been copied\n  graph.getDriveChildren(token, driveId, id, function (err, result) {\n    if (err) {\n      return cb(err);\n    }\n    // content of destination folder\n\n    for (let index = 0; index < result.length; index++) {\n      const file = result[index];\n\n      console.log(\"Comparing\", file.name, name);\n      if (file.name === name) {\n        // match found\n        console.log(\"Match found\");\n        return cb(null, file);\n      }\n    }\n\n    var iteration = 0;\n    function retry() {\n      console.log(\"Retrying\", iterations);\n      //\n      if (iteration > 10) {\n        return cb(\n          `Think that the file has been created, but could not find a reference to if. Filename is ${name} - Tryed ${iterations} to find it `\n        );\n      }\n      lookupFile(token, driveId, id, name, iterations + 1, cb);\n    }\n    // no match found so we will wait a second a try again\n    setTimeout(retry, 1000);\n  });\n}\n\ngraph.newDoc = function (token, sourceGroupId, itemId, driveId, id, name, cb) {\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${sourceGroupId}/drive/items/${itemId}/copy`,\n    {\n      parentReference: {\n        driveId: driveId,\n        id: id,\n      },\n      name: name,\n    },\n    function (err) {\n      // no result from that call - by design from Microsoft\n      if (err) {\n        return cb(err);\n      }\n\n      // so we fill try to find a referece our self\n      lookupFile(token, driveId, id, name, 0, cb);\n    }\n  );\n};\nexport const graphWithPromise = {};\ngraphWithPromise.me = (token) => {\n  return new Promise((resolve, reject) => {\n    get(\n      token,\n      \"https://graph.microsoft.com/v1.0/me/\",\n      (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      },\n      null\n    );\n  });\n};\n\nclass Client {\n  constructor() {\n    this.token = auth.getAccessToken();\n  }\n  get = (url) => {\n    return new Promise((resolve, reject) => {\n      get(this.token, url, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n\n  post = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      post(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n\n  patch = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      patch(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  put = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      put(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  getRaw = (url) => {\n    return getRaw(this.token, url);\n  };\n  getImage = (url) => {\n    return getImage(this.token, url);\n  };\n}\n\nfunction imageToBase64(blob) {\n  return new Promise((resolve, reject) => {\n    try {\n      var reader = new FileReader();\n\n      reader.onload = function () {\n        var blobAsDataUrl = reader.result;\n\n        resolve(blobAsDataUrl);\n      };\n\n      reader.readAsDataURL(new Blob([blob]));\n    } catch (error) {\n      debugger;\n      resolve(null);\n    }\n  });\n}\nconst get2 = (url) => {\n  var client = new Client();\n  return client.get(url);\n};\n\nconst patch2 = (url, payload) => {\n  var client = new Client();\n  return client.patch(url, payload);\n};\nconst post2 = (url, payload) => {\n  var client = new Client();\n  return client.post(url, payload);\n};\nconst put2 = (url, payload) => {\n  var client = new Client();\n  return client.put(url, payload);\n};\n/**\n *\n */\nexport const me = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me\");\n};\nexport const myGroups = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me/memberOf\");\n};\nexport const readTeam = (id) => {\n  return get2(\"https://graph.microsoft.com/v1.0/groups/\" + id);\n};\nexport const getMyExtention = (extensionName) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`\n  );\n};\n\nexport const getOneDriveFolder = (folderNameWithOutInitialSlash) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}`\n  );\n};\n\nexport const getOneDriveFile = (folderNameWithOutInitialSlash, filename) => {\n  return new Promise(async (resolve, reject) => {\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\n      (e) => {\n        reject(e);\n      }\n    );\n    if (!folder) return;\n\n    get2(\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}`\n    )\n      .then((file) => {\n        axios\n          .get(file[\"@microsoft.graph.downloadUrl\"])\n          .then((response) => {\n            resolve(response.data);\n          })\n          .catch((e) => {\n            reject(e);\n          });\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n};\n\nexport const saveOneDriveFile = (\n  folderNameWithOutInitialSlash,\n  filename,\n  payload\n) => {\n  return new Promise(async (resolve, reject) => {\n    console.log(\"Size of payload\", payload.length);\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\n      (e) => {\n        reject(e);\n      }\n    );\n    if (!folder) return;\n\n    put2(\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}:/content`,\n      payload\n    )\n      .then((result) => {\n        resolve(result);\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n};\n\nexport const createOneDriveFolder = (folderNameWithOutInitialSlash) => {\n  const driveItem = {\n    name: folderNameWithOutInitialSlash,\n    folder: {},\n    \"@microsoft.graph.conflictBehavior\": \"rename\",\n  };\n\n  return post2(\n    `https://graph.microsoft.com/v1.0/me/drive/root/children`,\n    driveItem\n  );\n};\n\nexport const createOneDriveFolderChild = (\n  parentFolderNameWithOutInitialSlash,\n  folderNameWithOutInitialSlash\n) => {\n  const driveItem = {\n    name: folderNameWithOutInitialSlash,\n    folder: {},\n    \"@microsoft.graph.conflictBehavior\": \"rename\",\n  };\n\n  return post2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${parentFolderNameWithOutInitialSlash}:/children`,\n    driveItem\n  );\n};\n\nexport const saveMyExtention = (extensionName, data) => {\n  return new Promise(async (resolve, reject) => {\n    var existing = await getMyExtention(extensionName).catch((e) => {});\n    if (!existing) {\n      addMyExtention(extensionName, data)\n        .then((r) => {\n          resolve(r);\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    } else {\n      updateMyExtention(extensionName, data)\n        .then((r) => {\n          resolve(r);\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    }\n  });\n};\nexport const updateMyExtention = (extensionName, data) => {\n  var payload = {\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n    extensionName: extensionName,\n    ...data,\n  };\n  return patch2(\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`,\n    payload\n  );\n};\nexport const addMyExtention = (extensionName, data) => {\n  var payload = {\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n    extensionName: extensionName,\n    ...data,\n  };\n  return post2(`https://graph.microsoft.com/v1.0/me/extensions`, payload);\n};\n\nexport const teamMemberships = (reportProgessPercent) => {\n  var client = new Client();\n  return new Promise(async (resolve, reject) => {\n    try {\n      var memberships = await client\n        .get(\"https://graph.microsoft.com/v1.0/me/memberOf\")\n        .catch((error) => reject(error));\n      var pending = 0;\n      var groups = [];\n\n      if (!memberships) return reject(\"Not able to read membership\");\n\n      //memberships = [memberships[0]];\n      var total = memberships.length;\n      var processed = 0;\n      if (reportProgessPercent) reportProgessPercent(0);\n      memberships.map(async (value) => {\n        pending++;\n\n        var group = await readGroup(value, client);\n\n        processed++;\n        if (reportProgessPercent) reportProgessPercent(processed / total);\n        groups.push(group);\n\n        pending--;\n        if (pending === 0) {\n          return resolve(\n            groups.sort((a, b) => {\n              if (a.text < b.text) {\n                return -1;\n              }\n              if (a.text > b.text) {\n                return 1;\n              }\n              return 0;\n            })\n          );\n        }\n      });\n    } catch (error) {\n      debugger;\n      reject(error);\n    }\n  }, null);\n};\n\nexport var auth = {};\n\nauth.getAccessToken = function () {\n  return sessionStorage.getItem(\"access_token\");\n};\n\nfunction readGroup(value, client) {\n  return new Promise(async (resolve, reject) => {\n    var group = {\n      ...value,\n      key: value.id,\n      text: value.title ? value.title : value.displayName,\n      title: value.description,\n    };\n    var photo = await client\n      .getImage(\n        `https://graph.microsoft.com/v1.0/groups/${value.id}/photo/$value`\n      )\n      .catch((error) => {\n        debugger;\n        console.log(\"Photo read error\");\n      });\n    if (photo && photo.indexOf(\"data:application/json\") > -1) photo = null;\n\n    var details = await client\n      .get(`https://graph.microsoft.com/v1.0/teams/${value.id}`)\n      .catch((error) => console.log(\"Team details read error\"));\n    (value.creationOptions ? value.creationOptions : []).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    (value.resourceProvisioningOptions\n      ? value.resourceProvisioningOptions\n      : []\n    ).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    \n    // https://www.techmikael.com/2017/11/retrieving-teams-and-yammer-endpoints.html\n    var channels = await readChannels(client, value).catch((e) => {});\n    var endPoints = await readEndpoints(client, value).catch((e) => {});\n    group.hasTeams = channels !== undefined;\n    group.data = {\n      endPoints,\n      details,\n      photo,\n      channels: channels,\n    };\n    resolve(group);\n  });\n}\n\nasync function readChannels(client, value) {\n  var queue = 0;\n  return new Promise(async (resolve, reject) => {\n    var channels = await client\n      .get(`https://graph.microsoft.com/beta/teams/${value.id}/channels`)\n      .catch((error) => {\n        console.log(\"Channel read error\");\n      });\n    if (!channels) return resolve();\n\n    channels.forEach(async (channel) => {\n      queue++;\n      var tabs = await client\n        .get(\n          `https://graph.microsoft.com/beta/teams/${value.id}/channels/${channel.id}/tabs`\n        )\n        .catch((error) => {\n          console.log(\"Channel read tabs\", error);\n        });\n\n      channel.tabs = tabs;\n      queue--;\n      if (queue === 0) {\n        resolve(channels);\n      }\n    });\n  });\n}\n\nasync function readEndpoints(client, value) {\n  return client.get(\n    `https://graph.microsoft.com/beta/groups/${value.id}/endpoints`\n  );\n}\n\nfunction post(token, url, body, cb) {\n  axios\n    .post(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\n\nfunction patch(token, url, body, cb) {\n  axios\n    .patch(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\n\nfunction put(token, url, body, cb) {\n  axios\n    .put(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\nexport function getRaw(token, url) {\n  console.log(\"getting\", url);\n\n  return new Promise((resolve, reject) => {\n    request.get(\n      {\n        url: url,\n        headers: {\n          authorization: \"Bearer \" + token,\n        },\n      },\n      function (err, response, body) {\n        if (err) {\n          return reject(err);\n        }\n        resolve({ body, response });\n      }\n    );\n  });\n}\n\nfunction getImage(token, url) {\n  return new Promise((resolve, reject) => {\n    try {\n      var xhr = new XMLHttpRequest();\n\n      xhr.onload = function () {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(xhr.response);\n      };\n\n      xhr.open(\"GET\", url);\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\n      xhr.responseType = \"blob\";\n      xhr.send();\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nexport function get(token, url, cb, appendTo, index, retrycount) {\n  console.log(\"getting\", url, appendTo === true);\n  request.get(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    },\n    function (err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        var errCounter = retrycount ? retrycount + 1 : 1;\n        if (errCounter > 3) {\n          return cb(err, null, index);\n        } else {\n          // retry\n          console.log(\"retry #\", errCounter);\n          return get(token, url, cb, appendTo, index, errCounter);\n        }\n      }\n\n      parsedBody = JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(parsedBody.error, null, index);\n      }\n\n      if (parsedBody[\"@odata.nextLink\"]) {\n        var data;\n        if (!appendTo) {\n          data = parsedBody.value;\n        } else {\n          data = appendTo.concat(parsedBody.value);\n        }\n\n        return get(token, parsedBody[\"@odata.nextLink\"], cb, data, index);\n      }\n\n      if (appendTo) {\n        cb(null, appendTo.concat(parsedBody.value), index);\n      } else {\n        if (parsedBody.value) {\n          cb(null, parsedBody.value, index);\n        } else {\n          cb(null, parsedBody, index);\n        }\n      }\n    }\n  );\n}\n","import React,{useState} from \"react\";\nimport PropTypes from \"prop-types\";\nimport  \"./groupover.css\"\nimport {\n  getTheme,\n  mergeStyleSets,\n  FontWeights,\n  ContextualMenu,\n  Toggle,\n  DefaultButton,\n  Modal,\n  IDragOptions,\n  IconButton,\n  IIconProps,\n} from 'office-ui-fabric-react';\nconst dragOptions = {\n  moveMenuItemText: 'Move',\n  closeMenuItemText: 'Close',\n  menu: ContextualMenu,\n};\nconst cancelIcon = { iconName: 'Cancel' };\nconst theme = getTheme();\nconst contentStyles = mergeStyleSets({\n  container: {\n    display: 'flex',\n    flexFlow: 'column nowrap',\n    alignItems: 'stretch',\n  },\n  header: [\n    // tslint:disable-next-line:deprecation\n    theme.fonts.xLargePlus,\n    {\n      flex: '1 1 auto',\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\n      color: theme.palette.neutralPrimary,\n      display: 'flex',\n      alignItems: 'center',\n      fontWeight: FontWeights.semibold,\n      padding: '12px 12px 14px 24px',\n    },\n  ],\n  body: {\n    flex: '4 4 auto',\n    padding: '0 24px 24px 24px',\n    overflowY: 'hidden',\n    selectors: {\n      p: { margin: '14px 0' },\n      'p:first-child': { marginTop: 0 },\n      'p:last-child': { marginBottom: 0 },\n    },\n  },\n});\nconst toggleStyles = { root: { marginBottom: '20px' } };\nconst iconButtonStyles = {\n  root: {\n    color: theme.palette.neutralPrimary,\n    marginLeft: 'auto',\n    marginTop: '4px',\n    marginRight: '2px',\n  },\n  rootHovered: {\n    color: theme.palette.neutralDark,\n  },\n};\nexport  const GroupMouseOver = props => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\nreturn <div className=\"groupOver\">\n  <div className=\"groupOverLink\" onClick={(e)=>{\n    setIsModalOpen(true)\n   e.preventDefault();\n \n}\n}>\n  \n  \n  Open </div>\n  <Modal\n        titleAriaId={1}\n        isOpen={isModalOpen}\n        onDismiss={()=>setIsModalOpen(false)}\n        isBlocking={false}\n        containerClassName={contentStyles.container}\n        dragOptions={dragOptions}\n      >\n        <div >\n          <span >Lorem Ipsum</span>\n          <IconButton\n            styles={iconButtonStyles}\n            iconProps={cancelIcon}\n            ariaLabel=\"Close popup modal\"\n            onClick={()=>setIsModalOpen(false)}\n          />\n        </div>\n        <div className={contentStyles.body}>\n          <p>\n            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas lorem nulla, malesuada ut sagittis sit\n            amet, vulputate in leo. Maecenas vulputate congue sapien eu tincidunt. Etiam eu sem turpis. Fusce tempor\n            sagittis nunc, ut interdum ipsum vestibulum non. Proin dolor elit, aliquam eget tincidunt non, vestibulum ut\n            turpis. In hac habitasse platea dictumst. In a odio eget enim porttitor maximus. Aliquam nulla nibh,\n            ullamcorper aliquam placerat eu, viverra et dui. Phasellus ex lectus, maximus in mollis ac, luctus vel eros.\n            Vivamus ultrices, turpis sed malesuada gravida, eros ipsum venenatis elit, et volutpat eros dui et ante.\n            Quisque ultricies mi nec leo ultricies mollis. Vivamus egestas volutpat lacinia. Quisque pharetra eleifend\n            efficitur.\n          </p>\n          <p>\n            Mauris at nunc eget lectus lobortis facilisis et eget magna. Vestibulum venenatis augue sapien, rhoncus\n            faucibus magna semper eget. Proin rutrum libero sagittis sapien aliquet auctor. Suspendisse tristique a\n            magna at facilisis. Duis rhoncus feugiat magna in rutrum. Suspendisse semper, dolor et vestibulum lacinia,\n            nunc felis malesuada ex, nec hendrerit justo ex et massa. Quisque quis mollis nulla. Nam commodo est ornare,\n            rhoncus odio eu, pharetra tellus. Nunc sed velit mi.\n          </p>\n          <p>\n            Sed condimentum ultricies turpis convallis pharetra. Sed sagittis quam pharetra luctus porttitor. Cras vel\n            consequat lectus. Sed nec fringilla urna, a aliquet libero. Aenean sed nisl purus. Vivamus vulputate felis\n            et odio efficitur suscipit. Ut volutpat dictum lectus, ac rutrum massa accumsan at. Sed pharetra auctor\n            finibus. In augue libero, commodo vitae nisi non, sagittis convallis ante. Phasellus malesuada eleifend\n            mollis. Curabitur ultricies leo ac metus venenatis elementum.\n          </p>\n          <p>\n            Aenean egestas quam ut erat commodo blandit. Mauris ante nisl, pellentesque sed venenatis nec, aliquet sit\n            amet enim. Praesent vitae diam non diam aliquet tristique non ut arcu. Pellentesque et ultrices eros. Fusce\n            diam metus, mattis eu luctus nec, facilisis vel erat. Nam a lacus quis tellus gravida euismod. Nulla sed sem\n            eget tortor cursus interdum. Sed vehicula tristique ultricies. Aenean libero purus, mollis quis massa quis,\n            eleifend dictum massa. Fusce eu sapien sit amet odio lacinia placerat. Mauris varius risus sed aliquet\n            cursus. Aenean lectus magna, tincidunt sit amet sodales a, volutpat ac leo. Morbi nisl sapien, tincidunt sit\n            amet mauris quis, sollicitudin auctor est.\n          </p>\n          <p>\n            Nam id mi justo. Nam vehicula vulputate augue, ac pretium enim rutrum ultricies. Sed aliquet accumsan\n            varius. Quisque ac auctor ligula. Fusce fringilla, odio et dignissim iaculis, est lacus ultrices risus,\n            vitae condimentum enim urna eu nunc. In risus est, mattis non suscipit at, mattis ut ante. Maecenas\n            consectetur urna vel erat maximus, non molestie massa consequat. Duis a feugiat nibh. Sed a hendrerit diam,\n            a mattis est. In augue dolor, faucibus vel metus at, convallis rhoncus dui.\n          </p>\n        </div>\n      </Modal>\n  </div>\n  \n};\n","export const EVENT = {\n  LANDING: \"landing\",\n  ONBOARDING: \"onboarding\",\n  SEARCHING: \"user-searched-for\",\n  TILECLICKED: \"user-clicked-tile\",\n  TABCLICKED: \"user-clicked-tab\",\n  DETAILSTOGGLED: \"user-toggle-details\",\n  MEMBERSHIPSREAD:\"memberships-read\"\n};\nObject.freeze(EVENT);\n// var d = [\n//     \"init\",\n//     \"logEvent\",\n//     \"logRevenue\",\n//     \"setUserId\",\n//     \"setUserProperties\",\n//     \"setOptOut\",\n//     \"setVersionName\",\n//     \"setDomain\",\n//     \"setDeviceId\",\n//     \"enableTracking\",\n//     \"setGlobalUserProperties\",\n//     \"identify\",\n//     \"clearUserProperties\",\n//     \"setGroup\",\n//     \"logRevenueV2\",\n//     \"regenerateDeviceId\",\n//     \"groupIdentify\",\n//     \"onInit\",\n//     \"logEventWithTimestamp\",\n//     \"logEventWithGroups\",\n//     \"setSessionId\",\n//     \"resetSessionId\",\n//   ];\nexport function who(upn) {\n  if (!window.amplitude) return;\n  if (!upn) return;\n  var amp =  window.amplitude.getInstance()\n  if (!amp) return\n  \n  amp.setUserId(upn);\n\n  var s = upn.split(\"@\");\n  if (s.length === 2) {\n    amp.setDomain(s[1]);\n  }\n}\n\nexport function trace(event, details) {\n  if (!window.amplitude) return;\n  var amp =  window.amplitude.getInstance()\n  if (!amp) return\n  amp.logEvent(event, details);\n  console.log(\"trace\",event, details);\n}\n","import React, { Component, useState, useEffect } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Highlight } from \"./Highlight\";\nimport Masonry from \"react-masonry-css\";\nimport moment from \"moment\";\nimport \"./masonry.css\";\nimport { GroupMouseOver } from \"./GroupMouseOver\";\nimport _ from \"lodash\";\nimport { EVENT, trace } from \"../helpers/trace\";\nconst breakpointColumnsObj = {\n  default: 10,\n\n  3500: 9,\n\n  3100: 8,\n\n  2700: 7,\n  2300: 6,\n  1900: 5,\n  1500: 4,\n  1100: 3,\n  700: 2,\n  500: 1,\n};\n\nexport const ViewTeams = (props) => {\n  const [viewChannels, setViewChannels] = useState(props.details);\n  const [viewDates, setViewDates] = useState(false);\n\n  if (props && props.memberShips) {\n    var memberShips = _.cloneDeep(props.memberShips);\n    if (props.tiles) {\n      props.tiles.forEach((tile) => {\n        //debugger\n        memberShips.push({\n          displayName: tile.title,\n          tile,\n        });\n      });\n\n      memberShips = _.sortBy(memberShips, [\"title\"]);\n    }\n    return (\n      <div\n        className=\"tags\"\n        style={{\n          padding: \"4px\",\n          margin: \"4px\",\n          fontSize: \"16px\",\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          minWidth: \"300px\",\n        }}\n      >\n        <Masonry\n          breakpointCols={breakpointColumnsObj}\n          className=\"my-masonry-grid\"\n          columnClassName=\"my-masonry-grid_column\"\n        >\n          {/* array of JSX items */}\n\n          {memberShips.map((team, key) => {\n            //    if ((!team.resourceProvisioningOptions || !team.resourceProvisioningOptions.length > 0) && (team.creationOptions && !team.creationOptions.length > 0)) return null\n            //if ( team[\"@odata.type\"] === \"#microsoft.graph.directoryRole\") return null\n            // Profoæe: \"https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=profile\"\n\n            return (\n              <ViewTeam\n                key={key}\n                team={team}\n                viewChannels={props.details}\n                viewDates={viewDates}\n                {...props}\n              />\n            );\n          })}\n        </Masonry>\n      </div>\n    );\n  } else {\n    return null;\n  }\n};\nfunction teamsLink(href) {\n  if (href) {\n    var part1 = href.split(\"https://teams.microsoft.com/l/team/\");\n    var part2 = part1[1].split(\"/conversations?\");\n    var part3 = href.split(\"groupId=\");\n    var part4 = part3[1].split(\"&\");\n    var part5 = href.split(\"tenantId=\");\n    var threadId = part2[0];\n    var groupId = part4[0];\n    var tenantId = part5[1];\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    return conversationsHref;\n  } else {\n    return;\n  }\n}\nfunction teamsLink2(href) {\n  if (href) {\n    var part1 = href.split(\"https://teams.microsoft.com/l/channel/\");\n    var part2 = part1[1].split(\"/conversations?\");\n    var part3 = href.split(\"groupId=\");\n    var part4 = part3[1].split(\"&\");\n    var part5 = href.split(\"tenantId=\");\n    var threadId = part2[0];\n    var groupId = part4[0];\n    var tenantId = part5[1];\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    return conversationsHref;\n  } else {\n    return;\n  }\n}\nfunction ViewTeam(props) {\n  const viewChannels = props.viewChannels;\n  const [viewDates, setViewDates] = useState(props.viewDates);\n  const [mouseOver, setMouseOver] = useState(false);\n  const team = props.team;\n  function logo(show, icon) {\n    if (!show) return null;\n    var c = \"ms-fontSize-28 ms-Icon ms-Icon--\" + icon;\n    return <i className={c} style={{ padding: \"4px\" }} aria-hidden=\"true\"></i>;\n  }\n  var href = team.data && team.data.details ? team.data.details.webUrl : \"\";\n\n  // Notebook https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=notebook\"\n  // Planner \"https://tasks.office.com/365adm.onmicrosoft.com/en-US/Home/Group/786dc6d7-766f-46df-ac4b-d6883597061f\"\n\n  if (team.tile) {\n    return (\n      <div\n        style={{\n          paddingLeft: \"0px\",\n          margin: \"10px\",\n          fontSize: \"16px\",\n          xdisplay: \"flex\",\n          border: \"1px solid #dddddd\",\n          minWidth: \"290px\",\n          maxWidth: \"290px\",\n        }}\n      >\n        <span\n          onClick={() => {\n            trace(EVENT.TILECLICKED, {\n              \"tile-key\": team.tile.key,\n              href: team.tile.externalArticle,\n            });\n          }}\n        >\n          <a\n            className=\"TeamLink\"\n            href={team.tile.externalArticle}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            <div>\n              \n              <div\n                style={{\n                  minWidth: \"288px\",\n                  paddingLeft: \"0px\",\n                  paddingBottom: \"0px\",\n                }}\n              >\n                {team.tile.icon && (\n                  <div \n                  className=\"teamTitleBar\" \n                  style={{ backgroundColor: team.tile.color,marginTop:\"-20px\" }}>\n                    <img\n                    \n                      src={team.tile.icon}\n                      style={{\n                        margin: \"70px\",\n                        height: \"140px\",\n                        width: \"140px\",\n                      }}\n                    ></img>\n                  </div>\n                )}\n              </div>\n              <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\n                <div\n                  className=\"ms-font-xl \"\n                  style={{\n                    padding: \"8px\",\n                    lineHeight: \"32px\",\n                    textAlign: \"center\",\n                  }}\n                >\n                  <Highlight\n                    text={team.tile.title}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n              </div>\n\n            </div>\n            {team.tile.inShort && (\n              <div\n                className=\"ms-font-m\"\n                style={{\n                  fontStyle: \"italic\",\n                  marginTop: \"10px\",\n                  paddingLeft: \"20px\",\n                  paddingRight: \"20px\",\n                  margin: \"0px\",\n                }}\n              >\n                <div style={{ fontStyle: \"italic\", marginTop: \"8px\" }}>\n                  <Highlight\n                    text={team.tile.inShort}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n              </div>\n            )}\n          </a>\n        </span>\n        <div>{mouseOver && <GroupMouseOver />}</div>\n      </div>\n    );\n  }\n\n  var uniqueEndPoints = _.groupBy(team.data.endPoints ? team.data.endPoints  :[] ,endPoint=>{return endPoint.providerName })\n//debugger\n  var conversationsHref = (uniqueEndPoints[\"Yammer\"]) ? uniqueEndPoints[\"Yammer\"][0].uri : teamsLink(href);\n\n\n  var details =\n    team.data && team.data.details\n      ? team.data.details\n      : {\n          displayName: team.title\n            ? team.title\n            : team.displayName\n            ? team.displayName\n            : team[\"@odata.type\"],\n        };\n  var photo = team.data ? team.data.photo : null;\n  var channels = team.data && team.data.channels ? team.data.channels : [];\n  return (\n    <div\n      onMouseEnter={()=>{setMouseOver(true)}}\n      onMouseLeave={()=>{setMouseOver(false)}}\n\n      style={{\n        paddingLeft: \"0px\",\n        margin: \"10px\",\n        fontSize: \"16px\",\n        xdisplay: \"flex\",\n        border: \"1px solid #dddddd\",\n        minWidth: \"290px\",\n        maxWidth: \"290px\",\n      }}\n    > \n      <a\n        className=\"TeamLink\"\n        href={conversationsHref}\n        rel=\"noopener noreferrer\"\n        target=\"_blank\"\n      >\n        <div>\n\n\n          <div\n            style={{\n              minWidth: \"290px\",\n              paddingLeft: \"0px\",\n              paddingBottom: \"0px\",\n            }}\n          >{mouseOver &&<div style={{position:\"absolute\"}}> <GroupMouseOver /></div>}\n            {photo && (\n              <img\n              className=\"teamImage\"\n                src={photo}\n                style={{\n                  height: \"288px\",\n                  width: \"288px\",\n                  marginLeft: \"0px\",\n                }}\n              ></img>\n            )}\n          </div>\n          <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\n            <div\n              className=\"ms-font-xl \"\n              style={{\n                padding: \"8px\",\n                lineHeight: \"32px\",\n                textAlign: \"center\",\n              }}\n            >\n              <Highlight\n                text={details.displayName}\n                filter={props.filter}\n                style={props.highlightStyle}\n              />\n            </div>\n          </div>\n          <div style={{ border: \"0px solid #dddddd\", paddingBottom: \"4px\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                marginRight: \"10px\",\n                marginLeft: \"10px\",\n                marginTop: \"10px\",\n              }}\n            >\n              <div style={{ flexGrow: 1 }}>{team.visibility}</div>\n              <div>\n                {logo(team.hasTeams, \"TeamsLogo\")}\n                {logo(team.hasSharePoint, \"SharepointLogo\")}\n                {logo(team.hasYammer, \"YammerLogo\")}\n              </div>\n            </div>\n\n            {/* {team.data.endPoints && \n              team.data.endPoints.map((endPoint, key) => {\n             // if (endPoint.providerName===\"Yammer\") debugger\n              return <div key={key}><a target=\"_blank\" href={endPoint.uri}>{endPoint.providerName} ({endPoint.capability})</a></div>;\n              })} */}\n          </div>\n        </div>\n        {details.displayName !== details.description && (\n          <div\n            className=\"ms-font-m\"\n            style={{\n              fontStyle: \"italic\",\n              marginTop: \"10px\",\n              paddingLeft: \"20px\",\n              paddingRight: \"20px\",\n              margin: \"0px\",\n            }}\n          >\n            {details.description}\n          </div>\n        )}\n        {viewChannels && (\n          <div className=\"ms-font-l ms-fontWeight-bold\">\n            {channels.length > 1 && (\n              <div style={{ marginTop: \"10px\", marginLeft: \"20px\" }}>\n                Channels\n              </div>\n            )}\n            <div className=\"channelListing\">\n              <ul style={{ xdisplay: \"none\", marginTop: \"10px\" }}>\n                {channels.map((channel, key) => {\n                  if (channel.displayName === \"$General\") {\n                    return null;\n                  }\n                  return (\n                    <li key={key} className=\"ms-font-m\">\n                      <div\n                        style={{\n                          color:\n                            channel.membershipType === \"private\"\n                              ? \"red\"\n                              : \"#000000\",\n                        }}\n                      >\n                        <Highlight\n                          text={channel.displayName}\n                          filter={props.filter}\n                          style={props.highlightStyle}\n                        />\n                      </div>\n                      {channel.description && (\n                        <div\n                          style={{ fontSize: \"smaller\", fontStyle: \"italic\" }}\n                        >\n                          <Highlight\n                            text={channel.description}\n                            filter={props.filter}\n                            style={props.highlightStyle}\n                          />\n                        </div>\n                      )}\n                      {channel.tabs && (\n                        <div className=\"channelTabs\">\n                          <ul>\n                            <li>\n                              {\" \"}\n                              <span\n                                onClick={() => {\n                                  trace(EVENT.TABCLICKED, {\n                                    \"team-name\": details.displayName,\n                                    \"channel-name\": channel.displayName,\n                                    href: channel.filesLink,\n                                  });\n                                }}\n                              >\n                                <a href={channel.generalLink} target=\"_blank\">\n                                  General\n                                </a>\n                              </span>\n                            </li>\n                            <li>\n                              <span\n                                onClick={() => {\n                                  trace(EVENT.TABCLICKED, {\n                                    \"team-name\": details.displayName,\n                                    \"channel-name\": channel.displayName,\n                                    href: channel.filesLink,\n                                  });\n                                }}\n                              >\n                                <a href={channel.filesLink} target=\"_blank\">\n                                  Files\n                                </a>\n                              </span>\n                            </li>\n                            {_.sortBy(channel.tabs, [\"sortOrderIndex\"]).map(\n                              (tab, ix) => {\n                                return (\n                                  <li key={ix}>\n                                    <span\n                                      onClick={() => {\n                                        trace(EVENT.TABCLICKED, {\n                                          \"team-name\": details.displayName,\n                                          \"channel-name\": channel.displayName,\n                                          \"tab-name\": tab.displayName,\n                                          href: channel.filesLink,\n                                        });\n                                      }}\n                                    >\n                                      <a\n                                        href={\n                                          tab.configuration &&\n                                          tab.configuration.websiteUrl\n                                            ? tab.configuration.websiteUrl\n                                            : tab.webUrl\n                                        }\n                                        target=\"_blank\"\n                                      >\n                                        <Highlight\n                                          text={decodeURIComponent(\n                                            tab.displayName\n                                          )}\n                                          filter={props.filter}\n                                          style={props.highlightStyle}\n                                        />\n                                      </a>\n                                    </span>\n                                  </li>\n                                );\n                              }\n                            )}\n                          </ul>\n                        </div>\n                      )}\n                    </li>\n                  );\n                })}\n              </ul>\n            </div>\n          </div>\n        )}\n        <div>\n          {viewDates && (\n            <div style={{ display: \"xflex\" }}>\n              {team.expirationDateTime && (\n                <div style={{ flexGrow: 1 }}>\n                  Expires in {moment(team.expirationDateTime).fromNow(true)}\n                </div>\n              )}\n              {/* {team.renewedDateTime && (<div style={{ flexGrow: 1 }}>\n                     Renewed {moment(team.renewedDateTime).toNow(true)} a go\n          </div>)} */}\n            </div>\n          )}{\" \"}\n        </div>\n      </a>\n     \n    </div>\n  );\n}\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\nimport React, { Component, useState, useEffect } from \"react\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport \"./App.css\";\nimport \"./css/normalize.css\";\nimport \"./css/webflow.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\nimport { AppSuperTile } from \"./components/AppSuperTile\";\nimport { AppFullSizeTile } from \"./components/AppFullSizeTile\";\nimport { TextField } from \"@fluentui/react\";\nimport { initializeIcons } from \"@uifabric/icons\";\n\nimport { teamMemberships } from \"./helpers/OfficeGraph\";\nimport { PivotItem, Pivot } from \"@fluentui/react/lib/Pivot\";\nimport { ViewErrors } from \"./components/ViewErrors\";\nimport { ViewTeams } from \"./components/ViewTeams\";\nimport {\n  DefaultButton,\n  PrimaryButton,\n  Stack,\n  IStackTokens,\n  ShimmerElementsGroup,\n} from \"office-ui-fabric-react\";\nimport {\n  Dropdown,\n  DropdownMenuItemType,\n  IDropdownStyles,\n  IDropdownOption,\n} from \"office-ui-fabric-react/lib/Dropdown\";\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\nimport { Toggle } from \"@fluentui/react/lib/Toggle\";\nimport {\n  CommandBar,\n  ICommandBarItemProps,\n} from \"office-ui-fabric-react/lib/CommandBar\";\n\nimport Animejs from \"animejs\";\nimport \"react-grid-layout/css/styles.css\";\nimport \"react-resizable/css/styles.css\";\nimport GridLayout from \"react-grid-layout\";\nimport ToolboxLayout from \"./components/ToolboxLayout\";\n\nimport config from \"./config\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\nimport { readCache, saveCache } from \"./helpers/LaunchPad\";\n\nvar logSearchTimer;\nvar searchInfo;\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\ninitializeIcons();\n\nexport default function App(props) {\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n  const [showTabFeature, setThowTabFeature] = useState(\n    config.teamsIntegration || upnIs(config.niels)\n  );\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\n  const [filter, _setFilter] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [tiles, setTiles] = useState([]);\n  const [useAuthentication, setUseAuthentication] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isZoomed, setIsZoomed] = useState(false);\n  const [currentTile, setCurrentTile] = useState(null);\n  const [me, setMe] = useState({});\n  const [ztickyFolder, setZtickyFolder] = useState({});\n  const [myTools, setMyTools] = useState([]);\n  const [ztickyRef, setZtickyRef] = useState(\"\");\n  const [tileSize, setTileSize] = useState(1);\n  const [errors, setErrors] = useState([]);\n  const [memberships, setMemberships] = useState([]);\n  const [siteUrlLabel, setSiteUrlLabel] = useState(\"\");\n  const [siteUrlHref, setSiteUrlHref] = useState(\"\");\n  const [refreshing, setRefresing] = useState(false);\n  const [progress, setProgress] = useState(\"\");\n  const [progressPercent, setProgressPercent] = useState(null);\n  const [showTable, setShowTable] = useState(false);\n  const [editingLayout, setEditingLayout] = useState(true);\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\n  const [tableUrl, setTableUrl] = useState(\"\");\n  const [layouts, setLayouts] = useState({});\n  const [currentPivot, setCurrentPivot] = useState(\"pinned\");\n  const [refreshCounter, setRefreshCounter] = useState(0);\n  const [tags, setTags] = useState([]);\n  const [showDetails, _setShowDetails] = useState(false);\n  const [tableApiSelected, setTableApiSelected] = useState(\n    \"https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE\"\n  );\n  const [selectedGroup, setSelectedGroup] = useState(\"\");\n  const [groups, setGroups] = useState([]);\n  const inFrame = inIframe();\n\n  function setShowDetails(on) {\n    _setShowDetails(on);\n    trace(EVENT.DETAILSTOGGLED, { on });\n  }\n  function setFilter(value) {\n    setSearch(value);\n    if (_.startsWith(value, \".\")) {\n    } else {\n      _setFilter(value);\n    }\n  }\n\n  const _setTags = (t) => {\n    debugger;\n    setTags(t);\n  };\n  const addTile = (tile) => {\n    setProgress(\"Adding pin\");\n    //OfficeGraph.addTile(ztickyFolder, tile)\n    //   .then(async (folder) => {\n    //     try {\n    //       // var myTools = await OfficeGraph.getMyTools(ztickyFolder, true);\n    //       myTools.push(folder);\n\n    //       var keys = _.keys(layouts);\n    //       keys.forEach((key) => {\n    //         layouts[key].push({\n    //           x: 0,\n    //           y: Infinity,\n    //           w: 3,\n    //           h: 3,\n\n    //           i: layouts[key].length.toString(),\n\n    //           static: 0, //Math.random() < 0.05,\n    //         });\n    //       });\n    //       setLayouts(layouts);\n\n    //       //\n    //       setMyTools(myTools);\n    //     } catch (error) {\n    //       errors.push({ context: \"AddTile > myTools.push() \", error });\n    //       setErrors(errors);\n    //     }\n    //     // myTools.forEach(tool=>{\n\n    //     // })\n    //     // debugger\n    //   })\n    //   .catch((error) => {\n    //     errors.push({ context: \"OfficeGraph.addTile()\", error });\n    //     setErrors(errors);\n    //   })\n    //   .finally(() => {\n    //     setProgress(\"\");\n    //   });\n    // // db.table('myTiles')\n    // //   .add(tile)\n    // //   .then((id) => {\n    // //     const newList = [...myTiles, Object.assign({}, tile, { id })];\n    // //     setMyTiles(newList)\n    // //   });\n  };\n\n  useEffect(() => {\n    // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\n\n    if (showTabFeature) initGraph(false);\n\n    var search = getSearchParametersFromHRef(window.location.href);\n    if (search.ztickyref) {\n      setZtickyRef(search.ztickyref);\n    }\n    var href = search.src ? search.src : config.defaultTableAPI;\n    setTableUrl(config.defaultTableAPI);\n    readGrid(href, config.defaultTableKey);\n  }, [refreshCounter]);\n\n  function readGrid(href, tableId) {\n    axios.get(href).then(({ data }) => {\n      setTitlegraphics(data.titlegraphics);\n      var tiles = [];\n      if (data.grid) {\n        var groups = {};\n        var groupRefs = {};\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.groupSetting) {\n              groups[cell.groupSetting.title] = {\n                groupSetting: cell.groupSetting,\n                members: cell.members,\n              };\n              if (cell.members) {\n                cell.members.forEach((id) => {\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\n                  refs.push(cell.groupSetting);\n                  groupRefs[id] = refs;\n                });\n              }\n            }\n          });\n        });\n\n        var g = _.keys(groups);\n        var ga = g.map((name) => {\n          return { title: name, ...groups[name] };\n        });\n\n        setGroups(_.sortBy(ga, [\"title\"]));\n\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.tile && cell.tile.title) {\n              var tile = { ...cell.tile };\n              tile.sortKey = _.toLower(cell.tile.title);\n              tile.tableId = tableId;\n              tile.correlation =\n                href +\n                \"#\" +\n                (tile.key\n                  ? tile.key\n                  : tile.title\n                  ? tile.title.toLowerCase()\n                  : tile.id);\n              var references = groupRefs[cell.id];\n              tile.references = references;\n              tiles.push(tile);\n            }\n          });\n        });\n      }\n\n      setTiles(_.sortBy(tiles, [\"sortKey\"]));\n    });\n  }\n\n  async function initGraph(refresh) {\n    try {\n      if (refresh) {\n       \n      }\n      var queueCount = 0;\n\n      // await OfficeGraph.initStorage();\n\n      var localCache = localStorage.getItem(\"memberships\");\n      var cachedMemberships;\n      try {\n        if (localCache && !refresh) {\n          cachedMemberships = JSON.parse(localCache);\n          setMemberships(cachedMemberships);\n\n          return;\n        }\n      } catch (error) {}\n\n      setRefresing(true);\n      cachedMemberships = await readCache().catch((error) => {\n        errors.push({ context: \"readCache\", error });\n        setErrors(errors);\n      });\n\n      if (cachedMemberships && !refresh) {\n        setMemberships(cachedMemberships);\n        localStorage.setItem(\"memberships\", JSON.stringify(memberships));\n        setRefresing(false);\n      } else {\n        queueCount++;\n        setProgress(\"Loading\");\n        teamMemberships((percent) => {\n          setProgressPercent(percent);\n        })\n          .then(async (memberships) => {\n            await saveCache(memberships).catch((error) => {\n              errors.push({ context: \"saveCache\", error });\n              setErrors(errors);\n            });\n            localStorage.setItem(\"memberships\", JSON.stringify(memberships));\n            queueCount--;\n            if (queueCount === 0) setRefresing(false);\n            trace(EVENT.MEMBERSHIPSREAD, {\n              \"count-memberships\": memberships.length,\n            });\n            setMemberships(memberships);\n\n            setProgress(\"\");\n          })\n          .catch((error) => {\n            debugger;\n            queueCount--;\n            if (queueCount <= 0) setRefresing(false);\n            errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\n            setErrors(errors);\n            setProgress(\"\");\n          });\n      }\n      return;\n      // OfficeGraph.initTileStorage()\n      //   .then(async (ztickyFolder) => {\n      //     setZtickyFolder(ztickyFolder);\n      //     queueCount++;\n\n      //     var [layouts, properties, version] = await OfficeGraph.readLayouts(\n      //       ztickyFolder\n      //     );\n      //     //debugger\n      //     var myTools = [];\n      //     if (version < 0) {\n      //       var tileFolders = await OfficeGraph.getMyTools(\n      //         ztickyFolder,\n      //         refresh\n      //       );\n      //       myTools = tileFolders.map((folder) => {\n      //         return {\n      //           title: folder.tile ? folder.tile.title : folder.name,\n      //           tile: folder.tile,\n      //         };\n      //       });\n      //     } else {\n      //       myTools = properties.tiles.map((tile) => {\n      //         if (!tile) return null;\n\n      //         return { title: tile.title, tile };\n      //       });\n      //     }\n\n      //     queueCount--;\n      //     if (queueCount === 0) setRefresing(false);\n      //     setMyTools(myTools);\n      //     setLayouts(layouts);\n      //   })\n      //   .catch((error) => {\n      //     queueCount--;\n      //     if (queueCount <= 0) setRefresing(false);\n      //     errors.push({ context: \"OfficeGraph.initStorage()\", error });\n      //     setErrors(errors);\n      //   });\n    } catch (error) {\n      errors.push({ context: \"initGraph\", error });\n      setErrors(errors);\n    }\n  }\n\n  function matchFilter(tile) {\n    if (!filter) return true;\n    var match =\n      tile &&\n      tile.title &&\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.inShort &&\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.subTitle &&\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n\n    return match;\n  }\n\n  function matchTeam(team) {\n    var include = true;\n    if (tags.length > 0) {\n      include = false;\n      tags.forEach((tag) => {\n        switch (tag.id) {\n          case \"sharepoint\":\n            if (team.hasSharePoint) {\n              include = true;\n            }\n            break;\n          case \"teams\":\n            if (team.hasTeams) {\n              include = true;\n            }\n\n            break;\n          case \"yammer\":\n            if (team.hasYammer) {\n              include = true;\n            }\n            break;\n          case \"private\":\n            if (team.visibility === \"Private\") {\n              include = true;\n            }\n            break;\n          case \"public\":\n            if (team.visibility === \"Public\") {\n              include = true;\n            }\n            break;\n          default:\n            break;\n        }\n      });\n    }\n    if (!include) return false;\n    if (!filter) return true;\n    var details = team.data && team.data.details ? team.data.details : {};\n    var channels = team.data && team.data.channels ? team.data.channels : [];\n    var match =\n      details.displayName &&\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        details.description &&\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    channels.forEach((channel) => {\n      if (!match) {\n        match =\n          channel.displayName &&\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n      if (!match) {\n        match =\n          channel.description &&\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n    });\n\n    return match;\n  }\n  function persistLayouts(layouts) {\n    setLayouts(layouts);\n    // var tiles = myTools.map((tool) => {\n    //   return tool.tile;\n    // });\n    // OfficeGraph.writeLayouts(ztickyFolder, layouts, { tiles })\n    //   .then()\n    //   .catch((error) => {\n    //     errors.push({ context: \"  OfficeGraph.writeLayouts()\", error });\n    //     setErrors(errors);\n    //   });\n  }\n\n  var filteredTiles = !filter && tags.length === 0 ? tiles : [];\n  var filteredMyTools = !filter && tags.length === 0 ? myTools : [];\n  var filteredMemberShips = !filter && tags.length === 0 ? memberships : [];\n  var filteredSiteLinks = !filter && tags.length === 0 ? [] : [];\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\n  if (filter || tags.length > 0) {\n    tiles.forEach((tile) => {\n      if (matchFilter(tile)) {\n        filteredTiles.push(tile);\n      }\n    });\n    myTools.forEach((folder) => {\n      if (matchFilter(folder.tile)) {\n        filteredMyTools.push(folder);\n      }\n    });\n\n    memberships.forEach((team) => {\n      if (matchTeam(team)) {\n        filteredMemberShips.push(team);\n      }\n    });\n\n    if (\n      searchInfo &&\n      searchInfo[\"search-for\"] &&\n      searchInfo[\"search-for\"] === filter\n    )\n      return;\n\n    searchInfo = {\n      \"search-for\": filter,\n      \"found-memberships\": filteredMemberShips.length,\n      \"found-tiles\": filteredMyTools.length,\n    };\n\n    if (logSearchTimer) {\n      console.log(\"Postponing search trace\");\n      clearTimeout(logSearchTimer);\n    }\n    console.log(\"Timeing search trace\");\n    logSearchTimer = setTimeout(() => {\n      console.log(\"sending search trace\");\n      trace(EVENT.SEARCHING, searchInfo);\n      logSearchTimer = null;\n    }, 1000);\n  }\n\n  const dropdownStyles = {\n    dropdown: { width: 300 },\n  };\n\n  if (!props || (!props.auth && props.auth.user)) {\n    return (\n      <div>\n        <h1>Sorry - You cannot get in here</h1>\n        {JSON.stringify(\n          props && props.auth && props.auth.error ? props.auth.error : \"\"\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      {!inFrame && config.components.header}\n      {/* <CommandBar\n        // items={_items}\n        // overflowItems={_overflowItems}\n        // overflowButtonProps={overflowProps}\n        farItems={[\n          // {\n          //   key: \"tile\",\n          //   text: \"Grid view\",\n          //   // This needs an ariaLabel since it's icon-only\n          //   ariaLabel: \"Filter view\",\n          //   iconOnly: true,\n          //   iconProps: { iconName: \"Filter\" },\n          //   onClick: () => {\n          //     if (showFilterOptions) {\n          //       setFilter(\"\");\n          //     }\n          //     setShowFilterOptions(!showFilterOptions);\n          //   }\n          // }\n        ]}\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n      /> */}\n      <div style={{ paddingRight: \"20px\", paddingLeft: \"20px\" }}>\n        {\" \"}\n        {progress && (\n          <div\n            style={{\n              backgroundColor: \"white\",\n              width: \"100vw\",\n              position: \"fixed\",\n              top: \"0px\",\n              zIndex: 2,\n            }}\n          >\n            <ProgressIndicator\n              percentComplete={progressPercent}\n              xlabel=\"Example title\"\n              xdescription={progress}\n            />\n          </div>\n        )}\n        <img\n          style={{\n            display: \"none\",\n            height: \"64px\",\n            margin: \"13px\",\n            position: \"fixed\",\n            bottom: \"0px\",\n            right: \"0px\",\n          }}\n          src={titlegraphics}\n        ></img>\n        {isZoomed && (\n          <div>\n            <AppFullSizeTile\n              tile={currentTile ? currentTile : tiles ? tiles[0] : null}\n              onClose={() => {\n                setIsZoomed(false);\n              }}\n            />\n          </div>\n        )}\n        {!isZoomed && (\n          <div style={{ display: \"flex\" }}>\n            {\" \"}\n            <div\n              style={{\n                display: \"xnone\",\n                paddingRight: \"8px\",\n                position: \"fixed\",\n                bottom: \"0px\",\n                backgroundColor: \"white\",\n              }}\n            >\n              {showTabFeature && (\n                <div>\n                  {/* <a href={ztickyFolder.webUrl} target=\"_blank\">\n                    <i\n                      style={{\n                        cursor: \"pointer\",\n                        padding: \"4px\",\n                        color: \"black\",\n                      }}\n                      class=\"ms-Icon ms-Icon--OpenFolderHorizontal\"\n                      aria-hidden=\"true\"\n                    ></i>{\" \"}\n                  </a> */}\n                  <i\n                    style={{ cursor: \"pointer\", padding: \"4px\" }}\n                    className=\"ms-Icon ms-Icon--Refresh\"\n                    onClick={() => {\n                      initGraph(true);\n                    }}\n                    aria-hidden=\"true\"\n                  ></i>{\" \"}\n                  {refreshing && <>Loading</>}\n                </div>\n              )}\n            </div>\n            <div\n              style={{\n                position: \"fixed\",\n                right: 0,\n                top: 0,\n                zIndex: 32,\n                marginRight: \"16px\",\n              }}\n            >\n              <div style={{ display: \"flex\" }}>\n                <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                  Details</div>\n                <div style={{ marginTop: \"16px\" }}>\n                  \n                  <Toggle\n                    xlabel=\"Show Table\"\n                    checked={showDetails}\n                    xonText=\"Table view On\"\n                    xoffText=\"Table view Off\"\n                    onChange={(e, checked) => {\n                      setShowDetails(checked);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                  />\n                </div>\n              </div>\n            </div>\n            <div style={{ flexGrow: \"1\" }}>\n              <div\n                style={{\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  marginTop: \"8px\",\n                }}\n              >\n                <div style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}>\n                  <TextField\n                    autoFocus={true}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n\n                    <ReactTags\n                    placeholder=\"Filter by tag, like Yammer, Teams ...\"\n                  autofocus={false}\n                    tags={tags}\n                    suggestions={[\n                      {\n                        name: \"Teams\",\n                        id: \"teams\",\n                      },\n                      {\n                        name: \"SharePoint\",\n                        id: \"sharepoint\",\n                      },\n                      {\n                        name: \"Yammer\",\n                        id: \"yammer\",\n                      },\n                      {\n                        name: \"Private\",\n                        id: \"private\",\n                      },\n                      {\n                        name: \"Public\",\n                        id: \"public\",\n                      },\n                    ]}\n                    handleDelete={(i) => {\n                      const tgs = tags.slice(0)\n                      tgs.splice(i, 1)\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                    handleAddition={(tag) => {\n                      var tgs = [].concat(tags, tag);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                  /> \n                   \n                 \n                  \n                </div>{\" \"}\n                {/* <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        placeholder=\"Select an area\"\n                        label=\"Area\"\n                        onChanged={(option, index) => {\n                          readGrid(option.key.api, option.key.id);\n                          setTableUrl(option.key.web);\n                          setTableApiSelected(option.key.api);\n                          setSelectedGroup(\"\");\n                          //debugger\n                        }}\n                        xxselectedKey={tableApiSelected} //\"\"\n                        options={config.options}\n                        styles={dropdownStyles}\n                      />\n                    </div>\n                    <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        placeholder=\"Select a group\"\n                        label=\"Group\"\n                        onChanged={(option, index) => {\n                          setSelectedGroup(option.key);\n                        }}\n                        selectedKey={selectedGroup}\n                        options={groups ? groups.map(group => {\n                          return {\n                            key: group.groupSetting.title,\n                            text: group.groupSetting.title\n                          };\n                        }):[]}\n                        styles={dropdownStyles}\n                      />\n                    </div>\n\n                    <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        disabled={showTable}\n                        placeholder=\"Select tile size\"\n                        selectedKey={tileSize}\n                        label=\"View as\"\n                        onChanged={(option, index) => {\n                          setTileSize(option.key);\n                          //debugger\n                        }}\n                        options={[\n                          {\n                            key: 0,\n                            text: \"Tile\"\n                          },\n                          {\n                            key: 1,\n                            text: \"Small\"\n                          }\n                        ]}\n                        styles={dropdownStyles}\n                      />\n                    </div> */}\n              </div>\n\n              {showTabFeature && false && (\n                <Pivot\n                  style={{ padding: \"0px\" }}\n                  selectedKey={currentPivot}\n                  onLinkClick={(e, pivot, x) => {\n                    // debugger\n                    // setCurrentPivot(pivot.key)\n                  }}\n                >\n                  {/* <PivotItem\n                    key=\"pinned\"\n                    headerText=\"Pinned\"\n                    itemCount={filteredMyTools.length}\n                  /> */}\n                  {/* <PivotItem\n                    headerText=\"Site\"\n                    itemCount={filteredSiteLinks.length}\n                  ></PivotItem> */}\n                  <PivotItem\n                    headerText=\"Teams\"\n                    itemCount={filteredMemberShips.length}\n                  >\n                    {memberships.length > 0 && (\n                      <ViewTeams\n                        refreshCounter={refreshCounter}\n                        tiles={filteredTiles}\n                        memberShips={filteredMemberShips}\n                        details={showDetails}\n                        filter={filter}\n                        highlightStyle={{ backgroundColor: \"yellow\" }}\n                      />\n                    )}\n                  </PivotItem>\n                  {showTabFeature && false && (\n                    <PivotItem headerText=\"Grid\" key=\"grid\">\n                      <div>\n                        <div style={{ display: \"flex\", marginTop: \"8px\" }}>\n                          <div\n                            style={{ marginLeft: \"16px\", flexGrow: 1 }}\n                          ></div>\n                          <div style={{ marginLeft: \"16px\" }}>\n                            <div style={{ display: \"flex\" }}>\n                              <div style={{ padding: \"8px\" }}>Edit Layout</div>\n                              <div>\n                                <Toggle\n                                  checked={editingLayout}\n                                  style={{ marginTop: \"8px\" }}\n                                  onChange={(e, checked) => {\n                                    setEditingLayout(checked);\n                                  }}\n                                />\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                        <ToolboxLayout\n                          tools={myTools}\n                          layouts={layouts}\n                          persist={persistLayouts}\n                          editingLayout={editingLayout}\n                          onTileClick={(tile) => {\n                            setCurrentTile(tile);\n                            setIsZoomed(true);\n                          }}\n                        />\n                      </div>\n                    </PivotItem>\n                  )}\n                  {errors.length !== 0 && (\n                    <PivotItem\n                      headerText=\"Developer feedback\"\n                      itemCount={errors.length}\n                    >\n                      <div>\n                        <ViewErrors errors={errors} />\n                      </div>\n                    </PivotItem>\n                  )}\n                </Pivot>\n              )}\n              {filteredMyTools.length > 0 && (\n                <div>\n                  <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                    {filteredMyTools.map((folder, key) => {\n                      var tile = folder.tile\n                        ? folder.tile\n                        : {\n                            title: folder.name,\n                            color: \"#dddddd\",\n                          };\n                      return (\n                        <AppSuperTile\n                          tileSize={tileSize}\n                          isPinned={true}\n                          key={key}\n                          tile={tile}\n                          filter={filter}\n                          highlightStyle={{\n                            backgroundColor: \"yellow\",\n                            color: \"#333\",\n                          }}\n                          onClick={(tile) => {\n                            // addTile(tile)\n\n                            if (!tile.messageBeforeLaunch && tile.jumpto) {\n                              return window.open(tile.jumpto, \"_blank\");\n                            }\n\n                            setCurrentTile(tile);\n                            setIsZoomed(true);\n                          }}\n                        />\n                      );\n                    })}\n                  </div>\n                </div>\n                // </PivotItem>\n              )}\n              {/* {siteUrl && (\n                 \n                    <h3>Which tools do you find good for this site?</h3>\n                    <div>{siteUrl.hostname}</div>\n                    <TextField\n                      label=\"Label\"\n                      placeholder=\"Enter label for this link\"\n                      value={siteUrlLabel}\n                      onChange={(e, value) => {\n                        setSiteUrlLabel(value);\n                      }}\n                    ></TextField>\n                    <TextField\n                      label=\"URL\"\n                      placeholder=\"Enter URL\"\n                      value={siteUrlHref}\n                      onChange={(e, value) => {\n                        setSiteUrlHref(value);\n                      }}\n                    ></TextField>\n                    <PrimaryButton\n                      text=\"Share link\"\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\n                    />\n                  </PivotItem>\n                )} */}\n              {/* <PivotItem\n                  key=\"catalogue\"\n                  headerText=\"Catalogue\"\n                  itemCount={filteredTiles.length}\n                > */}\n              {showTable && (\n                <>\n                  <div style={{ textAlign: \"right\" }}>\n                    <i\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\n                      class=\"ms-Icon ms-Icon--OpenInNewWindow\"\n                      onClick={() => {\n                        window.open(tableUrl, \"_blank\");\n                      }}\n                      aria-hidden=\"true\"\n                    ></i>\n                  </div>\n                  <iframe\n                    style={{\n                      border: \"0\",\n                      height: \"calc(100vh - 150px\",\n                      width: \"95vw\",\n                    }}\n                    src={tableUrl}\n                  ></iframe>\n                </>\n              )}\n              {showTabFeature && memberships.length > 0 && (\n                <ViewTeams\n                  refreshCounter={refreshCounter}\n                  tiles={filteredTiles}\n                  details={showDetails}\n                  memberShips={filteredMemberShips}\n                  filter={filter}\n                  highlightStyle={{ backgroundColor: \"yellow\" }}\n                />\n              )}\n              {!showTable && !showTabFeature && (\n                <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                  {filteredTiles.length === 0 && (\n                    <div>\n                      <h2>Sorry. No matches for \"{filter}\"</h2>\n                      {/* <h1>\n                        <a href=\"https://christianiabpos.sharepoint.com/sites/intranets-tools#missing-a-link\">\n                          Request a link\n                        </a>\n                      </h1> */}\n                    </div>\n                  )}\n                  {filteredTiles.map((tile, key) => {\n                    if (selectedGroup) {\n                      var match = false;\n\n                      if (!tile.references) return <></>;\n                      tile.references.forEach((r) => {\n                        if (r.title === selectedGroup) {\n                          match = true;\n                        }\n                      });\n                      if (!match) return <></>;\n                    }\n                    return (\n                      <AppSuperTile\n                        tileSize={tileSize}\n                        key={key}\n                        filter={filter}\n                        highlightStyle={{\n                          backgroundColor: \"yellow\",\n                          color: \"#333\",\n                        }}\n                        tile={tile}\n                        onPinnedClicked={(props) => {\n                          if (props.tile) {\n                            addTile(props.tile);\n                          }\n                        }}\n                        onClick={(tile) => {\n                          if (window.amplitude) {\n                            if (\n                              props &&\n                              props.auth &&\n                              props.auth.user &&\n                              props.auth.user.userPrincipalName\n                            )\n                              window.amplitude\n                                .getInstance()\n                                .identify(props.auth.user.userPrincipalName);\n                            window.amplitude\n                              .getInstance()\n                              .logEvent(\"tool\", tile);\n                          }\n                          if (tile.jumpto && !tile.messageBeforeLaunch) {\n                            return window.open(tile.jumpto, \"_blank\");\n                          }\n                          setCurrentTile(tile);\n                          setIsZoomed(true);\n                        }}\n                      />\n                    );\n                  })}\n                </div>\n              )}\n\n              {/* \n\n              */}\n            </div>\n            {showFilterOptions && (\n              <div\n                style={{\n                  borderLeft: \"1px solid #dddddd\",\n                  borderTop: \"1px solid #dddddd\",\n                  padding: \"8px\",\n                  float: \"right\",\n                  minWidth: \"300px\",\n                }}\n              >\n                <div style={{ padding: \"0px\" }}>\n                  <TextField\n                    label=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Filter the list of tools\"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      {props && props.auth && props.auth.user && (\n        <div style={{ textAlign: \"center\" }}>\n          Your are signed in as \"{props.auth.user.displayName}\" with upn{\" \"}\n          {props.auth.user.userPrincipalName}\". Visit your Office profile at\n          &nbsp;\n          <a href=\"https://portal.office.com/account/#apps\" target=\"_blank\">\n            https://portal.office.com/account/#apps\n          </a>\n        </div>\n      )}\n    </div>\n  );\n}\n","import React from \"react\";\nimport logo from \"./default/favicon-96x96.png\";\n\nexport default {\n  clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\n  directoryId: \"common\",\n  scopes: \"user.readwrite.all group.read.all Files.ReadWrite.All\",\n  title: \"Tools\",\n  logo,\n  defaultTableAPI: \"https://api.jumpto365.com/table/hexatown.com/PTO365\",\n  niels: \"niels@jumpto365.com\",\n  teamsIntegration: true,\n  options: [],\n  components: {\n    header: (\n      <div style={{ marginTop: \"80px\" }}>\n        <div\n          style={{\n            borderBottom: \"1px solid #cccccc\",\n            position: \"fixed\",\n            backgroundColor: \"#ffffff\",\n            width: \"100vw\",\n            left: 0,\n            top: 0,\n            zIndex: 1\n          }}\n        >\n          <div\n            style={{ display: \"flex\", padding:\"10px\" }}\n          >\n            <div style={{ flexGrow: 1 ,display: \"flex\"}}>\n              <div >\n                <a style={{ color:\"inherit\",textDecoration:\"none\" }}\n                \n                href=\"/\" target=\"_blank\"> <div \n              \n              className=\"ms-font-xxl\"\n              style={{\n                marginLeft: \"16px\",\n\n                lineHeight: \"36px\",\n                padding: \"0px\",\n                color: \"333\",\n              }}>\n              LAUNZH&trade; by jumpto365</div>\n                  {/* <img style={{ height: \"48px\", padding: \"4px\" }} src={logo} /> */}\n                </a>\n              </div>\n             \n\n            </div>\n            <div\n              \n              \n            >\n              \n            </div>\n            <div style={{ flexGrow: 1 }}>\n              <div style={{ minWidth: \"150px\" }}>&nbsp;</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ),\n  },\n};\n","import {\n  me,\n  myGroups,\n  readTeam,\n  getMyExtention,\n  saveMyExtention,\n  getOneDriveFolder,\n  createOneDriveFolder,\n  createOneDriveFolderChild,\n  getOneDriveFile,\n  saveOneDriveFile,\n} from \"./OfficeGraph\";\n\nimport projectInfo from \"../../package.json\";\n\nexport const extentionName = \"com.ztickybar.tools\";\nexport const OURPATH = \"Apps/jumpto365.com\";\nexport const OURCONFIGFILENAME = \"launchpad.json\";\n\nexport function saveCache(memberships) {\n  return new Promise((resolve, reject) => {\n    var membershipIndex = [];\n    var queue = 0;\n    memberships.forEach((membership) => {\n      membershipIndex.push(membership.id);\n      queue++;\n\n      saveOneDriveFile(\n        OURPATH,\n        cachedFileName(membership.id),\n        membership\n      ).then(() => {\n        queue--;\n        if (queue < 1) {\n          saveOneDriveFile(OURPATH, \"memberships.json\", membershipIndex)\n            .then(() => {\n              resolve(membershipIndex);\n            })\n            .catch((e) => {\n              reject(e);\n            });\n        }\n      });\n    });\n  });\n}\n\nfunction cachedFileName(id) {\n  return \"membership.\" +id + \".json\";\n}\n\nexport function readCache() {\nreturn new Promise(async (resolve, reject) => {\n  var membershipIndex = await getOneDriveFile(OURPATH, \"memberships.json\").catch(e=>{reject(e)})\n  if (!membershipIndex) return\n  var queue = 0;\n  var memberships = []\n  membershipIndex.forEach(id=>{\n    queue++\n    getOneDriveFile(OURPATH, cachedFileName(id)).then(data=>{\n      \n      memberships.push(data)\n      queue--;\n      if (queue < 1) {\n        resolve(memberships)\n      }\n    }).catch(e=>{reject(e)})\n  })\n\n  \n})\n\n\n  \n}\n\n/**\n * Verifies access to all endpoints used for the LaunchPad app\n *\n * @param {*} setCheckMe Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckMyExtention  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckOneDrive  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckOneDriveFiles  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckMemberships  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckTeam  Callback accepting a string - \"OK\" or an error\n */\nexport async function verifyAccessForLanuchPad(\n  setCheckMe,\n  setCheckMyExtention,\n  setCheckOneDrive,\n  setCheckOneDriveFiles,\n  setCheckMemberships,\n  setCheckTeam\n) {\n  me()\n    .then((m) => {\n      setCheckMe(\"OK\");\n    })\n    .catch((e) => {\n      setCheckMe(e.message);\n    });\n\n  var extention = await saveMyExtention(extentionName, {\n    hello: \"world\",\n  }).catch((e) => {\n    setCheckMyExtention(e.message);\n  });\n  if (extention || extention === \"\") {\n    setCheckMyExtention(\"OK\");\n  }\n\n  getOneDriveFolder(OURPATH)\n    .then((r) => {\n      setCheckOneDrive(\"OK\");\n      checkAccessToConfig();\n    })\n    .catch(async (e) => {\n      var f = await getOneDriveFolder(\"Apps\").catch((e) => {});\n      if (f) {\n        var child = await createOneDriveFolderChild(\n          \"Apps\",\n          \"jumpto365.com\"\n        ).catch((e) => {\n          setCheckOneDrive(e.message);\n        });\n        if (child) {\n          setCheckOneDrive(\"OK\");\n          checkAccessToConfig();\n        }\n      } else {\n        var child = await createOneDriveFolder(\"Apps\").catch((e) => {\n          setCheckOneDrive(e.message);\n        });\n        child = await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\").catch(\n          (e) => {\n            setCheckOneDrive(e.message);\n          }\n        );\n        if (child) {\n          setCheckOneDrive(\"OK\");\n          checkAccessToConfig();\n        }\n      }\n    });\n\n  myGroups()\n    .then((memberships) => {\n      setCheckMemberships(\"OK\");\n      var teamId;\n      memberships.forEach((member) => {\n        if (member.displayName) {\n          if (!teamId) {\n            teamId = member.id;\n          }\n        }\n      });\n      if (teamId) {\n        readTeam(teamId)\n          .then((m) => {\n            setCheckTeam(\"OK\");\n          })\n          .catch((e) => {\n            setCheckTeam(e.message);\n          });\n      } else {\n        setCheckTeam(\"Didn't find any Microsoft Teams memberships\");\n      }\n    })\n    .catch((e) => {\n      setCheckMemberships(e.message);\n    });\n\n  async function checkAccessToConfig() {\n    var settings = await getOneDriveFile(OURPATH, OURCONFIGFILENAME).catch(\n      async (e) => {\n        var file = await saveOneDriveFile(OURPATH, OURCONFIGFILENAME, {\n          version: projectInfo.version,\n        }).catch((e) => {\n          setCheckOneDriveFiles(e.message);\n        });\n        if (file) {\n          setCheckOneDriveFiles(\"OK\");\n        }\n      }\n    );\n    if (settings) {\n      setCheckOneDriveFiles(\"OK\");\n    }\n  }\n}\n","export function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\nimport React, { Component, useState, useEffect } from \"react\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport \"./App.css\";\nimport \"./css/normalize.css\";\nimport \"./css/webflow.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\n\n\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\nimport { Toggle } from \"@fluentui/react/lib/Toggle\";\n\nimport config from \"./config\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\nimport { running } from \"animejs\";\n\nimport {verifyAccessForLanuchPad} from \"./helpers/LaunchPad\"\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nexport default function Onboard(props) {\n  const [checkMe, setCheckMe] = useState(\"pending\");\n  const [checkMemberships, setCheckMemberships] = useState(\"pending\");\n  const [checkTeam, setCheckTeam] = useState(\"pending\");\n  const [checkMyExtention, setCheckMyExtention] = useState(\"pending\");\n  const [checkOneDrive, setCheckOneDrive] = useState(\"pending\");\n  const [checkOneDriveFiles, setCheckOneDriveFiles] = useState(\"pending\");\n  \n\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n\n  const inFrame = inIframe();\n\n  useEffect(() => {\n    async function run() {\n      await verifyAccessForLanuchPad(setCheckMe, setCheckMyExtention, setCheckOneDrive, setCheckOneDriveFiles, setCheckMemberships, setCheckTeam);\n    }\n    run();\n  }, []);\n\n  return (\n    <div>\n      <div className=\"OnboardingContainer\" dir=\"ltr\">\n        {!inFrame && config.components.header}\n        \n        {/* <div className=\"ms-fontSize-32\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\n          Checking is everything have been setup for you\n        </div> */}\n       \n        {/* <div>\n          <div className=\"ms-fontSize-20\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\n          <p >jumpto365 are committed to leave your data within your own system, what is yours stay with you. \n          We do not copy any of your information what so ever, period!</p>\n\n           <p>But to make our app work for you, we need your organisation to trust us with the following areas</p>\n\n          \n          </div>\n          <p className=\"ms-fontSize-20\">Allow access to the following areas</p>\n          <ul>\n            <li>\n              <p className=\"ms-fontWeight-bold\">Read and write access to your profile and OneDrive (User.ReadWrite.All)</p>\n              <p>\n                We need this permission to be able to store your preferences as\n                well as your cached data on your profile, and access to store data into your OneDrive.\n              </p>\n              <p>\n                That in order to be able to give you the best performance and to\n                comply with good data pricavy.\n              </p>\n            </li>\n            <li>\n              <p className=\"ms-fontWeight-bold\">Read access to your Groups (Group.Read.All)</p>\n              <p>\n                We need this permission to be able to read details about your\n                group membership and the name, description and tab on your channels in Teams \n              </p>\n            </li>\n          </ul>\n        </div> */}\n        <div>\n          <p className=\"ms-fontSize-20\">Verifying access</p>\n          <ul>\n            <li>Checking access to your profile: ({checkMe})</li>\n            <li>Checking access to your extension: ({checkMyExtention})</li>\n            <li>Checking access to your memberships: ({checkMemberships})</li>\n            <li>Checking access to your teams: ({checkTeam})</li>\n            <li>\n              Checking access to your OneDriver folders: ({checkOneDrive})\n            </li>\n            <li>\n              Checking access to the OneDrive files which we maintain: ({checkOneDriveFiles})\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}","/****\n * \n * \n *  version \n *  1.0 \n * \n * \n * \n */\nimport Axios from \"axios\";\nimport moment from \"moment\";\nexport function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nconst GETACCESSTOKEN = \"getAccessToken\";\nconst RESTOREURL = \"restoreUrl\";\nconst GETGRAPHUSER = \"getGraphUser\";\nconst LOGIN = \"login\";\nconst ACCESSTOKEN = \"access_token\";\nconst ACCESSEXPIRES = \"access_expires\";\n\nfunction isAccessTokenExpired() {\n  try {\n    var exp = sessionStorage.getItem(ACCESSEXPIRES);\n    var expiresIn = moment(exp);\n    var now = moment();\n    var x = now.diff(expiresIn);\n    return x > 0 ? true : false;\n  } catch (error) {\n    return true;\n  }\n}\n\n/**\n * Based on session storage - if no auth token is present, or if is to old, a auth sequence is initiated\n * @param {*} config \n * @param {*} callBackNotifyIfInteractionIsRequired \n */\nexport function authenticate(config, callBackNotifyIfInteractionIsRequired) {\n  // https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow\n\n  return new Promise((resolve, reject) => {\n    var redirect_uri =\n      (window.location.hostname === \"localhost\"\n        ? window.location.protocol\n        : \"https:\") +\n      \"//\" +\n      window.location.hostname +\n      (window.location.port !== 80 &&\n      window.location.port !== 443 &&\n      window.location.port !== \"\"\n        ? \":\" + window.location.port\n        : \"\") +\n      \"/\";\n    // window.location.pathname;\n\n    var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\n    var client_id = config.clientId;\n    var response_type = \"id_token\";\n    var response_mode = \"fragment\";\n    var scope = config.scopes;\n\n    var seq = \"\"; // sessionStorage.getItem(\"authseq\");\n    var search = getSearchParametersFromHash(window.location.href);\n\n    var search2 = getSearchParametersFromHRef(window.location.href);\n    //debugger\n\n    if (search.id_token) {\n      seq = GETACCESSTOKEN;\n    } else if (search.access_token) {\n      seq = RESTOREURL;\n    } else if (search.login) {\n      seq = LOGIN;\n    } else if (seq === \"\") {\n      if (sessionStorage.getItem(ACCESSTOKEN)) {\n        seq = isAccessTokenExpired() ? GETACCESSTOKEN : GETGRAPHUSER;\n      } else {\n        seq = GETACCESSTOKEN;\n      }\n    }\n\n    if (search.error || search2.error) {\n      var e = search.error ? search.error : search2.error;\n      var handled = false;\n      switch (e) {\n        case \"interaction_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired();\n          }\n          sessionStorage.removeItem(\"accesstoken\");\n          sessionStorage.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&response_type=${response_type}&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=openid&nonce=1`;\n          window.location.href = url;\n          return;\n          break;\n        case \"consent_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired();\n          }\n          //debugger;\n          sessionStorage.removeItem(\"accesstoken\");\n          sessionStorage.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&prompt=consent&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=openid&nonce=1`;\n          window.location.href = url;\n          return;\n          break;\n        case \"invalid_request\":\n          \n          break\n        default:\n          if (sessionStorage.setItem(\"returnto\", \"/\"))\n            window.location.href = \"#login\";\n          return;\n          handled = true;\n          break;\n      }\n      if (!handled) {\n        alert(\n          search.error_description\n            ? search.error_description\n            : search2.error_description\n        );\n        //window.location.href = sessionStorage.getItem(\"returnto\");\n        reject(search.error_description)\n        return;\n      }\n    }\n\n    switch (seq) {\n      case LOGIN:\n        sessionStorage.setItem(\"returnto\", window.location.href);\n      \n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n        window.location.href = url;\n        return;\n        break;\n      case GETACCESSTOKEN:\n        sessionStorage.setItem(\"returnto\", window.location.href);\n    \n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}`;\n        window.location.href = url;\n        return;\n        break;\n      case GETGRAPHUSER:\n        sessionStorage.removeItem(\"returnto\");\n\n        Axios.get(\"https://graph.microsoft.com/v1.0/me\", {\n          headers: {\n            \"content-type\": \"application/json\",\n            authorization: `Bearer ${sessionStorage.getItem(ACCESSTOKEN)}`,\n          },\n        })\n          .then((result) => {\n            resolve({ user: result.data });\n          })\n          .catch((error) => {\n            var txt = error.response.data.error.message;\n            if (\n              error &&\n              error.response &&\n              error.response.data &&\n              error.response.data.error\n            ) {\n              //alert(error.response.data.error.message)\n              resolve({ error: error.response.data.error.message });\n            } else {\n              resolve({ error });\n            }\n          });\n        break;\n\n      case RESTOREURL:\n        if (search.access_token) {\n          sessionStorage.setItem(ACCESSTOKEN, search.access_token);\n\n          var expires = moment().add(search.expires_in, \"s\");\n\n          sessionStorage.setItem(ACCESSEXPIRES, expires.toISOString());\n          if (sessionStorage.getItem(\"returnto\"))\n            window.location.href = sessionStorage.getItem(\"returnto\");\n          return;\n        } else {\n          window.location.reload();\n        }\n        resolve();\n        break;\n\n      default:\n        resolve({\n          error:\n            \"Sorry to have put you in this situation, but our authentication logic is not able to detect the next step to taka so we cannot let you in\",\n        });\n        break;\n    }\n  });\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport Onboard from \"./Onboard\";\nimport config from \"./config\";\nimport { authenticate } from \"./authenticate\";\n\nimport { FluentCustomizations } from \"@uifabric/fluent-theme\";\nimport { Customizer, mergeStyles, Fabric } from \"office-ui-fabric-react\";\nimport { loadTheme } from \"@fluentui/react\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\n\nimport { Router, Link } from \"@reach/router\";\nvar x = loadTheme({\n  defaultFontStyle: {\n    fontFamily: \"Monaco, Menlo, Consolas\",\n    fontWeight: \"regular\",\n  },\n  fonts: {\n    small: {\n      fontSize: \"11px\",\n    },\n    medium: {\n      fontSize: \"13px\",\n    },\n    large: {\n      fontSize: \"20px\",\n      fontWeight: \"semibold\",\n    },\n    xLarge: {\n      fontSize: \"22px\",\n      fontWeight: \"semibold\",\n    },\n  },\n});\n\n// // Inject some global styles\n// mergeStyles({\n//   selectors: {\n//     ':global(body), :global(html), :global(#root)': {\n//       margin: 0,\n//       padding: 0,\n//       height: '100vh'\n//     }\n//   }\n// });\nasync function start() {\n  var auth = await authenticate(config, () => {\n    // this is where you can send a signal to a host that intercati ons is required\n  }).catch((error) => {\n    console.log(error);\n    document.getElementById(\"root\").innerHTML = error;\n    return;\n  });\n  if (auth && auth.user) {\n    who(auth.user.userPrincipalName);\n    const key = \"HASLANDED\";\n\n    var landed = sessionStorage.getItem(key);\n    if (!landed) {\n      trace(EVENT.LANDING);\n      sessionStorage.setItem(key, \"1\");\n    }\n  }\n  // const key = \"ONBOARDING\";\n\n  // var landed = sessionStorage.getItem(key);\n  // if (!landed) {\n  //   trace(EVENT.ONBOARDING);\n  //   sessionStorage.setItem(key, \"1\");\n  // }\n\n  ReactDOM.render(\n    <Customizer {...FluentCustomizations}>\n      <Fabric theme={x}>\n        <Router>\n          <Onboard path=\"check\" />\n          <App auth={auth} path=\"/\" />\n        </Router>\n      </Fabric>\n    </Customizer>,\n    document.getElementById(\"root\")\n  );\n}\n\nstart();\n"],"sourceRoot":""}