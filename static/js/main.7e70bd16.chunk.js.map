{"version":3,"sources":["config/default/Logo.png","components/ToolboxLayout.js","components/Tags.js","components/Highlight.js","components/AppSuperTile.js","components/AppFullSizeTile.js","helpers/OfficeGraph/index.js","components/ViewErrors.js","components/ViewTeams.js","config/index.js","App.js","helpers/index.js","authenticate.js","index.js"],"names":["module","exports","ResponsiveReactGridLayout","WidthProvider","Responsive","ToolBoxItem","className","onClick","this","props","onTakeItem","bind","undefined","item","i","React","Component","generateLayout","_","map","range","y","Math","ceil","random","x","floor","w","h","toString","static","onBreakpointChange","breakpoint","setState","prevState","currentBreakpoint","toolbox","onCompactTypeChange","oldCompactType","state","compactType","filter","layouts","onPutItem","onLayoutChange","layout","key","value","global","localStorage","setItem","JSON","stringify","persist","onNewLayout","lg","mounted","tools","tool","ix","initialLayout","that","l","tile","title","style","backgroundColor","color","textcolor","cursor","editingLayout","onTileClick","src","icon","height","maxHeight","width","padding","isDraggable","measureBeforeMount","useCSSTransforms","preventCollision","generateDOM","defaultProps","rowHeight","cols","md","sm","xs","xxs","Tags","references","display","flexWrap","group","margin","textColor","Highlight","text","toLowerCase","indexOf","first","substr","middle","length","last","AppSuperTile","useState","tileSize","border","maxWidth","borderRadius","overflow","marginTop","flexGrow","lineHeight","marginLeft","fontSize","highlightStyle","alignItems","class","isPinned","e","onPinnedClicked","preventDefault","stopPropagation","aria-hidden","textAlign","inShort","justifyContent","externalArticle","href","rel","target","AppFullSizeTile","html","setHtml","error","setError","useEffect","contentRef","axios","get","then","result","converter","QuillDeltaToHtmlConverter","data","ops","convert","catch","response","status","message","onClose","textOverflow","whiteSpace","paddingLeft","xheight","messageBeforeLaunch","jumpto","dangerouslySetInnerHTML","__html","graph","analyseMembers","token","emailAddresses","cb","addresses","split","forEach","element1","element2","match","smtp","push","checked","results","address","readUser","err","user","invite","emailAddress","invitationRedirectUrl","post","invitedUserEmailAddress","inviteRedirectUrl","invitedUserDisplayName","sendInvitationMessage","invitedUserMessageInfo","customizedMessageBody","ccRecipients","name","addcrm","tag","msg","properties","property","url","body","request","headers","parsedBody","parse","post2","addmember","userId","groupId","getSharePointList","host","site","list","listfilter","itemfilter","items","itemList","next","pop","id","getPages","readGroupMembers","readGroupMemberShipFor","upn","readManager","userPrincipalName","index","matchingGroups","searchText","findGroup","getGroupDocuments","folderName","getGroupDrive","getGroupSite","getDriveChildren","driveId","itemId","getGroupRootFolders","getSharePointSiteByName","hostName","relativePath","getSharePointSiteDrive","path","copyfile","groupNickName","fromFolder","fromName","toFolder","toName","groups","fromItems","find","targetFolders","destFolder","newDoc","parentReference","sourceGroupId","lookupFile","iterations","file","console","log","iteration","setTimeout","Client","Promise","resolve","reject","getRaw","authorization","getImage","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","readAsDataURL","open","setRequestHeader","responseType","send","auth","getAccessToken","teamMemberships","client","a","memberships","pending","photo","details","channels","displayName","description","sort","b","appendTo","retrycount","errCounter","concat","sessionStorage","getItem","ViewErrors","errors","context","breakpointColumnsObj","default","3500","3100","2700","2300","1900","1500","1100","700","500","ViewTeams","memberShips","minWidth","breakpointCols","columnClassName","team","webUrl","part2","part4","part5","threadId","tenantId","conversationsHref","xdisplay","channel","clientId","directoryId","scopes","logo","defaultTableAPI","options","components","header","borderBottom","App","upnIs","showTabFeature","titlegraphics","setTitlegraphics","setFilter","tiles","setTiles","isZoomed","setIsZoomed","currentTile","setCurrentTile","ztickyFolder","myTools","ztickyRef","setZtickyRef","setErrors","setMemberships","refreshing","setRefresing","progress","setProgress","showTable","showFilterOptions","tableUrl","setTableUrl","currentPivot","selectedGroup","setGroups","inFrame","window","self","top","inIframe","initGraph","refresh","removeItem","queueCount","cachedMemberships","matchFilter","subTitle","search","s1","s2","s3","decodeURIComponent","getSearchParametersFromHRef","location","ztickyref","config","tableId","grid","groupRefs","row","cell","groupSetting","members","refs","ga","keys","sortBy","sortKey","toLower","correlation","readGrid","defaultTableKey","filteredTiles","filteredMyTools","filteredMemberShips","URL","folder","matchTeam","paddingRight","position","ProgressIndicator","xlabel","bottom","right","zIndex","marginRight","TextField","autoFocus","disabled","onChange","newValue","placeholder","iconProps","iconName","Pivot","selectedKey","onLinkClick","pivot","PivotItem","headerText","itemCount","r","amplitude","getInstance","identify","logEvent","borderLeft","borderTop","float","label","initializeIcons","GETACCESSTOKEN","RESTOREURL","GETGRAPHUSER","LOGIN","ACCESSTOKEN","ACCESSEXPIRES","authenticate","callBackNotifyIfInteractionIsRequired","redirect_uri","hostname","protocol","port","client_id","scope","seq","getSearchParametersFromHash","search2","id_token","access_token","login","exp","expiresIn","moment","diff","isAccessTokenExpired","handled","alert","error_description","Axios","expires","add","expires_in","toISOString","reload","document","getElementById","innerHTML","ReactDOM","render","start"],"mappings":"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","file":"static/js/main.7e70bd16.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,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\"","import React from \"react\";\nimport _ from \"lodash\";\nimport { Responsive, WidthProvider } from \"react-grid-layout\";\nimport \"./Toolbox.css\";\nconst ResponsiveReactGridLayout = WidthProvider(Responsive);\n\nclass ToolBoxItem extends React.Component {\n  render() {\n    return (\n      <div\n        className=\"toolbox__items__item\"\n        onClick={this.props.onTakeItem.bind(undefined, this.props.item)}\n      >\n        {this.props.item.i}\n      </div>\n    );\n  }\n}\nclass ToolBox extends React.Component {\n  render() {\n    return (\n      <div className=\"toolbox\">\n        <span className=\"toolbox__title\">Toolbox</span>\n        <div className=\"toolbox__items\">\n          {this.props.items.map(item => (\n            <ToolBoxItem\n              key={item.i}\n              item={item}\n              onTakeItem={this.props.onTakeItem}\n            />\n          ))}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default class ToolboxLayout extends React.Component {\n  static defaultProps = {\n    className: \"layout\",\n    rowHeight: 30,\n    onLayoutChange: function() {},\n    cols: { lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 },\n    initialLayout: generateLayout()\n  };\n\n  constructor(props) {\n    super(props);\n    \n    this.state = {\n      currentBreakpoint: \"lg\",\n      compactType: \"vertical\",\n      mounted: false,\n      layouts: props.layouts ? props.layouts : {\n        lg: props.tools\n          ? props.tools.map((tool, ix) => {\n              return {\n                x: 0,\n                y: ix,\n                w:3,\n                h:3,\n               \n                i: ix.toString(),\n\n                static: 0 //Math.random() < 0.05,\n              };\n            })\n          : props.initialLayout\n      },\n      toolbox: { lg: [] }\n    };\n  }\n\n  componentDidMount() {\n    this.setState({ mounted: true });\n  }\n\n  generateDOM() {\n    var that = this;\n    return _.map(this.state.layouts[this.state.currentBreakpoint], l => {\n      var tile = that.props.tools && that.props.tools[l.i] &&  that.props.tools[l.i].tile?   that.props.tools[l.i].tile : {title:l.i};\n      return (\n        <div  style={{backgroundColor:tile.color,color:tile.textcolor,cursor:!this.props.editingLayout ? \"pointer\" :\"default\"}}  \n        onClick={()=>{if (this.props.onTileClick &&  !this.props.editingLayout){this.props.onTileClick(tile)}}}\n        key={l.i} className={l.static ? \"static\" : \"\"}>\n          \n              <img src={tile.icon} style={{height:\"100%\",maxHeight:\"128px\",width:\"auto\",padding:\"8px\"}}></img>\n            <span className=\"text\">{tile.title } </span>\n          \n        </div>\n      );\n    });\n  }\n\n  \n \n  onBreakpointChange = breakpoint => {\n    this.setState(prevState => ({\n      currentBreakpoint: breakpoint,\n      toolbox: {\n        ...prevState.toolbox,\n        [breakpoint]:\n          prevState.toolbox[breakpoint] ||\n          prevState.toolbox[prevState.currentBreakpoint] ||\n          []\n      }\n    }));\n  };\n\n  onCompactTypeChange = () => {\n    const { compactType: oldCompactType } = this.state;\n    const compactType =\n      oldCompactType === \"horizontal\"\n        ? \"vertical\"\n        : oldCompactType === \"vertical\"\n        ? null\n        : \"horizontal\";\n    this.setState({ compactType });\n  };\n\n  onTakeItem = item => {\n    this.setState(prevState => ({\n      toolbox: {\n        ...prevState.toolbox,\n        [prevState.currentBreakpoint]: prevState.toolbox[\n          prevState.currentBreakpoint\n        ].filter(({ i }) => i !== item.i)\n      },\n      layouts: {\n        ...prevState.layouts,\n        [prevState.currentBreakpoint]: [\n          ...prevState.layouts[prevState.currentBreakpoint],\n          item\n        ]\n      }\n    }));\n  };\n\n  onPutItem = item => {\n    this.setState(prevState => {\n      return {\n        toolbox: {\n          ...prevState.toolbox,\n          [prevState.currentBreakpoint]: [\n            ...(prevState.toolbox[prevState.currentBreakpoint] || []),\n            item\n          ]\n        },\n        layouts: {\n          ...prevState.layouts,\n          [prevState.currentBreakpoint]: prevState.layouts[\n            prevState.currentBreakpoint\n          ].filter(({ i }) => i !== item.i)\n        }\n      };\n    });\n  };\n\n  onLayoutChange = (layout, layouts) => {\n    saveToLS(\"layouts\", layouts);\n    \n    if (this.props.persist){\n        this.props.persist(layouts)\n    }\n    this.setState({ layouts });\n  };\n\n  onNewLayout = () => {\n    this.setState({\n      layouts: { lg: generateLayout() }\n    });\n  };\n\n  render() {\n    return (\n      <div>\n        \n        {/* <div>\n          Current Breakpoint: {this.state.currentBreakpoint} (\n          {this.props.cols[this.state.currentBreakpoint]} columns)\n        </div>\n        <div>\n          Compaction type:{\" \"}\n          {_.capitalize(this.state.compactType) || \"No Compaction\"}\n        </div>\n        <button onClick={this.onNewLayout}>Generate New Layout</button>\n        <button onClick={this.onCompactTypeChange}>\n          Change Compaction Type\n        </button>\n\n        <ToolBox\n          items={this.state.toolbox[this.state.currentBreakpoint] || []}\n          onTakeItem={this.onTakeItem}\n        /> */}\n\n        <ResponsiveReactGridLayout\n\n          {...this.props}\n          isDraggable={this.editingLayout}\n          layouts={this.state.layouts}\n          onBreakpointChange={this.onBreakpointChange}\n          onLayoutChange={this.onLayoutChange}\n          // WidthProvider option\n          measureBeforeMount={false}\n          // I like to have it animate on mount. If you don't, delete `useCSSTransforms` (it's default `true`)\n          // and set `measureBeforeMount={true}`.\n          useCSSTransforms={this.state.mounted}\n          compactType={this.state.compactType}\n          preventCollision={!this.state.compactType}\n        >\n          {this.generateDOM()}\n        </ResponsiveReactGridLayout>\n      </div>\n    );\n  }\n}\n\nfunction getFromLS(key) {\n    let ls = {};\n    if (global.localStorage) {\n      try {\n        ls = JSON.parse(global.localStorage.getItem(\"rgl-8\")) || {};\n      } catch (e) {\n        /*Ignore*/\n      }\n    }\n    return ls[key];\n  }\n  \n  function saveToLS(key, value) {\n    if (global.localStorage) {\n      global.localStorage.setItem(\n        \"rgl-8\",\n        JSON.stringify({\n          [key]: value\n        })\n      );\n    }\n  }\nfunction generateLayout() {\n    return _.map(_.range(0, 25), function(item, i) {\n      var y = Math.ceil(Math.random() * 4) + 1;\n      return {\n        x: (_.random(0, 5) * 2) % 12,\n        y: Math.floor(i / 6) * y,\n        w: 2,\n        h: y,\n        i: i.toString(),\n        static: Math.random() < 0.05\n      };\n    });\n  }\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Tags = props => {\n  if (props && props.references) {\n    return (<div className=\"tags\" style={{ display: \"flex\",flexWrap:\"wrap\" }}>\n      {props.references.map((group,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", backgroundColor: group.color, color: group.textColor }}>\n          {group.title}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nTags.propTypes = {\n  references: PropTypes.array\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Highlight = props => {\n  \nif (!props.text) return null\nif (!props.filter) return  props.text\n\n    var ix = props.text.toLowerCase().indexOf(props.filter.toLowerCase())\n   if (ix===-1){\n     return props.text\n   }\n\n   \n   var first = props.text.substr(0,ix)\n   var middle = props.text.substr(ix,props.filter.length)\n   var last = props.text.substr(ix+props.filter.length)\n  return (\n    <>\n   \n      <span>{first}</span>\n      <span style={props.style}>{middle}</span>\n       <span>{last}</span>\n    \n    </>\n  );\n};\nHighlight.propTypes = {\n  style: PropTypes.object,\n\n  filter: PropTypes.string,\n  text: PropTypes.string\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nimport { Highlight } from \"./Highlight\";\nimport  \"./tile.css\"\nexport const AppSuperTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n\n  return (<>\n\n  {props.tileSize===1 &&\n    <div className=\"supertile\" style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n     <div  style={{\n       \n       margin: 10,\n       padding: 10,\n       backgroundColor: tile.color,\n       color: tile.textcolor,\n       width: 300,\n       height: 70,\n       maxHeight: 70,\n       borderRadius:35,\n       overflow: \"hide\"\n       \n     }}>\n       <div style={{ cursor: \"pointer\" }} onClick={() => {\n         if (props.onClick){\n           props.onClick(tile);\n                }\n   \n       }}>\n         <div style={{display:\"flex\"}}>\n           \n         <div style={{  margin: 8, marginTop:8, height: 40 }}>\n           <img style={{ height: \"auto\", width: 40 }} src={tile.icon} />\n         </div>\n           <div title={tile.title} style={{flexGrow:1,height:\"40px\",width:\"300px\", overflow:\"hidden\",lineHeight:\"40px\",marginTop:\"6px\",marginLeft:\"4px\", fontSize:\"24px\"}}>\n           <Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> \n           </div>\n          \n         <div style={{alignItems:\"flex-end\"}}>\n         <i\n                   style={{cursor:\"pointer\",display:\"none\"}}\n                     class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                     onClick={(e) => {\n                       if (props.onPinnedClicked){\n                         e.preventDefault()\n                         e.stopPropagation()\n                         props.onPinnedClicked(props)\n                       }\n                       \n                     }}\n                     aria-hidden=\"true\"\n                   ></i> \n         </div> </div>\n       \n         {/* <Tags references={tile.references} /> */}\n   \n       </div>\n     </div>\n     \n\n     </div>\n  }\n  {props.tileSize === 0 &&\n  <div style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n  <div style={{\n    margin: 10,\n    padding: 10,\n    backgroundColor: tile.color,\n    color: tile.textcolor,\n    width: 300,\n    height: 300,\n    maxHeight: 300,\n    overflow: \"auto\"\n  }}>\n    <div style={{ cursor: \"pointer\" }} onClick={() => {\n      if (props.onClick){\n        props.onClick(tile);\n             }\n\n    }}>\n      <div style={{display:\"flex\"}}><div style={{flexGrow:1}}><Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> </div>\n      <div style={{alignItems:\"flex-end\"}}>\n      <i\n                style={{cursor:\"pointer\",display:\"none\"}}\n                  class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                  onClick={(e) => {\n                    if (props.onPinnedClicked){\n                      e.preventDefault()\n                      e.stopPropagation()\n                      props.onPinnedClicked(props)\n                    }\n                    \n                  }}\n                  aria-hidden=\"true\"\n                ></i> \n      </div>\n      </div>\n      \n      <div style={{ textAlign: \"center\", margin: 20, marginTop:40, height: 120 }}>\n        <img style={{ height: \"auto\", width: 112 }} src={tile.icon} />\n      </div>\n\n      <div style={{ maxHeight: 60, height: 60, overflow: \"auto\" }}>\n    \n\n        {tile.inShort}\n      </div>\n       <Tags references={tile.references} /> \n\n    </div>\n  </div>\n  \n  <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} rel=\"noopener noreferrer\"  target=\"_blank\">\n          Jump to\n            </a>)} */}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} rel=\"noopener noreferrer\"  target=\"_blank\">\n           More info\n            </a>)}\n      </div>\n  </div>\n  }\n  </>);\n};\nAppSuperTile.propTypes = {\n  tile: PropTypes.object,\n  onClose: PropTypes.func,\n  filter : PropTypes.string,\n  highlightStyle : PropTypes.object,\n  isPinned : PropTypes.bool,\n  onPinnedClicked:PropTypes.func,\n  tileSize:PropTypes.number\n};\n","import React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { QuillDeltaToHtmlConverter } from \"quill-delta-to-html\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nexport const AppFullSizeTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    if (tile.contentRef) {\n      axios\n        .get(tile.contentRef)\n        .then(result => {\n          var converter = new QuillDeltaToHtmlConverter(result.data.ops);\n          setHtml(converter.convert());\n        })\n        .catch(error => {\n          if (error.response.status !== 404) {\n            setError(error.message);\n          }\n        });\n    }\n  });\n  return (<>\n    {error && <div>{error}</div>}\n    <div onClick={props.onClose} style={{\n      backgroundColor: tile.color,\n      color: tile.textcolor,\n      height: \"80px\",\n      borderRadius:\"40px\",\n      \n      overflow: \"auto\"\n    }}>\n      <div>\n        <div style={{ display: \"flex\" }}>\n          <div >\n            {\" \"}\n            <img style={{ margin: \"10px\", marginLeft:\"20px\", height: \"60px\", width: \"auto\" }} src={tile.icon} />\n          </div>\n          <div style={{ \n          width: \"auto\" }}>\n            <div className=\"fullSizeHeading\" style={{\n              padding: \"10px\",\n              marginTop:\"20px\",\n              fontSize: \"48px\",\n              textOverflow: \"nowrap\",\n              whiteSpace: \"no-wrap\"\n            }}>\n              {tile.title}\n            </div>\n            <div className=\"fullSizeDescription\" style={{ paddingLeft: \"3vh\", fontSize: \"3vh\" }}>\n          \n              {tile.inShort}\n            </div>\n          </div>\n        </div>\n\n\n        {/* <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n          {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} target=\"_blank\">\n           Launch\n              </a>)}\n          {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} target=\"_blank\">\n            Details\n              </a>)}\n        </div> */}\n      </div>\n\n    </div>\n    <div style={{\n          margin : \"20px\",\n          xheight: \"80vh\",\n         \n          overflow: \"auto\",\n          backgroundColor: \"#ffffff\",\n          color: \"#000000\",\n          padding: \"20px\"\n        }}>\n          <div style={{fontSize:\"22px\",lineHeight:\"24px\"}}>\n            {tile.messageBeforeLaunch}\n<div style={{marginTop:\"20px\"}}>\n            {/* <textarea style={{width:\"100%\",height:\"30px\"}}>{tile.jumpto}</textarea> */}\n            <div>\n\n<a href={tile.jumpto}>{tile.jumpto}</a>\n\n            </div>\n            </div>\n            </div>\n            <div>\n\n    \n            </div>\n          <Tags references={tile.references} />\n          <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} target=\"_blank\">\n        Launch\n            </a>)} */}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} target=\"_blank\">\n          Details\n            </a>)}\n      </div>\n          <div dangerouslySetInnerHTML={{ __html: html }}></div>\n        </div>\n  </>);\n};\nAppFullSizeTile.propTypes = {\n  tile: Object,\n  onClick: PropTypes.func\n};\n","import json from \"format-json\"\nimport  _ from \"lodash\"\nimport   request from \"request\"\n\n\nexport var graph = {};\n\nfunction extractEmails(text) {\n  return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\n}\n\ngraph.analyseMembers = (token, emailAddresses, cb) => {\n  var addresses = [];\n\n  var ar1 = emailAddresses.split(\"\\n\");\n  ar1.forEach((element1) => {\n    var ar2 = element1.split(\";\");\n    ar2.forEach((element2) => {\n      var smptAddresses = extractEmails(element2);\n      smptAddresses.forEach((smtp) => {\n        addresses.push({\n          checked: false,\n          smtp,\n        });\n      });\n    });\n  });\n\n  var results = [];\n  var x = addresses.length;\n  addresses.forEach((address) => {\n    graph.readUser(token, address.smtp, 0, (err, user) => {\n      x--;\n      address.user = user;\n      address.err = err;\n      results.push(address);\n      if (x < 1) {\n        cb(null, results);\n        address.checked = true;\n      }\n    });\n  });\n};\ngraph.invite = (token, emailAddress, invitationRedirectUrl, cb) => {\n  var msg = {\n    invitedUserEmailAddress: emailAddress,\n    inviteRedirectUrl: invitationRedirectUrl,\n    invitedUserDisplayName: emailAddress,\n    sendInvitationMessage: false,\n    invitedUserMessageInfo: {\n      customizedMessageBody:\n        \"We are really happy to invite you to the JUMPTO365 #Insider program \",\n      ccRecipients: [\n        {\n          emailAddress: {\n            name: \"Niels\",\n            address: \"niels@jumpto365.com\",\n          },\n        },\n      ],\n    },\n  };\n  post(token, `https://graph.microsoft.com/v1.0/invitations`, msg, function (\n    err,\n    response\n  ) {\n    if (err) {\n      return cb(err);\n    }\n    cb(null, response);\n  });\n};\ngraph.addcrm = (token, emailAddress, first, last, tag, cb) => {\n  var msg = {\n    properties: [\n      {\n        property: \"firstname\",\n        value: first,\n      },\n      {\n        property: \"lastname\",\n        value: last,\n      },\n      {\n        property: \"internal_categories\",\n        value: tag,\n      },\n      // {\n      //   \"property\": \"phone\",\n      //   \"value\": \"@{body('Signin')['mobilePhone']}\"\n      // },\n      // {\n      //   \"property\": \"jobtitle\",\n      //   \"value\": \"@{body('Signin')['jobTitle']}\"\n      // },\n      // {\n      //   \"property\": \"country\",\n      //   \"value\": \"@{body('Signin')['country']}\"\n      // }\n    ],\n  };\n\n  post2(\n    token,\n    `https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/${emailAddress}/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null, response);\n    }\n  );\n};\ngraph.addmember = (token, userId, groupId, cb) => {\n  var msg = {\n    \"@odata.id\": `https://graph.microsoft.com/beta/directoryObjects/${userId}`,\n  };\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/members/$ref`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null);\n    }\n  );\n};\n\ngraph.getSharePointList = (\n  token,\n  host,\n  site,\n  list,\n  listfilter,\n  itemfilter,\n  cb\n) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items?${listfilter}`,\n    function (e, items) {\n      if (e) return cb(e);\n      var itemList = [];\n\n      function next() {\n        if (items.length === 0) return cb(null, itemList);\n        var item = items.pop();\n\n        get(\n          token,\n          `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items/${item.id}?${itemfilter}`,\n          function (e, item) {\n            if (e) return cb(e);\n            itemList.push(item);\n            next();\n          }\n        );\n      }\n\n      next();\n    }\n  );\n};\n\ngraph.getPages = (token, host, site, cb) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}`,\n    function (e, site) {\n      if (e) return cb(e);\n\n      get(\n        token,\n        `https://graph.microsoft.com/beta/sites/${site.id}/pages`,\n        function (e, items) {\n          if (e) return cb(e);\n\n          return cb(null, items);\n        }\n      );\n    }\n  );\n};\ngraph.readGroupMembers = function (token, groupId, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/beta/groups/\" +\n      groupId +\n      \"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id\",\n    cb\n  );\n};\n\ngraph.readGroupMemberShipFor = function (token, upn, cb) {\n  get(token, \"https://graph.microsoft.com/v1.0/users/\" + upn + \"/memberOf\", cb);\n};\n\ngraph.readManager = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName + \"/manager\",\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.matchingGroups = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'${searchText}')`,\n    cb\n  );\n};\n\ngraph.findGroup = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '${searchText}'`,\n    cb\n  );\n};\n\ngraph.getGroupDocuments = function (token, groupId, folderName, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root:${folderName}:/children`,\n    cb\n  );\n};\n\ngraph.getGroupDrive = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive`, cb);\n};\ngraph.getGroupSite = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/sites/root`,\n    cb\n  );\n};\n\ngraph.getDriveChildren = function (token, driveId, itemId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/drives/${driveId}/items/${itemId}/children`,\n    cb\n  );\n};\n\ngraph.getGroupRootFolders = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteDrive = function (token, id, path, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${id}/drive/root:/${path}:/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.copyfile = function (\n  token,\n  groupNickName,\n  fromFolder,\n  fromName,\n  toFolder,\n  toName,\n  cb\n) {\n  graph.findGroup(token, groupNickName, function (err, groups) {\n    if (err) return cb(err);\n    if (groups.length !== 1) return cb(\"Did't find a unique group\");\n    var group = groups[0];\n    graph.getGroupDocuments(token, group.id, \"/\" + fromFolder, function (\n      err,\n      fromItems\n    ) {\n      if (err) return cb(err);\n      var match = _.find(fromItems, { name: fromName });\n      graph.getGroupRootFolders(token, group.id, function (err, targetFolders) {\n        if (err) return cb(err);\n        var destFolder = _.find(targetFolders, { name: toFolder });\n        if (!destFolder) return cb(\"Did't find target folder\");\n        graph.newDoc(\n          token,\n          group.id,\n          match.id,\n          destFolder.parentReference.driveId,\n          destFolder.id,\n          toName,\n          function (err, result) {\n            if (err) return cb(err);\n            return cb(null, result);\n          }\n        );\n      });\n    });\n  });\n};\n\nfunction lookupFile(token, driveId, id, name, iterations, cb) {\n  // Content have been copied\n  graph.getDriveChildren(token, driveId, id, function (err, result) {\n    if (err) {\n      return cb(err);\n    }\n    // content of destination folder\n\n    for (let index = 0; index < result.length; index++) {\n      const file = result[index];\n\n      console.log(\"Comparing\", file.name, name);\n      if (file.name === name) {\n        // match found\n        console.log(\"Match found\");\n        return cb(null, file);\n      }\n    }\n\n    var iteration = 0;\n    function retry() {\n      console.log(\"Retrying\", iterations);\n      //\n      if (iteration > 10) {\n        return cb(\n          `Think that the file has been created, but could not find a reference to if. Filename is ${name} - Tryed ${iterations} to find it `\n        );\n      }\n      lookupFile(token, driveId, id, name, iterations + 1, cb);\n    }\n    // no match found so we will wait a second a try again\n    setTimeout(retry, 1000);\n  });\n}\n\ngraph.newDoc = function (token, sourceGroupId, itemId, driveId, id, name, cb) {\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${sourceGroupId}/drive/items/${itemId}/copy`,\n    {\n      parentReference: {\n        driveId: driveId,\n        id: id,\n      },\n      name: name,\n    },\n    function (err) {\n      // no result from that call - by design from Microsoft\n      if (err) {\n        return cb(err);\n      }\n\n      // so we fill try to find a referece our self\n      lookupFile(token, driveId, id, name, 0, cb);\n    }\n  );\n};\nexport const graphWithPromise = {};\ngraphWithPromise.me = (token) => {\n  return new Promise((resolve, reject) => {\n    get(\n      token,\n      \"https://graph.microsoft.com/v1.0/me/\",\n      (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      },\n      null\n    );\n  });\n};\n\nclass Client {\n  constructor() {\n    this.token = auth.getAccessToken();\n  }\n  get = (url) => {\n    return new Promise((resolve, reject) => {\n      get(this.token, url, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  getRaw = (url) => {\n    return getRaw(this.token, url);\n  };\n  getImage = (url) => {\n    return getImage(this.token, url);\n  };\n}\n\nfunction imageToBase64(blob) {\n  return new Promise((resolve, reject) => {\n    try {\n      var reader = new FileReader();\n\n      reader.onload = function () {\n        debugger;\n        var blobAsDataUrl = reader.result;\n\n        resolve(blobAsDataUrl);\n      };\n\n      reader.readAsDataURL(new Blob([blob]));\n    } catch (error) {\n      debugger;\n      resolve(null);\n    }\n  });\n}\nexport const teamMemberships = () => {\n  var client = new Client();\n  return new Promise(async (resolve, reject) => {\n    try {\n      var memberships = await client\n        .get(\"https://graph.microsoft.com/v1.0/me/joinedTeams\")\n        .catch((error) => reject(error));\n      var pending = 0;\n      var groups = [];\n\n      if (!memberships) return reject(\"Not able to read membership\");\n      //memberships = [memberships[0]];\n      memberships.map(async (value) => {\n        pending++;\n        var photo = await client\n          .getImage(\n            `https://graph.microsoft.com/v1.0/groups/${value.id}/photo/$value`\n          )\n          .catch((error) => {\n            debugger;\n            console.log(\"Photo read error\");\n          });\n\n        var details = await client\n          .get(`https://graph.microsoft.com/v1.0/teams/${value.id}`)\n          .catch((error) => console.log(\"Team details read error\"));\n\n        var channels = await client\n          .get(`https://graph.microsoft.com/beta/teams/${value.id}/channels`)\n          .catch((error) => console.log(\"Channel read error\"));\n\n        groups.push({\n          key: value.id,\n          text: value.displayName,\n          title: value.description,\n\n          data: {\n            details,\n            photo,\n            channels: channels,\n          },\n        });\n\n        pending--;\n        if (pending === 0) {\n          debugger;\n          return resolve(\n            groups.sort((a, b) => {\n              if (a.text < b.text) {\n                return -1;\n              }\n              if (a.text > b.text) {\n                return 1;\n              }\n              return 0;\n            })\n          );\n        }\n      });\n    } catch (error) {\n      debugger;\n      reject(error);\n    }\n  }, null);\n};\n\n\nexport var auth = {};\n\nauth.getAccessToken = function () {\n  return sessionStorage.getItem(\"access_token\");\n};\n\nfunction post2(token, url, body, cb) {\n  request.post(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n      },\n      body: JSON.stringify(body),\n    },\n    function (err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        return cb(err);\n      } else {\n        parsedBody = body === \"\" ? {} : JSON.parse(body);\n        if (parsedBody.error) {\n          return cb(parsedBody.error);\n        } else {\n          cb(null, parsedBody);\n        }\n      }\n    }\n  );\n}\n\nfunction post(token, url, body, cb) {\n  request.post(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n      body: JSON.stringify(body),\n    },\n    function (err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        return cb(err);\n      } else {\n        parsedBody = body === \"\" ? {} : JSON.parse(body);\n        if (parsedBody.error) {\n          return cb(parsedBody.error);\n        } else {\n          cb(null, parsedBody);\n        }\n      }\n    }\n  );\n}\nexport function getRaw(token, url) {\n  console.log(\"getting\", url);\n\n  return new Promise((resolve, reject) => {\n    request.get(\n      {\n        url: url,\n        headers: {\n          authorization: \"Bearer \" + token,\n        },\n      },\n      function (err, response, body) {\n        if (err) {\n          return reject(err);\n        }\n        resolve({ body, response });\n      }\n    );\n  });\n}\n\nfunction getImage(token, url) {\n  return new Promise((resolve, reject) => {\n    try {\n      var xhr = new XMLHttpRequest();\n\n      xhr.onload = function () {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(xhr.response);\n      };\n  \n      xhr.open(\"GET\", url);\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\n      xhr.responseType = \"blob\";\n      xhr.send();\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nexport function get(token, url, cb, appendTo, index, retrycount) {\n  console.log(\"getting\", url, appendTo === true);\n  request.get(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    },\n    function (err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        var errCounter = retrycount ? retrycount + 1 : 1;\n        if (errCounter > 3) {\n          return cb(err, null, index);\n        } else {\n          // retry\n          console.log(\"retry #\", errCounter);\n          return get(token, url, cb, appendTo, index, errCounter);\n        }\n      }\n\n      parsedBody = JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(parsedBody.error, null, index);\n      }\n\n      if (parsedBody[\"@odata.nextLink\"]) {\n        var data;\n        if (!appendTo) {\n          data = parsedBody.value;\n        } else {\n          data = appendTo.concat(parsedBody.value);\n        }\n\n        return get(token, parsedBody[\"@odata.nextLink\"], cb, data, index);\n      }\n\n      if (appendTo) {\n        cb(null, appendTo.concat(parsedBody.value), index);\n      } else {\n        if (parsedBody.value) {\n          cb(null, parsedBody.value, index);\n        } else {\n          cb(null, parsedBody, index);\n        }\n      }\n    }\n  );\n}\n\n\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const ViewErrors = props => {\n  if (props && props.errors) {\n    return (<div className=\"tags\" >\n      {props.errors.map((error,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", }}>\n          When trying {error.context}, you got \n          {JSON.stringify(error)}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nViewErrors.propTypes = {\n  errors: PropTypes.array\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Highlight } from \"./Highlight\";\nimport Masonry from 'react-masonry-css'\nimport \"./masonry.css\"\nconst breakpointColumnsObj = {\n  default: 10,\n  \n  3500: 9,\n\n  3100: 8,\n\n  2700: 7,\n  2300: 6,\n  1900: 5,\n  1500: 4,\n  1100: 3,\n  700: 2,\n  500: 1\n};\nexport const ViewTeams = (props) => {\n  if (props && props.memberShips) {\n    return (\n\n      \n      <div\n        className=\"tags\"\n        style={{\n          padding: \"4px\",\n          margin: \"4px\",\n          fontSize: \"16px\",\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          minWidth:\"300px\"\n        }}\n      >\n        <Masonry\n  breakpointCols={breakpointColumnsObj}\n  className=\"my-masonry-grid\"\n  columnClassName=\"my-masonry-grid_column\">\n  {/* array of JSX items */}\n\n        {props.memberShips.map((team, key) => {\n          var href =\n            team.data && team.data.details ? team.data.details.webUrl : \"\";\n\n          if (href) {\n            var part1 = href.split(\"https://teams.microsoft.com/l/team/\");\n            var part2 = part1[1].split(\"/conversations?\");\n            var part3 = href.split(\"groupId=\");\n            var part4 = part3[1].split(\"&\");\n            var part5 = href.split(\"tenantId=\");\n\n            var threadId = part2[0];\n            var groupId = part4[0];\n            var tenantId = part5[1];\n\n            var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n            var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n          }\n          var details =\n            team.data && team.data.details\n              ? team.data.details\n              : { displayName: team.title };\n\n          var photo = team.data ? team.data.photo : null;\n\n          var channels =\n            team.data && team.data.channels ? team.data.channels : [];\n          return (\n            <div\n              key={key}\n              style={{\n                padding: \"10px\",\n                margin: \"10px\",\n                fontSize: \"16px\",\n                xdisplay: \"flex\",\n                border: \"1px solid #dddddd\",\n                minWidth: \"290px\",\n                maxWidth: \"290px\",\n              }}\n            >\n                    <a\n\n                    className=\"TeamLink\"\n                    \n                    href={conversationsHref}\n                    rel=\"noopener noreferrer\"\n                    target=\"_blank\"\n                  >\n                    \n              <div style={{display:\"xlex\"}}> \n              <div style={{ minWidth: \"276px\" }}>\n                {photo && (\n                  <img\n                    src={photo}\n                    style={{ height: \"256px\", width:\"256px\",margin: \"10px\" }}\n                  ></img>\n                )}\n              </div>\n\n              <div style={{ minWidth: \"280px\" }}>\n                <div\n                  className=\"ms-font-xxl\"\n                  style={{ padding: \"8px\", lineHeight: \"32px\" }}\n                >\n                  <Highlight\n                    text={details.displayName}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n                \n                </div>\n                <div\n                  style={{\n                    padding: \"8px\",\n                    margin: \"4px\",\n                    fontSize: \"14px\",\n                    xdisplay: \"flex\",\n                    flexWrap: \"wrap\",\n                  }}\n                >\n\n                </div>\n              </div>\n              <div style={{\n                    padding: \"8px\",\n                    margin: \"4px\",\n                    fontSize: \"14px\",\n                    \n                  }}>\n\n              {details.description}\n              </div>\n             \n             \n              <ul>\n                  {channels.map((channel, key) => {\n                    if (channel.displayName === \"General\"){\n                      return null\n                    }\n                    return (\n                      <li key={key} style={{ padding: \"3px\" }}>\n                        <div>\n                          <Highlight\n                            text={channel.displayName}\n                            filter={props.filter}\n                            style={props.highlightStyle}\n                          />\n                        </div>\n                        {channel.description && (\n                          <div>(\n                            \n                            <Highlight\n                            text={channel.description}\n                            filter={props.filter}\n                            style={props.highlightStyle}\n                          />\n                            )</div>\n                        )}\n                      </li>\n                    );\n                  })}\n                  </ul>\n                  <div>\n            \n                \n                  {/* <a\n                    style={{ padding: \"8px\" }}\n                    href={filesHref}\n                    rel=\"noopener noreferrer\"\n                    target=\"_blank\"\n                  >\n                    General Files\n                  </a> */}\n                </div>\n                </a>\n            </div>\n          );\n        })}\n        </Masonry >\n      </div>\n    );\n  } else {\n    return null;\n  }\n};\nViewTeams.propTypes = {\n  memberShips: PropTypes.array,\n  filter: PropTypes.string,\n  highlightStyle: PropTypes.object,\n};\n","import React from \"react\";\nimport logo from \"./default/Logo.png\";\nimport {\n  Dropdown,\n  DropdownMenuItemType,\n  IDropdownStyles,\n  IDropdownOption\n} from \"office-ui-fabric-react/lib/Dropdown\";\n\nexport default {\n  clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\n  directoryId: \"common\",\n  scopes: \"user.readwrite.all group.readwrite.all\",\n  title: \"Tools\",\n  logo,\n  defaultTableAPI : \"https://api.jumpto365.com/table/hexatown.com/PTO365\",\n  options: [\n      ],\n  components: {\n    header: (\n      <div style={{ borderBottom: \"1px solid #cccccc\" }}>\n        <div style={{ display: \"flex\", margin: \"20px\" }}>\n          <div style={{flexGrow:1}}><a href=\"https://jumpto365.com\" target=\"_blank\">\n            <img style={{ height: \"32px\", padding: \"4px\" }} src={logo} /></a>\n          </div>\n          <div\n            style={{\n              \n              marginLeft: \"16px\",\n              fontSize: \"18px\",\n              lineHeight: \"32px\",\n              padding: \"0px\",\n              color:\"333\"\n              \n            }}\n          \n>\n            \n          </div>\n        </div>\n      </div>\n    )\n  }\n};\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\nimport React, { Component, useState, useEffect } from \"react\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport \"./App.css\";\nimport \"./css/normalize.css\";\nimport \"./css/webflow.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\nimport { AppSuperTile } from \"./components/AppSuperTile\";\nimport { AppFullSizeTile } from \"./components/AppFullSizeTile\";\nimport { TextField } from \"office-ui-fabric-react/lib/TextField\";\nimport { initializeIcons } from \"@uifabric/icons\";\n\nimport { teamMemberships } from \"./helpers/OfficeGraph\";\nimport { PivotItem, Pivot } from \"office-ui-fabric-react/lib/Pivot\";\nimport { ViewErrors } from \"./components/ViewErrors\";\nimport { ViewTeams } from \"./components/ViewTeams\";\nimport {\n  DefaultButton,\n  PrimaryButton,\n  Stack,\n  IStackTokens,\n  ShimmerElementsGroup,\n} from \"office-ui-fabric-react\";\nimport {\n  Dropdown,\n  DropdownMenuItemType,\n  IDropdownStyles,\n  IDropdownOption,\n} from \"office-ui-fabric-react/lib/Dropdown\";\nimport { ProgressIndicator } from \"office-ui-fabric-react/lib/ProgressIndicator\";\nimport { Toggle } from \"office-ui-fabric-react/lib/Toggle\";\nimport {\n  CommandBar,\n  ICommandBarItemProps,\n} from \"office-ui-fabric-react/lib/CommandBar\";\n\nimport Animejs from \"animejs\";\nimport \"react-grid-layout/css/styles.css\";\nimport \"react-resizable/css/styles.css\";\nimport GridLayout from \"react-grid-layout\";\nimport ToolboxLayout from \"./components/ToolboxLayout\";\n\nimport config from \"./config\";\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\ninitializeIcons();\n\nexport default function App(props) {\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n  const [showTabFeature, setThowTabFeature] = useState(upnIs(\"ngjoh@nets.eu\"));\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\n  const [filter, setFilter] = useState(\"\");\n  const [tiles, setTiles] = useState([]);\n  const [useAuthentication, setUseAuthentication] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isZoomed, setIsZoomed] = useState(false);\n  const [currentTile, setCurrentTile] = useState(null);\n  const [me, setMe] = useState({});\n  const [ztickyFolder, setZtickyFolder] = useState({});\n  const [myTools, setMyTools] = useState([]);\n  const [ztickyRef, setZtickyRef] = useState(\"\");\n  const [tileSize, setTileSize] = useState(1);\n  const [errors, setErrors] = useState([]);\n  const [memberships, setMemberships] = useState([]);\n  const [siteUrlLabel, setSiteUrlLabel] = useState(\"\");\n  const [siteUrlHref, setSiteUrlHref] = useState(\"\");\n  const [refreshing, setRefresing] = useState(false);\n  const [progress, setProgress] = useState(\"\");\n  const [showTable, setShowTable] = useState(false);\n  const [editingLayout, setEditingLayout] = useState(true);\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\n  const [tableUrl, setTableUrl] = useState(\"\");\n  const [layouts, setLayouts] = useState({});\n  const [currentPivot, setCurrentPivot] = useState(\"pinned\");\n  const [tableApiSelected, setTableApiSelected] = useState(\n    \"https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE\"\n  );\n  const [selectedGroup, setSelectedGroup] = useState(\"\");\n  const [groups, setGroups] = useState([]);\n  const inFrame = inIframe();\n  const addTile = (tile) => {\n    setProgress(\"Adding pin\");\n    //OfficeGraph.addTile(ztickyFolder, tile)\n    //   .then(async (folder) => {\n    //     try {\n    //       // var myTools = await OfficeGraph.getMyTools(ztickyFolder, true);\n    //       myTools.push(folder);\n\n    //       var keys = _.keys(layouts);\n    //       keys.forEach((key) => {\n    //         layouts[key].push({\n    //           x: 0,\n    //           y: Infinity,\n    //           w: 3,\n    //           h: 3,\n\n    //           i: layouts[key].length.toString(),\n\n    //           static: 0, //Math.random() < 0.05,\n    //         });\n    //       });\n    //       setLayouts(layouts);\n\n    //       //\n    //       setMyTools(myTools);\n    //     } catch (error) {\n    //       errors.push({ context: \"AddTile > myTools.push() \", error });\n    //       setErrors(errors);\n    //     }\n    //     // myTools.forEach(tool=>{\n\n    //     // })\n    //     // debugger\n    //   })\n    //   .catch((error) => {\n    //     errors.push({ context: \"OfficeGraph.addTile()\", error });\n    //     setErrors(errors);\n    //   })\n    //   .finally(() => {\n    //     setProgress(\"\");\n    //   });\n    // // db.table('myTiles')\n    // //   .add(tile)\n    // //   .then((id) => {\n    // //     const newList = [...myTiles, Object.assign({}, tile, { id })];\n    // //     setMyTiles(newList)\n    // //   });\n  };\n\n  useEffect(() => {\n    // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\n    if (showTabFeature) initGraph(false);\n  \n    var search = getSearchParametersFromHRef(window.location.href);\n    if (search.ztickyref) {\n      setZtickyRef(search.ztickyref);\n    }\n    var href = search.src ? search.src : config.defaultTableAPI;\n    setTableUrl(config.defaultTableAPI);\n    readGrid(href, config.defaultTableKey);\n  }, []);\n\n  function readGrid(href, tableId) {\n    axios.get(href).then(({ data }) => {\n      setTitlegraphics(data.titlegraphics);\n      var tiles = [];\n      if (data.grid) {\n        var groups = {};\n        var groupRefs = {};\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.groupSetting) {\n              groups[cell.groupSetting.title] = {\n                groupSetting: cell.groupSetting,\n                members: cell.members,\n              };\n              if (cell.members) {\n                cell.members.forEach((id) => {\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\n                  refs.push(cell.groupSetting);\n                  groupRefs[id] = refs;\n                });\n              }\n            }\n          });\n        });\n\n        var g = _.keys(groups);\n        var ga = g.map((name) => {\n          return { title: name, ...groups[name] };\n        });\n\n        setGroups(_.sortBy(ga, [\"title\"]));\n\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.tile && cell.tile.title) {\n              var tile = { ...cell.tile };\n              tile.sortKey = _.toLower(cell.tile.title);\n              tile.tableId = tableId;\n              tile.correlation =\n                href +\n                \"#\" +\n                (tile.key\n                  ? tile.key\n                  : tile.title\n                  ? tile.title.toLowerCase()\n                  : tile.id);\n              var references = groupRefs[cell.id];\n              tile.references = references;\n              tiles.push(tile);\n            }\n          });\n        });\n      }\n      setTiles(_.sortBy(tiles, [\"sortKey\"]));\n    });\n  }\n\n  async function initGraph(refresh) {\n    try {\n      if (refresh) {\n        localStorage.removeItem(\"memberships\");\n        localStorage.removeItem(\"mytools\");\n      }\n      var queueCount = 0;\n\n      setRefresing(true);\n\n      // await OfficeGraph.initStorage();\n\n      var cachedMemberships = localStorage.getItem(\"memberships\");\n      if (cachedMemberships && !refresh) {\n        setMemberships(JSON.parse(cachedMemberships));\n        setRefresing(false);\n      } else {\n        queueCount++;\n\n        teamMemberships()\n          .then((memberships) => {\n            localStorage.setItem(\"memberships\", JSON.stringify(memberships));\n            queueCount--;\n            if (queueCount === 0) setRefresing(false);\n            setMemberships(memberships);\n          })\n          .catch((error) => {\n            debugger;\n            queueCount--;\n            if (queueCount <= 0) setRefresing(false);\n            errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\n            setErrors(errors);\n          });\n      }\n      return;\n      // OfficeGraph.initTileStorage()\n      //   .then(async (ztickyFolder) => {\n      //     setZtickyFolder(ztickyFolder);\n      //     queueCount++;\n\n      //     var [layouts, properties, version] = await OfficeGraph.readLayouts(\n      //       ztickyFolder\n      //     );\n      //     //debugger\n      //     var myTools = [];\n      //     if (version < 0) {\n      //       var tileFolders = await OfficeGraph.getMyTools(\n      //         ztickyFolder,\n      //         refresh\n      //       );\n      //       myTools = tileFolders.map((folder) => {\n      //         return {\n      //           title: folder.tile ? folder.tile.title : folder.name,\n      //           tile: folder.tile,\n      //         };\n      //       });\n      //     } else {\n      //       myTools = properties.tiles.map((tile) => {\n      //         if (!tile) return null;\n\n      //         return { title: tile.title, tile };\n      //       });\n      //     }\n\n      //     queueCount--;\n      //     if (queueCount === 0) setRefresing(false);\n      //     setMyTools(myTools);\n      //     setLayouts(layouts);\n      //   })\n      //   .catch((error) => {\n      //     queueCount--;\n      //     if (queueCount <= 0) setRefresing(false);\n      //     errors.push({ context: \"OfficeGraph.initStorage()\", error });\n      //     setErrors(errors);\n      //   });\n    } catch (error) {\n      errors.push({ context: \"initGraph\", error });\n      setErrors(errors);\n    }\n  }\n\n  function matchFilter(tile) {\n    var match =\n      tile &&\n      tile.title &&\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.inShort &&\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.subTitle &&\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n\n    return match;\n  }\n\n  function matchTeam(team) {\n    var details = team.data && team.data.details ? team.data.details : {};\n    var channels = team.data && team.data.channels ? team.data.channels : [];\n    var match =\n      details.displayName &&\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        details.description &&\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    channels.forEach((channel) => {\n      if (!match) {\n        match =\n          channel.displayName &&\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n      if (!match) {\n        match =\n          channel.description &&\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n    });\n\n    return match;\n  }\n  function persistLayouts(layouts) {\n    // setLayouts(layouts);\n    // var tiles = myTools.map((tool) => {\n    //   return tool.tile;\n    // });\n    // OfficeGraph.writeLayouts(ztickyFolder, layouts, { tiles })\n    //   .then()\n    //   .catch((error) => {\n    //     errors.push({ context: \"  OfficeGraph.writeLayouts()\", error });\n    //     setErrors(errors);\n    //   });\n  }\n\n  var filteredTiles = !filter ? tiles : [];\n  var filteredMyTools = !filter ? myTools : [];\n  var filteredMemberShips = !filter ? memberships : [];\n  var filteredSiteLinks = !filter ? [] : [];\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\n  if (filter) {\n    tiles.forEach((tile) => {\n      if (matchFilter(tile)) {\n        filteredTiles.push(tile);\n      }\n    });\n    myTools.forEach((folder) => {\n      if (matchFilter(folder.tile)) {\n        filteredMyTools.push(folder);\n      }\n    });\n\n    memberships.forEach((team) => {\n      if (matchTeam(team)) {\n        filteredMemberShips.push(team);\n      }\n    });\n  }\n\n  const dropdownStyles = {\n    dropdown: { width: 300 },\n  };\n\n  if (!props || (!props.auth && props.auth.user)) {\n    return (\n      <div>\n        <h1>Sorry - You cannot get in here</h1>\n        {JSON.stringify(\n          props && props.auth && props.auth.error ? props.auth.error : \"\"\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      {!inFrame && config.components.header}\n      {/* <CommandBar\n        // items={_items}\n        // overflowItems={_overflowItems}\n        // overflowButtonProps={overflowProps}\n        farItems={[\n          // {\n          //   key: \"tile\",\n          //   text: \"Grid view\",\n          //   // This needs an ariaLabel since it's icon-only\n          //   ariaLabel: \"Filter view\",\n          //   iconOnly: true,\n          //   iconProps: { iconName: \"Filter\" },\n          //   onClick: () => {\n          //     if (showFilterOptions) {\n          //       setFilter(\"\");\n          //     }\n          //     setShowFilterOptions(!showFilterOptions);\n          //   }\n          // }\n        ]}\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n      /> */}\n      <div style={{ paddingRight: \"20px\", paddingLeft: \"20px\" }}>\n        {\" \"}\n        {progress && (\n          <div\n            style={{\n              backgroundColor: \"white\",\n              width: \"100vw\",\n              position: \"fixed\",\n              top: \"0px\",\n            }}\n          >\n            <ProgressIndicator xlabel=\"Example title\" description={progress} />\n          </div>\n        )}\n        <img\n          style={{\n            display: \"none\",\n            height: \"64px\",\n            margin: \"13px\",\n            position: \"fixed\",\n            bottom: \"0px\",\n            right: \"0px\",\n          }}\n          src={titlegraphics}\n        ></img>\n        {isZoomed && (\n          <div>\n            <AppFullSizeTile\n              tile={currentTile ? currentTile : tiles ? tiles[0] : null}\n              onClose={() => {\n                setIsZoomed(false);\n              }}\n            />\n          </div>\n        )}\n        {!isZoomed && (\n          <div style={{ display: \"flex\" }}>\n            {\" \"}\n            <div\n              style={{\n                display: \"xnone\",\n                paddingRight: \"8px\",\n                position: \"fixed\",\n                bottom: \"0px\",\n                backgroundColor: \"white\",\n              }}\n            >\n              {showTabFeature && (\n                <div>\n                  <a href={ztickyFolder.webUrl} target=\"_blank\">\n                    <i\n                      style={{\n                        cursor: \"pointer\",\n                        padding: \"4px\",\n                        color: \"black\",\n                      }}\n                      class=\"ms-Icon ms-Icon--OpenFolderHorizontal\"\n                      aria-hidden=\"true\"\n                    ></i>{\" \"}\n                  </a>\n                  <i\n                    style={{ cursor: \"pointer\", padding: \"4px\" }}\n                    class=\"ms-Icon ms-Icon--Refresh\"\n                    onClick={() => {\n                      initGraph(true);\n                    }}\n                    aria-hidden=\"true\"\n                  ></i>{\" \"}\n                  {refreshing && <>Loading</>}\n                </div>\n              )}\n            </div>\n            <div\n              style={{\n                position: \"fixed\",\n                right: 0,\n                top: 0,\n                zIndex: 32,\n                marginRight: \"16px\",\n              }}\n            >\n              {/* <div style={{ display: \"flex\" }}>\n                <div style={{ padding: \"8px\", marginTop: \"0px\" }}>\n                  Table view\n                </div>\n                <div style={{ marginTop: \"8px\" }}>\n                  <Toggle\n                    xlabel=\"Show Table\"\n                    checked={showTable}\n                    xonText=\"Table view On\"\n                    xoffText=\"Table view Off\"\n                    onChange={(e, checked) => {\n                      setShowTable(checked);\n                    }}\n                  />\n                </div>\n              </div> */}\n            </div>\n            <div style={{ flexGrow: \"1\" }}>\n              <div\n                style={{\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  marginTop: \"8px\",\n                }}\n              >\n                <div style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}>\n                  <TextField\n                    autoFocus={true}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={filter}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                </div>{\" \"}\n                {/* <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        placeholder=\"Select an area\"\n                        label=\"Area\"\n                        onChanged={(option, index) => {\n                          readGrid(option.key.api, option.key.id);\n                          setTableUrl(option.key.web);\n                          setTableApiSelected(option.key.api);\n                          setSelectedGroup(\"\");\n                          //debugger\n                        }}\n                        xxselectedKey={tableApiSelected} //\"\"\n                        options={config.options}\n                        styles={dropdownStyles}\n                      />\n                    </div>\n                    <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        placeholder=\"Select a group\"\n                        label=\"Group\"\n                        onChanged={(option, index) => {\n                          setSelectedGroup(option.key);\n                        }}\n                        selectedKey={selectedGroup}\n                        options={groups ? groups.map(group => {\n                          return {\n                            key: group.groupSetting.title,\n                            text: group.groupSetting.title\n                          };\n                        }):[]}\n                        styles={dropdownStyles}\n                      />\n                    </div>\n\n                    <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        disabled={showTable}\n                        placeholder=\"Select tile size\"\n                        selectedKey={tileSize}\n                        label=\"View as\"\n                        onChanged={(option, index) => {\n                          setTileSize(option.key);\n                          //debugger\n                        }}\n                        options={[\n                          {\n                            key: 0,\n                            text: \"Tile\"\n                          },\n                          {\n                            key: 1,\n                            text: \"Small\"\n                          }\n                        ]}\n                        styles={dropdownStyles}\n                      />\n                    </div> */}\n              </div>\n\n              {showTabFeature && (\n                <Pivot\n                  style={{ padding: \"0px\" }}\n                  selectedKey={currentPivot}\n                  onLinkClick={(e, pivot, x) => {\n                    // debugger\n                    // setCurrentPivot(pivot.key)\n                  }}\n                >\n                  {/* <PivotItem\n                    key=\"pinned\"\n                    headerText=\"Pinned\"\n                    itemCount={filteredMyTools.length}\n                  />\n                  <PivotItem\n                    headerText=\"Site\"\n                    itemCount={filteredSiteLinks.length}\n                  ></PivotItem> */}\n                  <PivotItem\n                    headerText=\"Teams\"\n                    itemCount={filteredMemberShips.length}\n                  >\n                    {memberships.length > 0 && (\n                      <ViewTeams\n                        memberShips={filteredMemberShips}\n                        filter={filter}\n                        highlightStyle={{ backgroundColor: \"yellow\" }}\n                      />\n                    )}\n                  </PivotItem>\n                  {false && myTools.length > 0 && (\n                    <PivotItem headerText=\"Grid\" key=\"grid\">\n                      <div>\n                        <div style={{ display: \"flex\", marginTop: \"8px\" }}>\n                          <div\n                            style={{ marginLeft: \"16px\", flexGrow: 1 }}\n                          ></div>\n                          <div style={{ marginLeft: \"16px\" }}>\n                            <div style={{ display: \"flex\" }}>\n                              <div style={{ padding: \"8px\" }}>Edit Layout</div>\n                              <div>\n                                <Toggle\n                                  checked={editingLayout}\n                                  style={{ marginTop: \"8px\" }}\n                                  onChange={(e, checked) => {\n                                    setEditingLayout(checked);\n                                  }}\n                                />\n                              </div>\n                            </div>\n                          </div>\n                        </div>\n                        <ToolboxLayout\n                          tools={myTools}\n                          layouts={layouts}\n                          persist={persistLayouts}\n                          editingLayout={editingLayout}\n                          onTileClick={(tile) => {\n                            setCurrentTile(tile);\n                            setIsZoomed(true);\n                          }}\n                        />\n                      </div>\n                    </PivotItem>\n                  )}\n                  {errors.length !== 0 && (\n                    <PivotItem\n                      headerText=\"Developer feedback\"\n                      itemCount={errors.length}\n                    >\n                      <div>\n                        <ViewErrors errors={errors} />\n                      </div>\n                    </PivotItem>\n                  )}\n                </Pivot>\n              )}\n              {filteredMyTools.length > 0 && (\n                <div>\n                  <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                    {filteredMyTools.map((folder, key) => {\n                      var tile = folder.tile\n                        ? folder.tile\n                        : {\n                            title: folder.name,\n                            color: \"#dddddd\",\n                          };\n                      return (\n                        <AppSuperTile\n                          tileSize={tileSize}\n                          isPinned={true}\n                          key={key}\n                          tile={tile}\n                          filter={filter}\n                          highlightStyle={{\n                            backgroundColor: \"yellow\",\n                            color: \"#333\",\n                          }}\n                          onClick={(tile) => {\n                            // addTile(tile)\n\n                            if (!tile.messageBeforeLaunch && tile.jumpto) {\n                              return window.open(tile.jumpto, \"_blank\");\n                            }\n\n                            setCurrentTile(tile);\n                            setIsZoomed(true);\n                          }}\n                        />\n                      );\n                    })}\n                  </div>\n                </div>\n                // </PivotItem>\n              )}\n              {/* {siteUrl && (\n                 \n                    <h3>Which tools do you find good for this site?</h3>\n                    <div>{siteUrl.hostname}</div>\n                    <TextField\n                      label=\"Label\"\n                      placeholder=\"Enter label for this link\"\n                      value={siteUrlLabel}\n                      onChange={(e, value) => {\n                        setSiteUrlLabel(value);\n                      }}\n                    ></TextField>\n                    <TextField\n                      label=\"URL\"\n                      placeholder=\"Enter URL\"\n                      value={siteUrlHref}\n                      onChange={(e, value) => {\n                        setSiteUrlHref(value);\n                      }}\n                    ></TextField>\n                    <PrimaryButton\n                      text=\"Share link\"\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\n                    />\n                  </PivotItem>\n                )} */}\n              {/* <PivotItem\n                  key=\"catalogue\"\n                  headerText=\"Catalogue\"\n                  itemCount={filteredTiles.length}\n                > */}\n              {showTable && (\n                <>\n                  <div style={{ textAlign: \"right\" }}>\n                    <i\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\n                      class=\"ms-Icon ms-Icon--OpenInNewWindow\"\n                      onClick={() => {\n                        window.open(tableUrl, \"_blank\");\n                      }}\n                      aria-hidden=\"true\"\n                    ></i>\n                  </div>\n                  <iframe\n                    style={{\n                      border: \"0\",\n                      height: \"calc(100vh - 150px\",\n                      width: \"95vw\",\n                    }}\n                    src={tableUrl}\n                  ></iframe>\n                </>\n              )}\n\n              {!showTable && (\n                <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                  {filteredTiles.length === 0 && (\n                    <div>\n                      <h2>You can request a link if you miss one</h2>\n                      <h1>\n                        <a href=\"https://christianiabpos.sharepoint.com/sites/intranets-tools#missing-a-link\">\n                          Request a link\n                        </a>\n                      </h1>\n                    </div>\n                  )}\n                  {filteredTiles.map((tile, key) => {\n                    if (selectedGroup) {\n                      var match = false;\n\n                      if (!tile.references) return <></>;\n                      tile.references.forEach((r) => {\n                        if (r.title === selectedGroup) {\n                          match = true;\n                        }\n                      });\n                      if (!match) return <></>;\n                    }\n                    return (\n                      <AppSuperTile\n                        tileSize={tileSize}\n                        key={key}\n                        filter={filter}\n                        highlightStyle={{\n                          backgroundColor: \"yellow\",\n                          color: \"#333\",\n                        }}\n                        tile={tile}\n                        onPinnedClicked={(props) => {\n                          if (props.tile) {\n                            addTile(props.tile);\n                          }\n                        }}\n                        onClick={(tile) => {\n                          if (window.amplitude) {\n                            if (\n                              props &&\n                              props.auth &&\n                              props.auth.user &&\n                              props.auth.user.userPrincipalName\n                            )\n                              window.amplitude\n                                .getInstance()\n                                .identify(props.auth.user.userPrincipalName);\n                            window.amplitude\n                              .getInstance()\n                              .logEvent(\"tool\", tile);\n                          }\n                          if (tile.jumpto && !tile.messageBeforeLaunch) {\n                            return window.open(tile.jumpto, \"_blank\");\n                          }\n                          setCurrentTile(tile);\n                          setIsZoomed(true);\n                        }}\n                      />\n                    );\n                  })}\n                </div>\n              )}\n\n              {/* \n\n              */}\n            </div>\n            {showFilterOptions && (\n              <div\n                style={{\n                  borderLeft: \"1px solid #dddddd\",\n                  borderTop: \"1px solid #dddddd\",\n                  padding: \"8px\",\n                  float: \"right\",\n                  minWidth: \"300px\",\n                }}\n              >\n                <div style={{ padding: \"0px\" }}>\n                  <TextField\n                    label=\"Filter\"\n                    value={filter}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Filter the list of tools\"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      {props && props.auth && props.auth.user && (\n        <div style={{ textAlign: \"center\" }}>\n          Your are signed in as \"{props.auth.user.displayName}\" with UPN{\" \"}\n          {props.auth.user.userPrincipalName}\". Visit your Office profile at\n          &nbsp;\n          <a href=\"https://portal.office.com/account/#apps\" target=\"_blank\">\n            https://portal.office.com/account/#apps\n          </a>\n        </div>\n      )}\n    </div>\n  );\n}\n","export function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n","/****\n * \n * \n *  version \n *  1.0 \n * \n * \n * \n */\nimport Axios from \"axios\";\nimport moment from \"moment\";\nexport function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nconst GETACCESSTOKEN = \"getAccessToken\";\nconst RESTOREURL = \"restoreUrl\";\nconst GETGRAPHUSER = \"getGraphUser\";\nconst LOGIN = \"login\";\nconst ACCESSTOKEN = \"access_token\";\nconst ACCESSEXPIRES = \"access_expires\";\n\nfunction isAccessTokenExpired() {\n  try {\n    var exp = sessionStorage.getItem(ACCESSEXPIRES);\n    var expiresIn = moment(exp);\n    var now = moment();\n    var x = now.diff(expiresIn);\n    return x > 0 ? true : false;\n  } catch (error) {\n    return true;\n  }\n}\n\n/**\n * Based on session storage - if no auth token is present, or if is to old, a auth sequence is initiated\n * @param {*} config \n * @param {*} callBackNotifyIfInteractionIsRequired \n */\nexport function authenticate(config, callBackNotifyIfInteractionIsRequired) {\n  // https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow\n\n  return new Promise((resolve, reject) => {\n    var redirect_uri =\n      (window.location.hostname === \"localhost\"\n        ? window.location.protocol\n        : \"https:\") +\n      \"//\" +\n      window.location.hostname +\n      (window.location.port !== 80 &&\n      window.location.port !== 443 &&\n      window.location.port !== \"\"\n        ? \":\" + window.location.port\n        : \"\") +\n      \"/\";\n    // window.location.pathname;\n\n    var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\n    var client_id = config.clientId;\n    var response_type = \"id_token\";\n    var response_mode = \"fragment\";\n    var scope = config.scopes;\n\n    var seq = \"\"; // sessionStorage.getItem(\"authseq\");\n    var search = getSearchParametersFromHash(window.location.href);\n\n    var search2 = getSearchParametersFromHRef(window.location.href);\n    //debugger\n\n    if (search.id_token) {\n      seq = GETACCESSTOKEN;\n    } else if (search.access_token) {\n      seq = RESTOREURL;\n    } else if (search.login) {\n      seq = LOGIN;\n    } else if (seq === \"\") {\n      if (sessionStorage.getItem(ACCESSTOKEN)) {\n        seq = isAccessTokenExpired() ? GETACCESSTOKEN : GETGRAPHUSER;\n      } else {\n        seq = GETACCESSTOKEN;\n      }\n    }\n\n    if (search.error || search2.error) {\n      var e = search.error ? search.error : search2.error;\n      var handled = false;\n      switch (e) {\n        case \"interaction_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired();\n          }\n          sessionStorage.removeItem(\"accesstoken\");\n          sessionStorage.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&response_type=${response_type}&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=openid`;\n          window.location.href = url;\n          return;\n          break;\n        case \"consent_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired();\n          }\n          //debugger;\n          sessionStorage.removeItem(\"accesstoken\");\n          sessionStorage.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&prompt=consent&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=openid`;\n          window.location.href = url;\n          return;\n          break;\n        case \"invalid_request\":\n          \n          break\n        default:\n          if (sessionStorage.setItem(\"returnto\", \"/\"))\n            window.location.href = \"#login\";\n          return;\n          handled = true;\n          break;\n      }\n      if (!handled) {\n        alert(\n          search.error_description\n            ? search.error_description\n            : search2.error_description\n        );\n        //window.location.href = sessionStorage.getItem(\"returnto\");\n        reject(search.error_description)\n        return;\n      }\n    }\n\n    switch (seq) {\n      case LOGIN:\n        sessionStorage.setItem(\"returnto\", window.location.href);\n      \n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}`;\n        window.location.href = url;\n        return;\n        break;\n      case GETACCESSTOKEN:\n        sessionStorage.setItem(\"returnto\", window.location.href);\n    \n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}`;\n        window.location.href = url;\n        return;\n        break;\n      case GETGRAPHUSER:\n        sessionStorage.removeItem(\"returnto\");\n\n        Axios.get(\"https://graph.microsoft.com/v1.0/me\", {\n          headers: {\n            \"content-type\": \"application/json\",\n            authorization: `Bearer ${sessionStorage.getItem(ACCESSTOKEN)}`,\n          },\n        })\n          .then((result) => {\n            resolve({ user: result.data });\n          })\n          .catch((error) => {\n            var txt = error.response.data.error.message;\n            if (\n              error &&\n              error.response &&\n              error.response.data &&\n              error.response.data.error\n            ) {\n              //alert(error.response.data.error.message)\n              resolve({ error: error.response.data.error.message });\n            } else {\n              resolve({ error });\n            }\n          });\n        break;\n\n      case RESTOREURL:\n        if (search.access_token) {\n          sessionStorage.setItem(ACCESSTOKEN, search.access_token);\n\n          var expires = moment().add(search.expires_in, \"s\");\n\n          sessionStorage.setItem(ACCESSEXPIRES, expires.toISOString());\n          if (sessionStorage.getItem(\"returnto\"))\n            window.location.href = sessionStorage.getItem(\"returnto\");\n          return;\n        } else {\n          window.location.reload();\n        }\n        resolve();\n        break;\n\n      default:\n        resolve({\n          error:\n            \"Sorry to have put you in this situation, but our authentication logic is not able to detect the next step to taka so we cannot let you in\",\n        });\n        break;\n    }\n  });\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nimport config from \"./config\";\nimport { authenticate } from \"./authenticate\";\n\nasync function start() {\n  var auth = await authenticate(config,()=>{\n    \n  // this is where you can send a signal to a host that intercati ons is required\n\n  }).catch((error) => {\n   \n    console.log(error);\n    document.getElementById('root').innerHTML=error\n    return \n  });\n  ;\nif (auth){\n  ReactDOM.render(<App auth={auth} />, document.getElementById('root'));\n}\n}\n\nstart();\n"],"sourceRoot":""}