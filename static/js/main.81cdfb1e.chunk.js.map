{"version":3,"sources":["components/ToolboxLayout.js","config/default/favicon-96x96.png","components/Tags.js","components/Highlight.js","components/AppSuperTile.js","components/ViewErrors.js","components/MouseOver.js","helpers/trace.js","components/ViewTeams.js","config/index.js","helpers/index.js","helpers/OfficeGraph/index.js","helpers/LaunchPad.js","App.js","Onboard.js","authenticate.js","index.js"],"names":["ResponsiveReactGridLayout","WidthProvider","Responsive","ToolboxLayout","props","onBreakpointChange","breakpoint","setState","prevState","currentBreakpoint","toolbox","onCompactTypeChange","oldCompactType","state","compactType","onTakeItem","item","filter","i","layouts","onPutItem","onLayoutChange","layout","key","value","global","localStorage","setItem","JSON","stringify","persist","onNewLayout","lg","generateLayout","onResize","tools","forEach","tool","mounted","this","x","y","that","_","map","l","tile","title","refresh","Date","now","style","backgroundColor","color","textcolor","cursor","editingLayout","overflow","data-grid","w","h","className","static","getPin","breakpoints","md","sm","xs","xxs","cols","measureBeforeMount","useCSSTransforms","preventCollision","isDraggable","editMode","isResizable","generateDOM","React","Component","range","Math","ceil","random","floor","toString","defaultProps","rowHeight","initialLayout","module","exports","Tags","references","display","flexWrap","group","padding","margin","textColor","Highlight","text","ix","toLowerCase","indexOf","first","substr","middle","length","last","AppSuperTile","useState","tileSize","border","maxWidth","width","height","maxHeight","borderRadius","onClick","marginTop","src","icon","flexGrow","lineHeight","marginLeft","fontSize","highlightStyle","alignItems","class","isPinned","e","onPinnedClicked","preventDefault","stopPropagation","aria-hidden","textAlign","inShort","justifyContent","externalArticle","href","rel","target","ViewErrors","errors","error","context","dragOptions","moveMenuItemText","closeMenuItemText","menu","ContextualMenu","cancelIcon","iconName","theme","getTheme","contentStyles","mergeStyleSets","container","flexFlow","header","fonts","xLargePlus","flex","borderTop","palette","themePrimary","neutralPrimary","fontWeight","FontWeights","semibold","body","overflowY","selectors","p","marginBottom","iconButtonStyles","root","marginRight","rootHovered","neutralDark","GroupMouseOver","isModalOpen","setIsModalOpen","onSave","Modal","titleAriaId","isOpen","onDismiss","isBlocking","containerClassName","IconButton","styles","iconProps","ariaLabel","PinMouseOver","zIndex","onRemove","EVENT","LANDING","ONBOARDING","SEARCHING","TILECLICKED","TABCLICKED","DETAILSTOGGLED","MEMBERSHIPSREAD","who","upn","window","amplitude","amp","getInstance","setUserId","s","split","setDomain","trace","event","details","logEvent","console","log","Object","freeze","breakpointColumnsObj","default","3600","3300","3000","2700","2400","2100","1800","1500","1200","900","600","ViewTeams","viewDates","memberShips","cloneDeep","tiles","push","displayName","sortBy","minWidth","breakpointCols","columnClassName","team","ViewTeam","viewChannels","onSaveTeam","mouseOver","setMouseOver","componentRef","useRef","logo","show","c","data","webUrl","uniqueEndPoints","groupBy","endPoints","endPoint","providerName","conversationsHref","uri","part2","part4","part5","threadId","groupId","tenantId","teamsLink","photo","channels","current","offsetParent","offsetWidth","offsetHeight","ref","position","right","top","hasTeams","hasSharePoint","hasYammer","bottom","visibility","onMouseEnter","onMouseLeave","xborder","xborderRadius","onRemovePin","pinId","paddingLeft","xdisplay","paddingBottom","fontStyle","paddingRight","description","channel","membershipType","tabs","filesLink","generalLink","tab","configuration","websiteUrl","decodeURIComponent","expirationDateTime","moment","fromNow","clientId","directoryId","scopes","defaultTableAPI","niels","teamsIntegration","options","components","borderBottom","left","textDecoration","getSearchParametersFromHRef","search","s1","s2","index","s3","graph","analyseMembers","token","emailAddresses","cb","addresses","element1","element2","match","smtp","checked","results","address","readUser","err","user","invite","emailAddress","invitationRedirectUrl","post","invitedUserEmailAddress","inviteRedirectUrl","invitedUserDisplayName","sendInvitationMessage","invitedUserMessageInfo","customizedMessageBody","ccRecipients","name","response","addcrm","tag","msg","properties","property","post2","addmember","userId","getSharePointList","host","site","list","listfilter","itemfilter","get","items","itemList","next","pop","id","getPages","readGroupMembers","readGroupMemberShipFor","readManager","userPrincipalName","matchingGroups","searchText","findGroup","getGroupDocuments","folderName","getGroupDrive","getGroupSite","getDriveChildren","driveId","itemId","getGroupRootFolders","getSharePointSiteByName","hostName","relativePath","getSharePointSiteDrive","path","copyfile","groupNickName","fromFolder","fromName","toFolder","toName","groups","fromItems","find","targetFolders","destFolder","newDoc","parentReference","result","sourceGroupId","lookupFile","iterations","file","iteration","setTimeout","Client","url","Promise","resolve","reject","payload","patch","axios","headers","authorization","then","catch","put","getRaw","request","getImage","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","readAsDataURL","open","setRequestHeader","responseType","send","auth","getAccessToken","get2","put2","me","myGroups","readTeam","getMyExtention","extensionName","getOneDriveFolder","folderNameWithOutInitialSlash","getOneDriveFolderContent","getOneDriveFile","filename","a","folder","saveOneDriveFile","createOneDriveFolder","createOneDriveFolderChild","parentFolderNameWithOutInitialSlash","driveItem","saveMyExtention","updateMyExtention","r","addMyExtention","patch2","teamMemberships","reportProgessPercent","client","memberships","pending","total","processed","readGroup","sort","b","creationOptions","v","resourceProvisioningOptions","readChannels","readEndpoints","undefined","queue","appendTo","retrycount","parsedBody","errCounter","parse","concat","sessionStorage","getItem","extentionName","OURPATH","CONTEXTPATH","CONTEXTS","OURCONFIGFILENAME","saveCache","membershipIndex","membership","cachedFileName","verifyAccessForLanuchPad","setCheckMe","setCheckMyExtention","setCheckOneDrive","setCheckOneDriveFiles","setCheckMemberships","setCheckTeam","checkAccessToConfig","version","projectInfo","message","checkAccessToContexts","m","hello","extention","teamId","member","logSearchTimer","searchInfo","buffer","delaywriteLayouts","writing","writeLayouts","myTeams","isEqual","inIframe","self","App","inFrame","config","upnIs","showTabFeature","titlegraphics","setTitlegraphics","_setFilter","setSearch","setTiles","isZoomed","setIsZoomed","setCurrentTile","myTools","setMyTeams","ztickyRef","setZtickyRef","setErrors","setMemberships","contexts","setContexts","selectedContext","setSelectedContext","refreshing","setRefresing","progress","setProgress","progressPercent","setProgressPercent","showTable","showFilterOptions","tableUrl","setTableUrl","setLayouts","refreshCounter","setRefreshCounter","tags","setTags","showDetails","_setShowDetails","showCatalogue","setShowCatalogue","setEditMode","isLoaded","setIsLoaded","selectedGroup","setGroups","setFilter","startsWith","removePin","keys","splice","addPin","readGrid","tableId","grid","groupRefs","row","cell","groupSetting","members","refs","ga","sortKey","toLower","correlation","initGraph","queueCount","localCache","cachedMemberships","percent","matchFilter","subTitle","useEffect","location","ztickyref","files","ctxs","endsWith","contextFileName","defaultTableKey","load","filteredTiles","filteredMyTools","filteredMemberShips","URL","include","matchTeam","clearTimeout","ProgressIndicator","percentComplete","xlabel","xdescription","TextField","autoFocus","disabled","onChange","newValue","placeholder","Dropdown","selectedKey","onChanged","option","dropdown","Toggle","on","parseInt","onTileClick","autofocus","suggestions","handleDelete","tgs","slice","handleAddition","identify","jumpto","messageBeforeLaunch","borderLeft","float","label","initializeIcons","Onboard","checkMe","checkMemberships","checkTeam","checkMyExtention","checkOneDrive","checkOneDriveFiles","run","dir","GETACCESSTOKEN","RESTOREURL","GETGRAPHUSER","LOGIN","ACCESSTOKEN","ACCESSEXPIRES","authenticate","callBackNotifyIfInteractionIsRequired","redirect_uri","hostname","protocol","port","client_id","scope","seq","getSearchParametersFromHash","search2","id_token","access_token","login","exp","expiresIn","diff","isAccessTokenExpired","handled","removeItem","alert","error_description","Axios","expires","add","expires_in","toISOString","reload","ErrorBoundary","hasError","info","DefaultButton","primary","viewDetails","componentStack","readOnly","rows","children","loadTheme","defaultFontStyle","fontFamily","small","medium","large","xLarge","document","getElementById","innerHTML","ReactDOM","render","Customizer","FluentCustomizations","Fabric","start"],"mappings":"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","file":"static/js/main.81cdfb1e.chunk.js","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport ReactGridLayout, { Responsive, WidthProvider } from \"react-grid-layout\";\nimport \"./Toolbox.css\";\nconst ResponsiveReactGridLayout = WidthProvider(Responsive);\n\n//\n\nexport default class ToolboxLayout extends React.Component {\n  static defaultProps = {\n    className: \"layout\",\n    rowHeight: 30,\n    onLayoutChange: function () {},\n    cols: { lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 },\n    initialLayout: generateLayout(),\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      currentBreakpoint: \"lg\",\n      compactType: \"vertical\",\n      mounted: false,\n      // layouts: props.layouts\n      //   ? props.layouts\n      //   : {\n      //       lg: props.tools\n      //         ? props.tools.map((tool, ix) => {\n      //             return {\n      //               x: 0,\n      //               y: ix,\n      //               w: 3,\n      //               h: 3,\n\n      //               i: ix.toString(),\n\n      //               static: 0, //Math.random() < 0.05,\n      //             };\n      //           })\n      //         : props.initialLayout,\n      //     },\n      toolbox: { lg: [] },\n    };\n  }\n\n  componentDidMount() {\n    this.setState({ mounted: true });\n  }\n\n  generateDOM(x,y) {\n    var that = this;\n    \n    return _.map(this.props.layouts[this.state.currentBreakpoint], (l) => {\n      \n      var tile =\n        that.props.tools && that.props.tools[l.i] && that.props.tools[l.i].tile\n          ? that.props.tools[l.i].tile\n          : { title: l.i };\n          {var refresh = Date.now()}\n      return (\n        <div\n          style={{\n            backgroundColor: tile.color,\n            color: tile.textcolor,\n            cursor: !this.props.editingLayout ? \"pointer\" : \"default\",\n            overflow:\"hidden\"\n          }}\n          // onClick={() => {\n          //   if (this.props.onTileClick && !this.props.editingLayout) {\n          //     this.props.onTileClick(tile);\n          //   }\n          // }}\n          key={l.i}\n\n          data-grid={{w:l.w,h:l.h,x:l.x,y:l.y}}\n          className={l.static ? \"static\" : \"\"}\n        >\n       \n          <span >\n          \n        {/* {refresh} {l.w}x{l.h} */}\n            {that.props.getPin(l.i,l.w,l.h,refresh)} \n            </span>\n        </div>\n      );\n    });\n  }\n\n  onBreakpointChange = (breakpoint) => {\n    this.setState((prevState) => ({\n      currentBreakpoint: breakpoint,\n      toolbox: {\n        ...prevState.toolbox,\n        [breakpoint]:\n          prevState.toolbox[breakpoint] ||\n          prevState.toolbox[prevState.currentBreakpoint] ||\n          [],\n      },\n    }));\n  };\n\n  onCompactTypeChange = () => {\n    const { compactType: oldCompactType } = this.state;\n    const compactType =\n      oldCompactType === \"horizontal\"\n        ? \"vertical\"\n        : oldCompactType === \"vertical\"\n        ? null\n        : \"horizontal\";\n    this.setState({ compactType });\n  };\n\n  onTakeItem = (item) => {\n    this.setState((prevState) => ({\n      toolbox: {\n        ...prevState.toolbox,\n        [prevState.currentBreakpoint]: prevState.toolbox[\n          prevState.currentBreakpoint\n        ].filter(({ i }) => i !== item.i),\n      },\n      layouts: {\n        ...prevState.layouts,\n        [prevState.currentBreakpoint]: [\n          ...prevState.layouts[prevState.currentBreakpoint],\n          item,\n        ],\n      },\n    }));\n  };\n\n  onPutItem = (item) => {\n    this.setState((prevState) => {\n      return {\n        toolbox: {\n          ...prevState.toolbox,\n          [prevState.currentBreakpoint]: [\n            ...(prevState.toolbox[prevState.currentBreakpoint] || []),\n            item,\n          ],\n        },\n        layouts: {\n          ...prevState.layouts,\n          [prevState.currentBreakpoint]: prevState.layouts[\n            prevState.currentBreakpoint\n          ].filter(({ i }) => i !== item.i),\n        },\n      };\n    });\n  };\n\n  onLayoutChange = (layout, layouts) => {\n    saveToLS(\"layouts\", layouts);\n\n    if (this.props.persist) {\n      this.props.persist(layouts);\n    }\n    this.setState({ layouts });\n  };\n\n  onNewLayout = () => {\n    this.setState({\n      layouts: { lg: generateLayout() },\n    });\n  };\n  onResize = () =>{\n    if (!this.props.tools) return\n    \n    this.props.tools.forEach(tool => {\n      if (tool.onResize) tool.onResize()\n    });\n\n  }\n  render() {\n    return (\n      <div>\n        {/* <div>\n          Current Breakpoint: {this.state.currentBreakpoint} (\n          {this.props.cols[this.state.currentBreakpoint]} columns)\n        </div>\n        <div>\n          Compaction type:{\" \"}\n          {_.capitalize(this.state.compactType) || \"No Compaction\"}\n        </div>\n        <button onClick={this.onNewLayout}>Generate New Layout</button>\n        <button onClick={this.onCompactTypeChange}>\n          Change Compaction Type\n        </button> */}\n\n        {/* <ToolBox\n          items={this.state.toolbox[this.state.currentBreakpoint] || []}\n          onTakeItem={this.onTakeItem}\n        /> */}\n\n        <ResponsiveReactGridLayout\n         breakpoints={{lg: 1200, md: 996, sm: 768, xs: 480, xxs: 0}}\n         cols={{lg: 12, md: 10, sm: 6, xs: 4, xxs: 2}}\n          {...this.props}\n          \n          layouts={this.props.layouts}\n          onBreakpointChange={this.onBreakpointChange}\n          onLayoutChange={this.onLayoutChange}\n          // WidthProvider option\n          measureBeforeMount={false}\n          // I like to have it animate on mount. If you don't, delete `useCSSTransforms` (it's default `true`)\n          // and set `measureBeforeMount={true}`.\n          useCSSTransforms={true}\n          compactType={this.state.compactType}\n          preventCollision={!this.state.compactType}\n          onResize={this.onResize}\n          isDraggable={this.props.editMode}\n          isResizable={this.props.editMode}\n        >\n          {this.generateDOM(this)}\n        </ResponsiveReactGridLayout>\n      </div>\n    );\n  }\n}\n\nfunction getFromLS(key) {\n  let ls = {};\n  if (global.localStorage) {\n    try {\n      ls = JSON.parse(global.localStorage.getItem(\"rgl-8\")) || {};\n    } catch (e) {\n      /*Ignore*/\n    }\n  }\n  return ls[key];\n}\n\nfunction saveToLS(key, value) {\n  if (global.localStorage) {\n    global.localStorage.setItem(\n      \"rgl-8\",\n      JSON.stringify({\n        [key]: value,\n      })\n    );\n  }\n}\nfunction generateLayout() {\n  return _.map(_.range(0, 25), function (item, i) {\n    var y = Math.ceil(Math.random() * 4) + 1;\n    return {\n      x: (_.random(0, 5) * 2) % 12,\n      y: Math.floor(i / 6) * y,\n      w: 2,\n      h: y,\n      i: i.toString(),\n      static: Math.random() < 0.05,\n    };\n  });\n}\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABidJREFUeNrtnc1vHdUZh5/3nBlf29dJbOLgOOAoSkwwIBKgsVIRGqkSq1AhqNIVC6Ru2j+gfwe7dsMCWIBUsajKh6qibKCtKqSGCgioNB+kSTCRUUzs4I/Y95yXxb1JiO+YAGfiI5f38ca+I78+M898nDm/OWNRVcXIhsvdgB87JiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzxeoPFJia+oJLM7MgklRcVRlo9rFr5yjebyzXMUZmPpvh6uLV9GIKzcEmgyODXYu6BcTI8y+9xst//CtF4ZP+bgiRgwfu5/fP/Y7Nm5rrtvHqYHlxmTf+8CZnPziLS9x5YghMPjHJkd8eQdzNO3W3AIWFhSVmvpyrRcDclQU2YuamqizNLzE/O1+DgMjy4nLlsmKtXxIRJPEUJJJ8FsuIAFLPdmDtDbGxTsz/h5iAzJiAzJiAzJiAzJiAzBTpJb47c3PLzC+0SO2ZKtDocQwONnBuw/ZzgXUWMPX5AufPf4VLPO5UYWiwwf79PSbg+9B+DFVRTR9j2oA315XYNSAzJiAzJiAzJiAzJiAzJmA9+JZOX2U3VIGomtTdEyBG5ZszoIR2H76ejOB2d0QVrm2DxERJY7tWu823SMScE57+xWHuHd+ZfJOjqoyObKWvtweAkZF+ms0yWYAqNHr9bb0JKxslP/vVIfb9/MHkQEajsn3P9so9Tyon6YUIMdazJiLQiTZbUdtHRQ1lnUDZiQqXWy2iai1DHIVzFP5ae6GmrYATKCoaWBHKK+dePcb0O/9GUscMYmTT3p2M/+aXuN4Gbxw/zz8/mU7ec6Mqu0c28ezhcZDAi387xpnpi7jEPTWo8ug99/HUIz9laUV4/u0VTl7U5KGTEJXD93qOThasXvXua4Aqsx+dYerNf+ASQ/kYIsMzc+z+9ZNIbw//+WyWYx9OUSSG3K0YOTA/zDOP7QECx8+e4l+fnqRwnh96fEmn7h3NAfSRg6xE4d0zkXdPR1KfqGkF2DrgODrZvaxbgIA4hys8kijAiSDeX7/uOCd47/DJ525301HknaNwHp+4qyqCc45OjI53UDiSBQB4oeoavHY3tL4+hq76fgMNo61DU+0+IDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDNrCqgv7JNV32+gZznXoakVgUx7qmpsheTDI4aIhnB9WDdGJYSIJFZuxUiMN8aKQ4y0Yug0/4cHMiFGYoydKkKI7VgydVS6FSBUZAFQGcgIWx7YzY4nDtUWSbqyQBAm7trC4w/uqC2SLJyAeH6ya5yh/oFaIsmJHWMIQung4G7HHf1SSyT5wF3VbasO5VutdjBfB06gLK83JNQ0aVhEKDsiW6EdytdxyvDi8K6dBK4EiDWUVW6ka6upfFXBicvKp7OB1OQwKgz3OSa3K4UIJ/97kfMXZtIf81AYGurnof1jIMJ7py8zc+VqDXWVndua3Dc2SIgtPj73AZfnv+wElGl1d2y9m/HRvV1trJwp//aFJV4/vYhPWSFpH0T7tpXs29aD98pf3jrBn/78XvJ7I0JQHn5ojImJUfCeF46d4vipS8lZc4iRo4d2MTG2hasrS7z691c4cfZ9nEt8Y0AMHDnwJHtG7+mSWflknFz7SjwCRG7u90RVQlRE0k5D8dpFWG/UjaokliVEbnoKrl03QuKEkqixfYqsoHJX3ECxeb1Idx/qdm8LuxFbhdzi57oxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAatY79HQNV/YpJ1gOmlldNVK3K4pYnXV1Ft+kFC4ulalgF4vbG649sy+BKJCf3kjAypLR29vgffp76TuKQtE2qvVUzoapU9OxAovncnf7Rip9D00ygZeUhOxgsKXlcsqQ/kvFiKzy/WE8n2FMNr0CPC/c5eYnp6r5VUFmzb3snd8BET45MIsc4sryWP3UWH7UB+7RgaIMXDm4im+WryCiCS9M0NVGd5yJ3cPj3VFkmL/TzgvdhHOjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIzNezxiKEIKwxBgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wOS0xMFQwNTo0MDowNiswMDowMFT52voAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDktMTBUMDU6NDA6MDYrMDA6MDAlpGJGAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTQtMDUtMTIgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn3IbtAAAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQAMTkyDwByhQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAxOTLTrCEIAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE1MzY1NTgwMDZiJ+JmAAAAD3RFWHRUaHVtYjo6U2l6ZQAwQkKUoj7sAAAAVnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vbW50bG9nL2Zhdmljb25zLzIwMTgtMDktMTAvZWI1MTNmMmE5ZWRkMzA1ZjhkZWEyODgzYTllYTNhNzguaWNvLnBuZ3XQqTUAAAAASUVORK5CYII=\"","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Tags = props => {\n  if (props && props.references) {\n    return (<div className=\"tags\" style={{ display: \"flex\",flexWrap:\"wrap\" }}>\n      {props.references.map((group,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", backgroundColor: group.color, color: group.textColor }}>\n          {group.title}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nTags.propTypes = {\n  references: PropTypes.array\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Highlight = props => {\n  \nif (!props.text) return null\nif (!props.filter) return  props.text\n\n    var ix = props.text.toLowerCase().indexOf(props.filter.toLowerCase())\n   if (ix===-1){\n     return props.text\n   }\n\n   \n   var first = props.text.substr(0,ix)\n   var middle = props.text.substr(ix,props.filter.length)\n   var last = props.text.substr(ix+props.filter.length)\n  return (\n    <>\n   \n      <span>{first}</span>\n      <span style={props.style}>{middle}</span>\n       <span>{last}</span>\n    \n    </>\n  );\n};\nHighlight.propTypes = {\n  style: PropTypes.object,\n\n  filter: PropTypes.string,\n  text: PropTypes.string\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nimport { Highlight } from \"./Highlight\";\nimport  \"./tile.css\"\nexport const AppSuperTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n\n  return (<>\n\n  {props.tileSize===1 &&\n    <div className=\"supertile\" style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n     <div  style={{\n       \n       margin: 10,\n       padding: 10,\n       backgroundColor: tile.color,\n       color: tile.textcolor,\n       width: 300,\n       height: 70,\n       maxHeight: 70,\n       borderRadius:35,\n       overflow: \"hide\"\n       \n     }}>\n       <div style={{ cursor: \"pointer\" }} onClick={() => {\n         if (props.onClick){\n           props.onClick(tile);\n                }\n   \n       }}>\n         <div style={{display:\"flex\"}}>\n           \n         <div style={{  margin: 8, marginTop:8, height: 40 }}>\n           <img style={{ height: \"auto\", width: 40 }} src={tile.icon} />\n         </div>\n           <div title={tile.title} style={{flexGrow:1,height:\"40px\",width:\"300px\", overflow:\"hidden\",lineHeight:\"40px\",marginTop:\"6px\",marginLeft:\"4px\", fontSize:\"24px\"}}>\n           <Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> \n           </div>\n          \n         <div style={{alignItems:\"flex-end\"}}>\n         <i\n                   style={{cursor:\"pointer\",display:\"none\"}}\n                     class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                     onClick={(e) => {\n                       if (props.onPinnedClicked){\n                         e.preventDefault()\n                         e.stopPropagation()\n                         props.onPinnedClicked(props)\n                       }\n                       \n                     }}\n                     aria-hidden=\"true\"\n                   ></i> \n         </div> </div>\n       \n         {/* <Tags references={tile.references} /> */}\n   \n       </div>\n     </div>\n     \n\n     </div>\n  }\n  {props.tileSize === 0 &&\n  <div style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n  <div style={{\n    margin: 10,\n    padding: 10,\n    backgroundColor: tile.color,\n    color: tile.textcolor,\n    width: 300,\n    height: 300,\n    maxHeight: 300,\n    overflow: \"auto\"\n  }}>\n    <div style={{ cursor: \"pointer\" }} onClick={() => {\n      if (props.onClick){\n        props.onClick(tile);\n             }\n\n    }}>\n      <div style={{display:\"flex\"}}><div style={{flexGrow:1}}><Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> </div>\n      <div style={{alignItems:\"flex-end\"}}>\n      <i\n                style={{cursor:\"pointer\",display:\"none\"}}\n                  class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                  onClick={(e) => {\n                    if (props.onPinnedClicked){\n                      e.preventDefault()\n                      e.stopPropagation()\n                      props.onPinnedClicked(props)\n                    }\n                    \n                  }}\n                  aria-hidden=\"true\"\n                ></i> \n      </div>\n      </div>\n      \n      <div style={{ textAlign: \"center\", margin: 20, marginTop:40, height: 120 }}>\n        <img style={{ height: \"auto\", width: 112 }} src={tile.icon} />\n      </div>\n\n      <div style={{ maxHeight: 60, height: 60, overflow: \"auto\" }}>\n    \n\n        {tile.inShort}\n      </div>\n       <Tags references={tile.references} /> \n\n    </div>\n  </div>\n  \n  <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} rel=\"noopener noreferrer\"  target=\"_blank\">\n          Jump to\n            </a>)} */}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} rel=\"noopener noreferrer\"  target=\"_blank\">\n           More info\n            </a>)}\n      </div>\n  </div>\n  }\n  </>);\n};\nAppSuperTile.propTypes = {\n  tile: PropTypes.object,\n  onClose: PropTypes.func,\n  filter : PropTypes.string,\n  highlightStyle : PropTypes.object,\n  isPinned : PropTypes.bool,\n  onPinnedClicked:PropTypes.func,\n  tileSize:PropTypes.number\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const ViewErrors = props => {\n  if (props && props.errors) {\n    return (<div className=\"tags\" >\n      {props.errors.map((error,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", }}>\n          When trying {error.context}, you got \n          {JSON.stringify(error)}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nViewErrors.propTypes = {\n  errors: PropTypes.array\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./groupover.css\";\nimport {\n  getTheme,\n  mergeStyleSets,\n  FontWeights,\n  ContextualMenu,\n  Toggle,\n  DefaultButton,\n  Modal,\n  IDragOptions,\n  IconButton,\n  IIconProps,\n} from \"office-ui-fabric-react\";\nconst dragOptions = {\n  moveMenuItemText: \"Move\",\n  closeMenuItemText: \"Close\",\n  menu: ContextualMenu,\n};\nconst cancelIcon = { iconName: \"Cancel\" };\nconst theme = getTheme();\nconst contentStyles = mergeStyleSets({\n  container: {\n    display: \"flex\",\n    flexFlow: \"column nowrap\",\n    alignItems: \"stretch\",\n  },\n  header: [\n    // tslint:disable-next-line:deprecation\n    theme.fonts.xLargePlus,\n    {\n      flex: \"1 1 auto\",\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\n      color: theme.palette.neutralPrimary,\n      display: \"flex\",\n      alignItems: \"center\",\n      fontWeight: FontWeights.semibold,\n      padding: \"12px 12px 14px 24px\",\n    },\n  ],\n  body: {\n    flex: \"4 4 auto\",\n    padding: \"0 24px 24px 24px\",\n    overflowY: \"hidden\",\n    selectors: {\n      p: { margin: \"14px 0\" },\n      \"p:first-child\": { marginTop: 0 },\n      \"p:last-child\": { marginBottom: 0 },\n    },\n  },\n});\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\nconst iconButtonStyles = {\n  root: {\n    color: theme.palette.neutralPrimary,\n    marginLeft: \"auto\",\n    marginTop: \"4px\",\n    marginRight: \"2px\",\n  },\n  rootHovered: {\n    color: theme.palette.neutralDark,\n  },\n};\nexport const GroupMouseOver = (props) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  return (\n    <div className=\"groupOver\">\n      <div className=\"groupOverLink\">\n        <div style={{ display: \"flex\" }}>\n          <div\n            style={{ flexGrow: 1 }}\n            onClick={(e) => {\n              setIsModalOpen(true);\n              e.preventDefault();\n            }}\n          >\n            Open{\" \"}\n          </div>\n          <div style={{backgroundColor:\"red\",color:\"white\"}}\n            onClick={(e) => {\n              e.preventDefault();\n              \n              if (props.onSave) {\n                props.onSave();\n              }\n            }}\n          >\n            Save\n          </div>\n        </div>\n      </div>\n\n      <Modal\n        titleAriaId={1}\n        isOpen={isModalOpen}\n        onDismiss={() => setIsModalOpen(false)}\n        isBlocking={false}\n        containerClassName={contentStyles.container}\n        dragOptions={dragOptions}\n      >\n        <div>\n          <span>Lorem Ipsum</span>\n          <IconButton\n            styles={iconButtonStyles}\n            iconProps={cancelIcon}\n            ariaLabel=\"Close popup modal\"\n            onClick={() => setIsModalOpen(false)}\n          />\n        </div>\n        <div className={contentStyles.body}></div>\n      </Modal>\n    </div>\n  );\n};\n\n\nexport const PinMouseOver = (props) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  return (\n    <div className=\"groupOver\" style={{zIndex:3}}>\n      <div className=\"groupOverLink\">\n        <div style={{ display: \"flex\" }}>\n          <div\n            style={{ flexGrow: 1 }}\n            onClick={(e) => {\n              setIsModalOpen(true);\n              e.preventDefault();\n            }}\n          >\n            Open{\" \"}\n          </div>\n          <div style={{backgroundColor:\"red\",color:\"white\"}}\n            onClick={(e) => {\n              \n              e.preventDefault();\n              \n              if (props.onRemove) {\n                props.onRemove();\n              }\n            }}\n          >\n            Remove\n          </div>\n        </div>\n      </div>\n\n      <Modal\n        titleAriaId={1}\n        isOpen={isModalOpen}\n        onDismiss={() => setIsModalOpen(false)}\n        isBlocking={false}\n        containerClassName={contentStyles.container}\n        dragOptions={dragOptions}\n      >\n        <div>\n          <span>Lorem Ipsum</span>\n          <IconButton\n            styles={iconButtonStyles}\n            iconProps={cancelIcon}\n            ariaLabel=\"Close popup modal\"\n            onClick={() => setIsModalOpen(false)}\n          />\n        </div>\n        <div className={contentStyles.body}></div>\n      </Modal>\n    </div>\n  );\n};\n","export const EVENT = {\n  LANDING: \"landing\",\n  ONBOARDING: \"onboarding\",\n  SEARCHING: \"user-searched-for\",\n  TILECLICKED: \"user-clicked-tile\",\n  TABCLICKED: \"user-clicked-tab\",\n  DETAILSTOGGLED: \"user-toggle-details\",\n  MEMBERSHIPSREAD:\"memberships-read\"\n};\nObject.freeze(EVENT);\n// var d = [\n//     \"init\",\n//     \"logEvent\",\n//     \"logRevenue\",\n//     \"setUserId\",\n//     \"setUserProperties\",\n//     \"setOptOut\",\n//     \"setVersionName\",\n//     \"setDomain\",\n//     \"setDeviceId\",\n//     \"enableTracking\",\n//     \"setGlobalUserProperties\",\n//     \"identify\",\n//     \"clearUserProperties\",\n//     \"setGroup\",\n//     \"logRevenueV2\",\n//     \"regenerateDeviceId\",\n//     \"groupIdentify\",\n//     \"onInit\",\n//     \"logEventWithTimestamp\",\n//     \"logEventWithGroups\",\n//     \"setSessionId\",\n//     \"resetSessionId\",\n//   ];\nexport function who(upn) {\n  if (!window.amplitude) return;\n  if (!upn) return;\n  var amp =  window.amplitude.getInstance()\n  if (!amp) return\n  \n  amp.setUserId(upn);\n\n  var s = upn.split(\"@\");\n  if (s.length === 2) {\n    amp.setDomain(s[1]);\n  }\n}\n\nexport function trace(event, details) {\n  if (!window.amplitude) return;\n  var amp =  window.amplitude.getInstance()\n  if (!amp) return\n  amp.logEvent(event, details);\n  console.log(\"trace\",event, details);\n}\n","import React, {\n  Component,\n  useState,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n} from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Highlight } from \"./Highlight\";\nimport Masonry from \"react-masonry-css\";\nimport moment from \"moment\";\nimport \"./masonry.css\";\nimport { GroupMouseOver, PinMouseOver } from \"./MouseOver\";\nimport _ from \"lodash\";\nimport { EVENT, trace } from \"../helpers/trace\";\nimport \"./tile.css\";\nconst breakpointColumnsObj = {\n  default: 11,\n\n  3600: 11,\n\n  3300: 10,\n  3000: 9,\n  2700: 8,\n  2400: 7,\n\n  2100: 6,\n  1800: 5,\n  1500: 4,\n  1200: 3,\n  900: 2,\n  600: 1,\n  //300: 1,\n};\nexport const useContainerDimensions = (myRef) => {\n  const getDimensions = () => ({\n    width: myRef.current.offsetParent.offsetWidth,\n    height: myRef.current.offsetParent.offsetHeight,\n  });\n\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n\n  useEffect(() => {\n    if (myRef.current) {\n      setDimensions(getDimensions());\n    }\n  }, []);\n\n  return dimensions;\n};\nexport const ViewTeams = (props) => {\n  const [viewChannels, setViewChannels] = useState(props.details);\n  const [viewDates, setViewDates] = useState(false);\n\n  if (props && props.memberShips) {\n    var memberShips = _.cloneDeep(props.memberShips);\n\n    if (props.tiles) {\n      props.tiles.forEach((tile) => {\n        //debugger\n        memberShips.push({\n          displayName: tile.title,\n          tile,\n        });\n      });\n\n      memberShips = _.sortBy(memberShips, [\"displayName\"]);\n    }\n    return (\n      <div\n        className=\"tags\"\n        style={{\n          padding: \"4px\",\n          margin: \"4px\",\n          fontSize: \"16px\",\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          minWidth: \"300px\",\n        }}\n      >\n        <Masonry\n          breakpointCols={breakpointColumnsObj}\n          className=\"my-masonry-grid\"\n          columnClassName=\"my-masonry-grid_column\"\n        >\n          {/* array of JSX items */}\n\n          {memberShips.map((team, key) => {\n            //    if ((!team.resourceProvisioningOptions || !team.resourceProvisioningOptions.length > 0) && (team.creationOptions && !team.creationOptions.length > 0)) return null\n            //if ( team[\"@odata.type\"] === \"#microsoft.graph.directoryRole\") return null\n            // Profoæe: \"https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=profile\"\n\n            return (\n              <ViewTeam\n                key={key}\n                team={team}\n                viewChannels={props.details}\n                viewDates={viewDates}\n                onSaveTeam={props.onSaveTeam}\n                {...props}\n              />\n            );\n          })}\n        </Masonry>\n      </div>\n    );\n  } else {\n    return null;\n  }\n};\nfunction teamsLink(href) {\n  if (href) {\n    var part1 = href.split(\"https://teams.microsoft.com/l/team/\");\n    var part2 = part1[1].split(\"/conversations?\");\n    var part3 = href.split(\"groupId=\");\n    var part4 = part3[1].split(\"&\");\n    var part5 = href.split(\"tenantId=\");\n    var threadId = part2[0];\n    var groupId = part4[0];\n    var tenantId = part5[1];\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    return conversationsHref;\n  } else {\n    return null;\n  }\n}\nfunction teamsLink2(href) {\n  if (href) {\n    var part1 = href.split(\"https://teams.microsoft.com/l/channel/\");\n    var part2 = part1[1].split(\"/conversations?\");\n    var part3 = href.split(\"groupId=\");\n    var part4 = part3[1].split(\"&\");\n    var part5 = href.split(\"tenantId=\");\n    var threadId = part2[0];\n    var groupId = part4[0];\n    var tenantId = part5[1];\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    return conversationsHref;\n  } else {\n    return null;\n  }\n}\nexport function ViewTeam(props) {\n  const viewChannels = props.viewChannels;\n  const [viewDates, setViewDates] = useState(props.viewDates);\n  const [mouseOver, setMouseOver] = useState(false);\n  const componentRef = useRef();\n\n  const team = props.team ? props.team : {};\n\n  function logo(show, icon) {\n    if (!show) return null;\n    var c = \"ms-fontSize-28 ms-Icon ms-Icon--\" + icon;\n    return <i className={c} style={{ padding: \"4px\" }} aria-hidden=\"true\"></i>;\n  }\n  var href =\n    team && team.data && team.data.details ? team.data.details.webUrl : \"\";\n\n  // Notebook https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=notebook\"\n  // Planner \"https://tasks.office.com/365adm.onmicrosoft.com/en-US/Home/Group/786dc6d7-766f-46df-ac4b-d6883597061f\"\n  if (team.data) {\n    var uniqueEndPoints = _.groupBy(\n      team.data.endPoints ? team.data.endPoints : [],\n      (endPoint) => {\n        return endPoint.providerName;\n      }\n    );\n    //debugger\n    var conversationsHref = \n    team && team.tile && team.tile ?\n    team.tile.externalArticle :\n    uniqueEndPoints[\"Yammer\"]\n      ? uniqueEndPoints[\"Yammer\"][0].uri\n      : teamsLink(href) ;\n      \n\n    var details =\n      team.data && team.data.details\n        ? team.data.details\n        : {\n            displayName: team.title\n              ? team.title\n              : team.displayName\n              ? team.displayName\n              : team[\"@odata.type\"],\n          };\n    var photo = team.data ? team.data.photo : null;\n    var channels = team.data && team.data.channels ? team.data.channels : [];\n  }\n  if (props.isPinned) {\n    //const { width, height } = useContainerDimensions(componentRef,props.refreshCount)\n    var width = componentRef.current\n      ? componentRef.current.offsetParent.offsetWidth-2\n      : 0;\n    var height = componentRef.current\n      ? componentRef.current.offsetParent.offsetHeight-2\n      : 0;\n\n    return (\n      <div  ref={componentRef} className=\"pinnedTile\"\n      style={{position:\"relative\"}}\n      >\n             <div style={{position:\"absolute\",right:4,top:4,display:\"flex\"}}>\n         \n          <div>\n            {logo(team.hasTeams, \"TeamsLogo\")}\n            {logo(team.hasSharePoint, \"SharepointLogo\")}\n            {logo(team.hasYammer, \"YammerLogo\")}\n          </div>\n        </div>\n        <div style={{position:\"absolute\",right:10,bottom:4,display:\"flex\"}}>\n          {\" \"}\n          <div style={{ flexGrow: 1 }}>{team.visibility}</div>\n         \n        </div>\n        <div\n         style={{ display: \"flex\" }}\n         onMouseEnter={() => {\n           setMouseOver(true);\n         }}\n         onMouseLeave={() => {\n           setMouseOver(false);\n         }}\n         style={{\n           width,\n           height,\n           xborder: \"1px dashed red\",\n           xborderRadius: \"20px\",\n         }}\n        >\n          <div style={{ display: \"flex\" }}>\n            <div>\n              {!props.editMode && mouseOver && (\n                <div style={{ position: \"absolute\" }}>\n                  {\" \"}\n                  <PinMouseOver\n                    onRemove={() => {\n                      if (props.onRemovePin) {\n                        props.onRemovePin(props.pinId);\n                      }\n                    }}\n                  />\n                </div>\n              )}\n              {/* {width}x{height} - {props.width}x{props.height} {props.refreshCounter} */}\n              {photo && (\n                <div  className=\"\">\n                  <img\n                    className=\"pinnedTile2\"\n                    src={photo}\n                    style={{\n                      height: \"48px\",\n                      width: \"48px\",\n                      \n                    }}\n                  ></img>\n                </div>\n              )}\n              {team.tile && team.tile.icon && (\n                <div\n                className=\"pinnedTile2\"\n                  style={{\n                    backgroundColor: team.tile.color,\n                  }}\n                >\n                  <img\n                  \n                    src={team.tile.icon}\n                    style={{\n                      margin: \"12px\",\n                      height: \"24px\",\n                      width: \"24px\",\n                    }}\n                  ></img>\n                </div>\n              )}\n            </div>\n            <div\n              className=\"ms-font-xl \"\n              style={{\n                padding: \"8px\",\n                marginRight:\"20px\",\n                lineHeight: \"32px\",\n                flexGrow: 1,\n              }}\n            >\n              {team.displayName}\n            </div>\n          </div>\n        </div>\n   \n      </div>\n    );\n  }\n  if (team.tile) {\n    return (\n      <div\n      \n        onMouseEnter={() => {\n          setMouseOver(true);\n        }}\n        onMouseLeave={() => {\n          setMouseOver(false);\n        }}\n        style={{\n          paddingLeft: \"0px\",\n          margin: \"10px\",\n          fontSize: \"16px\",\n          xdisplay: \"flex\",\n          border: \"1px solid #dddddd\",\n          minWidth: \"290px\",\n          maxWidth: \"290px\",\n        }}\n      >\n        <span\n          onClick={() => {\n            trace(EVENT.TILECLICKED, {\n              \"tile-key\": team.tile.key,\n              href: team.tile.externalArticle,\n            });\n          }}\n        >\n          <a\n            className=\"TeamLink\"\n            href={team.tile.externalArticle}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            <div>\n              <div\n                style={{\n                  minWidth: \"288px\",\n                  paddingLeft: \"0px\",\n                  paddingBottom: \"0px\",\n                }}\n              >\n                {mouseOver && (\n                  <div style={{ position: \"absolute\", marginTop: \"20px\" }}>\n                    {\" \"}\n                    <GroupMouseOver\n                      onSave={() => {\n                        if (props.onSaveTeam) {\n                          props.onSaveTeam(team);\n                        }\n                      }}\n                    />\n                  </div>\n                )}\n                {team.tile.icon && (\n                  <div\n                    className=\"teamTitleBar\"\n                    style={{\n                      backgroundColor: team.tile.color,\n                      marginTop: \"-20px\",\n                    }}\n                  >\n                    <img\n                      src={team.tile.icon}\n                      style={{\n                        margin: \"70px\",\n                        height: \"140px\",\n                        width: \"140px\",\n                      }}\n                    ></img>\n                  </div>\n                )}\n              </div>\n              <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\n                <div\n                  className=\"ms-font-xl \"\n                  style={{\n                    padding: \"8px\",\n                    lineHeight: \"32px\",\n                    textAlign: \"center\",\n                  }}\n                >\n                  <Highlight\n                    text={team.tile.title}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n              </div>\n            </div>\n            {team.tile.inShort && (\n              <div\n                className=\"ms-font-m\"\n                style={{\n                  fontStyle: \"italic\",\n                  marginTop: \"10px\",\n                  paddingLeft: \"20px\",\n                  paddingRight: \"20px\",\n                  margin: \"0px\",\n                }}\n              >\n                <div style={{ fontStyle: \"italic\", marginTop: \"8px\" }}>\n                  <Highlight\n                    text={team.tile.inShort}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n              </div>\n            )}\n          </a>\n        </span>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      onMouseEnter={() => {\n        setMouseOver(true);\n      }}\n      onMouseLeave={() => {\n        setMouseOver(false);\n      }}\n      style={{\n        paddingLeft: \"0px\",\n        margin: \"10px\",\n        fontSize: \"16px\",\n        xdisplay: \"flex\",\n        border: \"1px solid #dddddd\",\n        minWidth: \"290px\",\n        maxWidth: \"290px\",\n      }}\n    >\n      <a\n        className=\"TeamLink\"\n        href={conversationsHref}\n        rel=\"noopener noreferrer\"\n        target=\"_blank\"\n      >\n        <div>\n          <div\n            style={{\n              minWidth: \"290px\",\n              paddingLeft: \"0px\",\n              paddingBottom: \"0px\",\n            }}\n          >\n            {mouseOver && (\n              <div style={{ position: \"absolute\" }}>\n                {\" \"}\n                <GroupMouseOver\n                  onSave={() => {\n                    if (props.onSaveTeam) {\n                      props.onSaveTeam(team);\n                    }\n                  }}\n                />\n              </div>\n            )}\n            {photo && (\n              <img\n                className=\"teamImage\"\n                src={photo}\n                style={{\n                  height: \"288px\",\n                  width: \"288px\",\n                  marginLeft: \"0px\",\n                }}\n              ></img>\n            )}\n          </div>\n          <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\n            <div\n              className=\"ms-font-xl \"\n              style={{\n                padding: \"8px\",\n                lineHeight: \"32px\",\n                textAlign: \"center\",\n              }}\n            >\n              <Highlight\n                text={details.displayName}\n                filter={props.filter}\n                style={props.highlightStyle}\n              />\n            </div>\n          </div>\n          <div style={{ border: \"0px solid #dddddd\", paddingBottom: \"4px\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                marginRight: \"10px\",\n                marginLeft: \"10px\",\n                marginTop: \"10px\",\n              }}\n            >\n              <div style={{ flexGrow: 1 }}>{team.visibility}</div>\n              <div>\n                {logo(team.hasTeams, \"TeamsLogo\")}\n                {logo(team.hasSharePoint, \"SharepointLogo\")}\n                {logo(team.hasYammer, \"YammerLogo\")}\n              </div>\n            </div>\n\n            {/* {team.data.endPoints && \n              team.data.endPoints.map((endPoint, key) => {\n             // if (endPoint.providerName===\"Yammer\") debugger\n              return <div key={key}><a target=\"_blank\" href={endPoint.uri}>{endPoint.providerName} ({endPoint.capability})</a></div>;\n              })} */}\n          </div>\n        </div>\n        {details.displayName !== details.description && (\n          <div\n            className=\"ms-font-m\"\n            style={{\n              fontStyle: \"italic\",\n              marginTop: \"10px\",\n              paddingLeft: \"20px\",\n              paddingRight: \"20px\",\n              margin: \"0px\",\n            }}\n          >\n            {details.description}\n          </div>\n        )}\n        {viewChannels && (\n          <div className=\"ms-font-l ms-fontWeight-bold\">\n            {channels.length > 1 && (\n              <div style={{ marginTop: \"10px\", marginLeft: \"20px\" }}>\n                Channels\n              </div>\n            )}\n            <div className=\"channelListing\">\n              <ul style={{ xdisplay: \"none\", marginTop: \"10px\" }}>\n                {channels.map((channel, key) => {\n                  if (channel.displayName === \"$General\") {\n                    return null;\n                  }\n                  return (\n                    <li key={key} className=\"ms-font-m\">\n                      <div\n                        style={{\n                          color:\n                            channel.membershipType === \"private\"\n                              ? \"red\"\n                              : \"#000000\",\n                        }}\n                      >\n                        <Highlight\n                          text={channel.displayName}\n                          filter={props.filter}\n                          style={props.highlightStyle}\n                        />\n                      </div>\n                      {channel.description && (\n                        <div\n                          style={{ fontSize: \"smaller\", fontStyle: \"italic\" }}\n                        >\n                          <Highlight\n                            text={channel.description}\n                            filter={props.filter}\n                            style={props.highlightStyle}\n                          />\n                        </div>\n                      )}\n                      {channel.tabs && (\n                        <div className=\"channelTabs\">\n                          <ul>\n                            <li>\n                              {\" \"}\n                              <span\n                                onClick={() => {\n                                  trace(EVENT.TABCLICKED, {\n                                    \"team-name\": details.displayName,\n                                    \"channel-name\": channel.displayName,\n                                    href: channel.filesLink,\n                                  });\n                                }}\n                              >\n                                <a href={channel.generalLink} target=\"_blank\">\n                                  General\n                                </a>\n                              </span>\n                            </li>\n                            <li>\n                              <span\n                                onClick={() => {\n                                  trace(EVENT.TABCLICKED, {\n                                    \"team-name\": details.displayName,\n                                    \"channel-name\": channel.displayName,\n                                    href: channel.filesLink,\n                                  });\n                                }}\n                              >\n                                <a href={channel.filesLink} target=\"_blank\">\n                                  Files\n                                </a>\n                              </span>\n                            </li>\n                            {_.sortBy(channel.tabs, [\"sortOrderIndex\"]).map(\n                              (tab, ix) => {\n                                return (\n                                  <li key={ix}>\n                                    <span\n                                      onClick={() => {\n                                        trace(EVENT.TABCLICKED, {\n                                          \"team-name\": details.displayName,\n                                          \"channel-name\": channel.displayName,\n                                          \"tab-name\": tab.displayName,\n                                          href: channel.filesLink,\n                                        });\n                                      }}\n                                    >\n                                      <a\n                                        href={\n                                          tab.configuration &&\n                                          tab.configuration.websiteUrl\n                                            ? tab.configuration.websiteUrl\n                                            : tab.webUrl\n                                        }\n                                        target=\"_blank\"\n                                      >\n                                        <Highlight\n                                          text={decodeURIComponent(\n                                            tab.displayName\n                                          )}\n                                          filter={props.filter}\n                                          style={props.highlightStyle}\n                                        />\n                                      </a>\n                                    </span>\n                                  </li>\n                                );\n                              }\n                            )}\n                          </ul>\n                        </div>\n                      )}\n                    </li>\n                  );\n                })}\n              </ul>\n            </div>\n          </div>\n        )}\n        <div>\n          {viewDates && (\n            <div style={{ display: \"xflex\" }}>\n              {team.expirationDateTime && (\n                <div style={{ flexGrow: 1 }}>\n                  Expires in {moment(team.expirationDateTime).fromNow(true)}\n                </div>\n              )}\n              {/* {team.renewedDateTime && (<div style={{ flexGrow: 1 }}>\n                     Renewed {moment(team.renewedDateTime).toNow(true)} a go\n          </div>)} */}\n            </div>\n          )}{\" \"}\n        </div>\n      </a>\n    </div>\n  );\n}\n","import React from \"react\";\nimport logo from \"./default/favicon-96x96.png\";\n\nexport default {\n  clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\n  directoryId: \"common\",\n  scopes: \"user.readwrite.all group.read.all Files.ReadWrite.All\",\n  title: \"Tools\",\n  logo,\n  defaultTableAPI: \"https://api.jumpto365.com/table/hexatown.com/PTO365\",\n  niels: \"niels@jumpto365.com\",\n  teamsIntegration: true,\n  options: [],\n  components: {\n    header: (\n      <div style={{ marginTop: \"80px\" }}>\n        <div\n          style={{\n            borderBottom: \"1px solid #cccccc\",\n            position: \"fixed\",\n            backgroundColor: \"#ffffff\",\n            width: \"100vw\",\n            left: 0,\n            top: 0,\n            zIndex: 1\n          }}\n        >\n          <div\n            style={{ display: \"flex\", padding:\"10px\" }}\n          >\n            <div style={{ flexGrow: 1 ,display: \"flex\"}}>\n              <div >\n                <a style={{ color:\"inherit\",textDecoration:\"none\" }}\n                \n                href=\"/\" target=\"_blank\"> <div \n              \n              className=\"ms-font-xxl\"\n              style={{\n                marginLeft: \"16px\",\n\n                lineHeight: \"36px\",\n                padding: \"0px\",\n                color: \"333\",\n              }}>\n              LAUNZH&trade; by jumpto365</div>\n                  {/* <img style={{ height: \"48px\", padding: \"4px\" }} src={logo} /> */}\n                </a>\n              </div>\n             \n\n            </div>\n            <div\n              \n              \n            >\n              \n            </div>\n            <div style={{ flexGrow: 1 }}>\n              <div style={{ minWidth: \"150px\" }}>&nbsp;</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ),\n  },\n};\n","export function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n","import json from \"format-json\";\nimport _ from \"lodash\";\nimport request from \"request\";\nimport axios from \"axios\";\nimport { addElementAtIndex } from \"@fluentui/react\";\nexport var graph = {};\n\nfunction extractEmails(text) {\n  return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\n}\n\ngraph.analyseMembers = (token, emailAddresses, cb) => {\n  var addresses = [];\n\n  var ar1 = emailAddresses.split(\"\\n\");\n  ar1.forEach((element1) => {\n    var ar2 = element1.split(\";\");\n    ar2.forEach((element2) => {\n      var smptAddresses = extractEmails(element2);\n      smptAddresses.forEach((smtp) => {\n        addresses.push({\n          checked: false,\n          smtp,\n        });\n      });\n    });\n  });\n\n  var results = [];\n  var x = addresses.length;\n  addresses.forEach((address) => {\n    graph.readUser(token, address.smtp, 0, (err, user) => {\n      x--;\n      address.user = user;\n      address.err = err;\n      results.push(address);\n      if (x < 1) {\n        cb(null, results);\n        address.checked = true;\n      }\n    });\n  });\n};\ngraph.invite = (token, emailAddress, invitationRedirectUrl, cb) => {\n  var msg = {\n    invitedUserEmailAddress: emailAddress,\n    inviteRedirectUrl: invitationRedirectUrl,\n    invitedUserDisplayName: emailAddress,\n    sendInvitationMessage: false,\n    invitedUserMessageInfo: {\n      customizedMessageBody:\n        \"We are really happy to invite you to the JUMPTO365 #Insider program \",\n      ccRecipients: [\n        {\n          emailAddress: {\n            name: \"Niels\",\n            address: \"niels@jumpto365.com\",\n          },\n        },\n      ],\n    },\n  };\n  post(token, `https://graph.microsoft.com/v1.0/invitations`, msg, function (\n    err,\n    response\n  ) {\n    if (err) {\n      return cb(err);\n    }\n    cb(null, response);\n  });\n};\ngraph.addcrm = (token, emailAddress, first, last, tag, cb) => {\n  var msg = {\n    properties: [\n      {\n        property: \"firstname\",\n        value: first,\n      },\n      {\n        property: \"lastname\",\n        value: last,\n      },\n      {\n        property: \"internal_categories\",\n        value: tag,\n      },\n      // {\n      //   \"property\": \"phone\",\n      //   \"value\": \"@{body('Signin')['mobilePhone']}\"\n      // },\n      // {\n      //   \"property\": \"jobtitle\",\n      //   \"value\": \"@{body('Signin')['jobTitle']}\"\n      // },\n      // {\n      //   \"property\": \"country\",\n      //   \"value\": \"@{body('Signin')['country']}\"\n      // }\n    ],\n  };\n\n  post2(\n    token,\n    `https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/${emailAddress}/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null, response);\n    }\n  );\n};\ngraph.addmember = (token, userId, groupId, cb) => {\n  var msg = {\n    \"@odata.id\": `https://graph.microsoft.com/beta/directoryObjects/${userId}`,\n  };\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/members/$ref`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null);\n    }\n  );\n};\n\ngraph.getSharePointList = (\n  token,\n  host,\n  site,\n  list,\n  listfilter,\n  itemfilter,\n  cb\n) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items?${listfilter}`,\n    function (e, items) {\n      if (e) return cb(e);\n      var itemList = [];\n\n      function next() {\n        if (items.length === 0) return cb(null, itemList);\n        var item = items.pop();\n\n        get(\n          token,\n          `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items/${item.id}?${itemfilter}`,\n          function (e, item) {\n            if (e) return cb(e);\n            itemList.push(item);\n            next();\n          }\n        );\n      }\n\n      next();\n    }\n  );\n};\n\ngraph.getPages = (token, host, site, cb) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}`,\n    function (e, site) {\n      if (e) return cb(e);\n\n      get(\n        token,\n        `https://graph.microsoft.com/beta/sites/${site.id}/pages`,\n        function (e, items) {\n          if (e) return cb(e);\n\n          return cb(null, items);\n        }\n      );\n    }\n  );\n};\ngraph.readGroupMembers = function (token, groupId, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/beta/groups/\" +\n      groupId +\n      \"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id\",\n    cb\n  );\n};\n\ngraph.readGroupMemberShipFor = function (token, upn, cb) {\n  get(token, \"https://graph.microsoft.com/v1.0/users/\" + upn + \"/memberOf\", cb);\n};\n\ngraph.readManager = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName + \"/manager\",\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.matchingGroups = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'${searchText}')`,\n    cb\n  );\n};\n\ngraph.findGroup = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '${searchText}'`,\n    cb\n  );\n};\n\ngraph.getGroupDocuments = function (token, groupId, folderName, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root:${folderName}:/children`,\n    cb\n  );\n};\n\ngraph.getGroupDrive = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive`, cb);\n};\ngraph.getGroupSite = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/sites/root`,\n    cb\n  );\n};\n\ngraph.getDriveChildren = function (token, driveId, itemId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/drives/${driveId}/items/${itemId}/children`,\n    cb\n  );\n};\n\ngraph.getGroupRootFolders = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteDrive = function (token, id, path, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${id}/drive/root:/${path}:/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.copyfile = function (\n  token,\n  groupNickName,\n  fromFolder,\n  fromName,\n  toFolder,\n  toName,\n  cb\n) {\n  graph.findGroup(token, groupNickName, function (err, groups) {\n    if (err) return cb(err);\n    if (groups.length !== 1) return cb(\"Did't find a unique group\");\n    var group = groups[0];\n    graph.getGroupDocuments(token, group.id, \"/\" + fromFolder, function (\n      err,\n      fromItems\n    ) {\n      if (err) return cb(err);\n      var match = _.find(fromItems, { name: fromName });\n      graph.getGroupRootFolders(token, group.id, function (err, targetFolders) {\n        if (err) return cb(err);\n        var destFolder = _.find(targetFolders, { name: toFolder });\n        if (!destFolder) return cb(\"Did't find target folder\");\n        graph.newDoc(\n          token,\n          group.id,\n          match.id,\n          destFolder.parentReference.driveId,\n          destFolder.id,\n          toName,\n          function (err, result) {\n            if (err) return cb(err);\n            return cb(null, result);\n          }\n        );\n      });\n    });\n  });\n};\n\nfunction lookupFile(token, driveId, id, name, iterations, cb) {\n  // Content have been copied\n  graph.getDriveChildren(token, driveId, id, function (err, result) {\n    if (err) {\n      return cb(err);\n    }\n    // content of destination folder\n\n    for (let index = 0; index < result.length; index++) {\n      const file = result[index];\n\n      console.log(\"Comparing\", file.name, name);\n      if (file.name === name) {\n        // match found\n        console.log(\"Match found\");\n        return cb(null, file);\n      }\n    }\n\n    var iteration = 0;\n    function retry() {\n      console.log(\"Retrying\", iterations);\n      //\n      if (iteration > 10) {\n        return cb(\n          `Think that the file has been created, but could not find a reference to if. Filename is ${name} - Tryed ${iterations} to find it `\n        );\n      }\n      lookupFile(token, driveId, id, name, iterations + 1, cb);\n    }\n    // no match found so we will wait a second a try again\n    setTimeout(retry, 1000);\n  });\n}\n\ngraph.newDoc = function (token, sourceGroupId, itemId, driveId, id, name, cb) {\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${sourceGroupId}/drive/items/${itemId}/copy`,\n    {\n      parentReference: {\n        driveId: driveId,\n        id: id,\n      },\n      name: name,\n    },\n    function (err) {\n      // no result from that call - by design from Microsoft\n      if (err) {\n        return cb(err);\n      }\n\n      // so we fill try to find a referece our self\n      lookupFile(token, driveId, id, name, 0, cb);\n    }\n  );\n};\nexport const graphWithPromise = {};\ngraphWithPromise.me = (token) => {\n  return new Promise((resolve, reject) => {\n    get(\n      token,\n      \"https://graph.microsoft.com/v1.0/me/\",\n      (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      },\n      null\n    );\n  });\n};\n\nclass Client {\n  constructor() {\n    this.token = auth.getAccessToken();\n  }\n  get = (url) => {\n    return new Promise((resolve, reject) => {\n      get(this.token, url, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n\n  post = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      post(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n\n  patch = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      patch(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  put = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      put(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  getRaw = (url) => {\n    return getRaw(this.token, url);\n  };\n  getImage = (url) => {\n    return getImage(this.token, url);\n  };\n}\n\nfunction imageToBase64(blob) {\n  return new Promise((resolve, reject) => {\n    try {\n      var reader = new FileReader();\n\n      reader.onload = function () {\n        var blobAsDataUrl = reader.result;\n\n        resolve(blobAsDataUrl);\n      };\n\n      reader.readAsDataURL(new Blob([blob]));\n    } catch (error) {\n      debugger;\n      resolve(null);\n    }\n  });\n}\nconst get2 = (url) => {\n  var client = new Client();\n  return client.get(url);\n};\n\nconst patch2 = (url, payload) => {\n  var client = new Client();\n  return client.patch(url, payload);\n};\nconst post2 = (url, payload) => {\n  var client = new Client();\n  return client.post(url, payload);\n};\nconst put2 = (url, payload) => {\n  var client = new Client();\n  return client.put(url, payload);\n};\n/**\n *\n */\nexport const me = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me\");\n};\nexport const myGroups = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me/memberOf\");\n};\nexport const readTeam = (id) => {\n  return get2(\"https://graph.microsoft.com/v1.0/groups/\" + id);\n};\nexport const getMyExtention = (extensionName) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`\n  );\n};\n\nexport const getOneDriveFolder = (folderNameWithOutInitialSlash) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}`\n  );\n};\nexport const getOneDriveFolderContent = (folderNameWithOutInitialSlash) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}:/children`\n  );\n};\n\nexport const getOneDriveFile = (folderNameWithOutInitialSlash, filename) => {\n  return new Promise(async (resolve, reject) => {\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\n      (e) => {\n        reject(e);\n      }\n    );\n    if (!folder) return;\n\n    get2(\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}`\n    )\n      .then((file) => {\n        axios\n          .get(file[\"@microsoft.graph.downloadUrl\"])\n          .then((response) => {\n            resolve(response.data);\n          })\n          .catch((e) => {\n            reject(e);\n          });\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n};\n\nexport const saveOneDriveFile = (\n  folderNameWithOutInitialSlash,\n  filename,\n  payload\n) => {\n  return new Promise(async (resolve, reject) => {\n    console.log(\"Size of payload\", payload.length);\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\n      (e) => {\n        reject(e);\n      }\n    );\n    if (!folder) return;\n\n    put2(\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}:/content`,\n      payload\n    )\n      .then((result) => {\n        resolve(result);\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n};\n\nexport const createOneDriveFolder = (folderNameWithOutInitialSlash) => {\n  const driveItem = {\n    name: folderNameWithOutInitialSlash,\n    folder: {},\n    \"@microsoft.graph.conflictBehavior\": \"replace\",\n  };\n\n  return post2(\n    `https://graph.microsoft.com/v1.0/me/drive/root/children`,\n    driveItem\n  );\n};\n\nexport const createOneDriveFolderChild = (\n  parentFolderNameWithOutInitialSlash,\n  folderNameWithOutInitialSlash\n) => {\n  const driveItem = {\n    name: folderNameWithOutInitialSlash,\n    folder: {},\n    \"@microsoft.graph.conflictBehavior\": \"replace\",\n  };\n\n  return post2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${parentFolderNameWithOutInitialSlash}:/children`,\n    driveItem\n  );\n};\n\nexport const saveMyExtention = (extensionName, data) => {\n  return new Promise(async (resolve, reject) => {\n    var existing = await getMyExtention(extensionName).catch((e) => {});\n    if (!existing) {\n      addMyExtention(extensionName, data)\n        .then((r) => {\n          resolve(r);\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    } else {\n      updateMyExtention(extensionName, data)\n        .then((r) => {\n          resolve(r);\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    }\n  });\n};\nexport const updateMyExtention = (extensionName, data) => {\n  var payload = {\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n    extensionName: extensionName,\n    ...data,\n  };\n  return patch2(\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`,\n    payload\n  );\n};\nexport const addMyExtention = (extensionName, data) => {\n  var payload = {\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n    extensionName: extensionName,\n    ...data,\n  };\n  return post2(`https://graph.microsoft.com/v1.0/me/extensions`, payload);\n};\n\nexport const teamMemberships = (reportProgessPercent) => {\n  var client = new Client();\n  return new Promise(async (resolve, reject) => {\n    try {\n      var memberships = await client\n        .get(\"https://graph.microsoft.com/v1.0/me/memberOf\")\n        .catch((error) => reject(error));\n      var pending = 0;\n      var groups = [];\n\n      if (!memberships) return reject(\"Not able to read membership\");\n\n      //memberships = [memberships[0]];\n      var total = memberships.length;\n      var processed = 0;\n      if (reportProgessPercent) reportProgessPercent(0);\n      memberships.map(async (value) => {\n        pending++;\n\n        var group = await readGroup(value, client);\n\n        processed++;\n        if (reportProgessPercent) reportProgessPercent(processed / total);\n        groups.push(group);\n\n        pending--;\n        if (pending === 0) {\n          return resolve(\n            groups.sort((a, b) => {\n              if (a.text < b.text) {\n                return -1;\n              }\n              if (a.text > b.text) {\n                return 1;\n              }\n              return 0;\n            })\n          );\n        }\n      });\n    } catch (error) {\n      debugger;\n      reject(error);\n    }\n  }, null);\n};\n\nexport var auth = {};\n\nauth.getAccessToken = function () {\n  return sessionStorage.getItem(\"access_token\");\n};\n\nfunction readGroup(value, client) {\n  return new Promise(async (resolve, reject) => {\n    var group = {\n      ...value,\n      key: value.id,\n      text: value.title ? value.title : value.displayName,\n      title: value.description,\n    };\n    var photo = await client\n      .getImage(\n        `https://graph.microsoft.com/v1.0/groups/${value.id}/photo/$value`\n      )\n      .catch((error) => {\n        debugger;\n        console.log(\"Photo read error\");\n      });\n    if (photo && photo.indexOf(\"data:application/json\") > -1) photo = null;\n\n    var details = await client\n      .get(`https://graph.microsoft.com/v1.0/teams/${value.id}`)\n      .catch((error) => console.log(\"Team details read error\"));\n    (value.creationOptions ? value.creationOptions : []).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    (value.resourceProvisioningOptions\n      ? value.resourceProvisioningOptions\n      : []\n    ).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    \n    // https://www.techmikael.com/2017/11/retrieving-teams-and-yammer-endpoints.html\n    var channels = await readChannels(client, value).catch((e) => {});\n    var endPoints = await readEndpoints(client, value).catch((e) => {});\n    group.hasTeams = channels !== undefined;\n    group.data = {\n      endPoints,\n      details,\n      photo,\n      channels: channels,\n    };\n    resolve(group);\n  });\n}\n\nasync function readChannels(client, value) {\n  var queue = 0;\n  return new Promise(async (resolve, reject) => {\n    var channels = await client\n      .get(`https://graph.microsoft.com/beta/teams/${value.id}/channels`)\n      .catch((error) => {\n        console.log(\"Channel read error\");\n      });\n    if (!channels) return resolve();\n\n    channels.forEach(async (channel) => {\n      queue++;\n      var tabs = await client\n        .get(\n          `https://graph.microsoft.com/beta/teams/${value.id}/channels/${channel.id}/tabs`\n        )\n        .catch((error) => {\n          console.log(\"Channel read tabs\", error);\n        });\n\n      channel.tabs = tabs;\n      queue--;\n      if (queue === 0) {\n        resolve(channels);\n      }\n    });\n  });\n}\n\nasync function readEndpoints(client, value) {\n  return client.get(\n    `https://graph.microsoft.com/beta/groups/${value.id}/endpoints`\n  );\n}\n\nfunction post(token, url, body, cb) {\n  axios\n    .post(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\n\nfunction patch(token, url, body, cb) {\n  axios\n    .patch(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\n\nfunction put(token, url, body, cb) {\n  axios\n    .put(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\nexport function getRaw(token, url) {\n  console.log(\"getting\", url);\n\n  return new Promise((resolve, reject) => {\n    request.get(\n      {\n        url: url,\n        headers: {\n          authorization: \"Bearer \" + token,\n        },\n      },\n      function (err, response, body) {\n        if (err) {\n          return reject(err);\n        }\n        resolve({ body, response });\n      }\n    );\n  });\n}\n\nfunction getImage(token, url) {\n  return new Promise((resolve, reject) => {\n    try {\n      var xhr = new XMLHttpRequest();\n\n      xhr.onload = function () {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(xhr.response);\n      };\n\n      xhr.open(\"GET\", url);\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\n      xhr.responseType = \"blob\";\n      xhr.send();\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nexport function get(token, url, cb, appendTo, index, retrycount) {\n  console.log(\"getting\", url, appendTo === true);\n  request.get(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    },\n    function (err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        var errCounter = retrycount ? retrycount + 1 : 1;\n        if (errCounter > 3) {\n          return cb(err, null, index);\n        } else {\n          // retry\n          console.log(\"retry #\", errCounter);\n          return get(token, url, cb, appendTo, index, errCounter);\n        }\n      }\n\n      parsedBody = JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(parsedBody.error, null, index);\n      }\n\n      if (parsedBody[\"@odata.nextLink\"]) {\n        var data;\n        if (!appendTo) {\n          data = parsedBody.value;\n        } else {\n          data = appendTo.concat(parsedBody.value);\n        }\n\n        return get(token, parsedBody[\"@odata.nextLink\"], cb, data, index);\n      }\n\n      if (appendTo) {\n        cb(null, appendTo.concat(parsedBody.value), index);\n      } else {\n        if (parsedBody.value) {\n          cb(null, parsedBody.value, index);\n        } else {\n          cb(null, parsedBody, index);\n        }\n      }\n    }\n  );\n}\n","import {\n  me,\n  myGroups,\n  readTeam,\n  getMyExtention,\n  saveMyExtention,\n  getOneDriveFolder,\n  createOneDriveFolder,\n  getOneDriveFolderContent,\n  createOneDriveFolderChild,\n  getOneDriveFile,\n\n  saveOneDriveFile,\n} from \"./OfficeGraph\";\n\nimport projectInfo from \"../../package.json\";\nimport _ from \"lodash\"\nexport const extentionName = \"com.ztickybar.tools\";\nexport const OURPATH = \"Apps/jumpto365.com\";\nexport const CONTEXTPATH = \"Apps/jumpto365.com/contexts\";\nexport const CONTEXTS = \"contexts\";\n\nexport const OURCONFIGFILENAME = \"launchpad.json\";\n\nexport function saveCache(memberships) {\n  return new Promise((resolve, reject) => {\n    var membershipIndex = [];\n    var queue = 0;\n    memberships.forEach((membership) => {\n      membershipIndex.push(membership.id);\n      queue++;\n\n      saveOneDriveFile(OURPATH, cachedFileName(membership.id), membership).then(\n        () => {\n          queue--;\n          if (queue < 1) {\n            saveOneDriveFile(OURPATH, \"memberships.json\", membershipIndex)\n              .then(() => {\n                resolve(membershipIndex);\n              })\n              .catch((e) => {\n                reject(e);\n              });\n          }\n        }\n      );\n    });\n  });\n}\n\nfunction cachedFileName(id) {\n  return \"membership.\" + id + \".json\";\n}\n\nexport function readCache() {\n  return new Promise(async (resolve, reject) => {\n    var membershipIndex = await getOneDriveFile(\n      OURPATH,\n      \"memberships.json\"\n    ).catch((e) => {\n      reject(e);\n    });\n    if (!membershipIndex) return;\n    var queue = 0;\n    var memberships = [];\n    membershipIndex.forEach((id) => {\n      queue++;\n      getOneDriveFile(OURPATH, cachedFileName(id))\n        .then((data) => {\n          memberships.push(data);\n          queue--;\n          if (queue < 1) {\n            resolve(memberships);\n          }\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    });\n  });\n}\n\n/**\n * Verifies access to all endpoints used for the LaunchPad app\n *\n * @param {*} setCheckMe Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckMyExtention  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckOneDrive  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckOneDriveFiles  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckMemberships  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckTeam  Callback accepting a string - \"OK\" or an error\n */\nexport async function verifyAccessForLanuchPad(\n  setCheckMe,\n  setCheckMyExtention,\n  setCheckOneDrive,\n  setCheckOneDriveFiles,\n  setCheckMemberships,\n  setCheckTeam\n) {\n  me()\n    .then((m) => {\n      setCheckMe(\"OK\");\n    })\n    .catch((e) => {\n      setCheckMe(e.message);\n    });\n\n  var extention = await saveMyExtention(extentionName, {\n    hello: \"world\",\n  }).catch((e) => {\n    setCheckMyExtention(e.message);\n  });\n  if (extention || extention === \"\") {\n    setCheckMyExtention(\"OK\");\n  }\n\n  getOneDriveFolder(OURPATH)\n    .then((r) => {\n      setCheckOneDrive(\"OK\");\n      checkAccessToConfig();\n    })\n    .catch(async (e) => {\n      var f = await getOneDriveFolder(\"Apps\").catch((e) => {});\n      if (f) {\n        var child = await createOneDriveFolderChild(\n          \"Apps\",\n          \"jumpto365.com\"\n        ).catch((e) => {\n          setCheckOneDrive(e.message);\n        });\n        if (child) {\n          setCheckOneDrive(\"OK\");\n          checkAccessToConfig();\n        }\n      } else {\n        var child = await createOneDriveFolder(\"Apps\").catch((e) => {\n          setCheckOneDrive(e.message);\n        });\n        child = await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\").catch(\n          (e) => {\n            setCheckOneDrive(e.message);\n          }\n        );\n        if (child) {\n          setCheckOneDrive(\"OK\");\n          checkAccessToConfig();\n        }\n      }\n    });\n\n  myGroups()\n    .then((memberships) => {\n      setCheckMemberships(\"OK\");\n      var teamId;\n      memberships.forEach((member) => {\n        if (member.displayName) {\n          if (!teamId) {\n            teamId = member.id;\n          }\n        }\n      });\n      if (teamId) {\n        readTeam(teamId)\n          .then((m) => {\n            setCheckTeam(\"OK\");\n          })\n          .catch((e) => {\n            setCheckTeam(e.message);\n          });\n      } else {\n        setCheckTeam(\"Didn't find any Microsoft Teams memberships\");\n      }\n    })\n    .catch((e) => {\n      setCheckMemberships(e.message);\n    });\n\n  async function checkAccessToConfig() {\n    var settings = await getOneDriveFile(OURPATH, OURCONFIGFILENAME).catch(\n      async (e) => {\n        var file = await saveOneDriveFile(OURPATH, OURCONFIGFILENAME, {\n          version: projectInfo.version,\n        }).catch((e) => {\n          setCheckOneDriveFiles(e.message);\n        });\n        if (file) {\n          setCheckOneDriveFiles(\"OK\");\n        }\n      }\n    );\n    if (settings) {\n      setCheckOneDriveFiles(\"OK\");\n      checkAccessToContexts();\n    }\n  }\n}\n\nexport async function checkAccessToContexts() {\n  await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\");\n  await createOneDriveFolderChild(OURPATH, CONTEXTS);\n}\n\nexport function saveContext(memberships, name) {\n  return new Promise(async (resolve, reject) => {\n    await createOneDriveFolderChild(CONTEXTPATH, name);\n    var currentContextPath = CONTEXTPATH + \"/\" + name;\n    var membershipIndex = [];\n    var queue = 0;\n    memberships.forEach((membership) => {\n      membershipIndex.push(membership.id);\n      queue++;\n\n      saveOneDriveFile(\n        currentContextPath,\n        cachedFileName(membership.id),\n        membership\n      ).then(() => {\n        queue--;\n        if (queue < 1) {\n          saveOneDriveFile(\n            currentContextPath,\n            \"memberships.json\",\n            membershipIndex\n          )\n            .then(() => {\n              resolve(membershipIndex);\n            })\n            .catch((e) => {\n              reject(e);\n            });\n        }\n      });\n    });\n  });\n}\n\nexport function readContext(name) {\n  return new Promise(async (resolve, reject) => {\n    var currentContextPath = CONTEXTPATH + \"/\" + name;\n    var membershipIndex = await getOneDriveFile(\n      currentContextPath,\n      \"memberships.json\"\n    ).catch((e) => {\n      reject(e);\n    });\n    if (!membershipIndex) return;\n    var queue = 0;\n    var memberships = [];\n    membershipIndex.forEach((id) => {\n      queue++;\n      getOneDriveFile(currentContextPath, cachedFileName(id))\n        .then((data) => {\n          memberships.push(data);\n          queue--;\n          if (queue < 1) {\n            resolve(memberships);\n          }\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    });\n  });\n}\n\nvar buffer = {\n  layouts: { pending: false }\n};\n\nfunction delaywriteLayouts() {\n  setTimeout(() => {\n    console.log(\"delaywriteLayouts\");\n    if (!buffer.layouts.pending) {\n      return;\n    }\n    if (buffer.layouts.writing) {\n      return delaywriteLayouts();\n    }\n    writeLayouts(buffer.layouts.folder, buffer.layouts.file,buffer.layouts.data);\n  }, 2000);\n}\n\n\n\nexport function writeLayouts(folder, file, data) {\n  if (data.myTeams.length === 0) {\n    console.log(\"Ignoring writeLayouts with no teams\")\n    return}\n  return new Promise(async (resolve, reject) => {\n    console.log(\"writeLayouts\");\n    if (buffer && buffer.layouts && buffer.layouts.writing) {\n      if (_.isEqual(buffer.layouts.data, data)) {\n        console.log(\"writeLayouts no changes\");\n        return resolve();\n      }\n      buffer.layouts.pending = true;\n      buffer.layouts.data = data;\n      buffer.layouts.file = file;\n      buffer.layouts.folder = folder;\n      delaywriteLayouts();\n      return resolve();\n    }\n\n    try {\n      \n      buffer.layouts.writing = true;\n      buffer.layouts.current = data;\n     \n      \n      \n       \n      await saveOneDriveFile(folder,file,data)\n      \n     \n      \n\n      resolve();\n    } catch (error) {\n      console.log(\"writeLayouts > error\", error);\n      return reject(error);\n    } finally {\n      buffer.layouts.writing = false;\n    }\n  });\n}\n\n\nexport function readLayouts(folder,file){\n\n  return getOneDriveFile(folder,file)\n}\n\n\nexport function readContexts(){\n\n  return getOneDriveFolderContent(CONTEXTPATH)\n}","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\n\nimport { TextField, Dropdown, DropdownBase } from \"@fluentui/react\";\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\nimport { Toggle } from \"@fluentui/react/lib/Toggle\";\nimport { initializeIcons } from \"@uifabric/icons\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\nimport React, { useEffect, useState } from \"react\";\nimport \"react-grid-layout/css/styles.css\";\nimport \"react-resizable/css/styles.css\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport \"./App.css\";\nimport { AppSuperTile } from \"./components/AppSuperTile\";\nimport ToolboxLayout from \"./components/ToolboxLayout\";\nimport { ViewErrors } from \"./components/ViewErrors\";\nimport { ViewTeam, ViewTeams } from \"./components/ViewTeams\";\nimport config from \"./config\";\nimport \"./css/normalize.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport \"./css/webflow.css\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport {\n  CONTEXTPATH,\n  readCache,\n  readLayouts,\n  saveCache,\n  writeLayouts,\n  readContexts,\n} from \"./helpers/LaunchPad\";\nimport { teamMemberships } from \"./helpers/OfficeGraph\";\nimport { EVENT, trace } from \"./helpers/trace\";\n\nvar logSearchTimer;\nvar searchInfo;\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\ninitializeIcons();\n\nexport default function App(props) {\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n  const inFrame = inIframe();\n  const [showTabFeature, setThowTabFeature] = useState(\n    config.teamsIntegration || upnIs(config.niels)\n  );\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\n  const [filter, _setFilter] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [tiles, setTiles] = useState([]);\n  const [useAuthentication, setUseAuthentication] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isZoomed, setIsZoomed] = useState(false);\n  const [currentTile, setCurrentTile] = useState(null);\n  const [me, setMe] = useState({});\n  const [ztickyFolder, setZtickyFolder] = useState({});\n  var [myTools, setMyTools] = useState([]);\n  const [myTeams, setMyTeams] = useState([]);\n  const [ztickyRef, setZtickyRef] = useState(\"\");\n  const [tileSize, setTileSize] = useState(1);\n  const [errors, setErrors] = useState([]);\n  const [memberships, setMemberships] = useState([]);\n  const [contexts, setContexts] = useState([]);\n  const [selectedContext, setSelectedContext] = useState(props.context);\n  const [siteUrlLabel, setSiteUrlLabel] = useState(\"\");\n  const [siteUrlHref, setSiteUrlHref] = useState(\"\");\n  const [refreshing, setRefresing] = useState(false);\n  const [progress, setProgress] = useState(\"\");\n  const [progressPercent, setProgressPercent] = useState(null);\n  const [showTable, setShowTable] = useState(false);\n  const [editingLayout, setEditingLayout] = useState(true);\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\n  const [tableUrl, setTableUrl] = useState(\"\");\n  const [layouts, setLayouts] = useState({\n    lg: [\n      // {\n      //   x: 0,\n      //   y: Infinity,\n      //   w: 3,\n      //   h: 3,\n      //   i: \"1\",\n      //   static: 0, //Math.random() < 0.05,\n      // },\n    ],\n  });\n  const [currentPivot, setCurrentPivot] = useState(\"pinned\");\n  const [refreshCounter, setRefreshCounter] = useState(0);\n  const [tags, setTags] = useState([]);\n  const [showDetails, _setShowDetails] = useState(false);\n  const [showCatalogue, setShowCatalogue] = useState(!inIframe());\n  const [editMode, setEditMode] = useState(!inIframe());\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [tableApiSelected, setTableApiSelected] = useState(\n    \"https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE\"\n  );\n  const [selectedGroup, setSelectedGroup] = useState(\"\");\n  const [groups, setGroups] = useState([]);\n  \n\n  function setShowDetails(on) {\n    _setShowDetails(on);\n    trace(EVENT.DETAILSTOGGLED, { on });\n  }\n  function setFilter(value) {\n    setSearch(value);\n    if (_.startsWith(value, \".\")) {\n    } else {\n      _setFilter(value);\n    }\n  }\n\n  const _setTags = (t) => {\n    debugger;\n    setTags(t);\n  };\n\n  const removePin = (pinId) => {\n    var keys = _.keys(layouts);\n    keys.forEach((key) => {\n      layouts[key].splice(pinId, 1);\n    });\n\n    myTeams.splice(pinId, 1);\n    setLayouts(layouts);\n\n    setMyTeams(myTeams);\n    setRefreshCounter(refreshCounter + 1);\n  };\n\n  const getPin = (id, width, height, refresh) => {\n    var team = myTeams[parseInt(id)];\n    return (\n      <ViewTeam\n        editMode={editMode}\n        refreshCounter={refresh}\n        key={id}\n        width={width}\n        height={height}\n        team={team}\n        pinId={parseInt(id)}\n        isPinned\n        onRemovePin={removePin}\n      />\n    );\n  };\n\n  const addPin = (team) => {\n    var id = myTeams.push(team);\n    var keys = _.keys(layouts);\n    keys.forEach((key) => {\n      id = layouts[key].length.toString();\n      layouts[key].push({\n        team: team.id,\n        x: 0,\n        y: id * 2,\n        w: 2,\n        h: 2,\n\n        i: id,\n      });\n    });\n\n    setLayouts(layouts);\n\n    setRefreshCounter(refreshCounter + 1);\n\n    setMyTeams(myTeams);\n  };\n\n  useEffect(() => {\n    async function load() {\n      // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\n\n      if (showTabFeature) initGraph(false);\n\n      var search = getSearchParametersFromHRef(window.location.href);\n      if (search.ztickyref) {\n        setZtickyRef(search.ztickyref);\n      }\n      var href = search.src ? search.src : config.defaultTableAPI;\n      readContexts()\n        .then((files) => {\n          var ctxs = []\n          files.forEach(file => {\n            if (_.endsWith(file.name.toLowerCase(),\".json\")){\n              ctxs.push(file.name)\n            }\n          });\n          setContexts(ctxs)\n          \n        })\n        .catch((error) => {\n          errors.push({ context: \"readContexts\", error });\n          setErrors(errors);\n         \n        });\n      if (!isLoaded) {\n        setIsLoaded(true);\n        var l = await readLayouts(\n          CONTEXTPATH,\n          contextFileName()\n        ).catch((e) => {});\n        if (l) {\n          setMyTeams(l.myTeams);\n          setLayouts(l.layouts);\n          setRefreshCounter(refreshCounter + 1);\n        }\n      }\n\n      setTableUrl(config.defaultTableAPI);\n      readGrid(href, config.defaultTableKey);\n    }\n\n    load();\n  }, [refreshCounter]);\n\n  function readGrid(href, tableId) {\n    axios.get(href).then(({ data }) => {\n      setTitlegraphics(data.titlegraphics);\n      var tiles = [];\n      if (data.grid) {\n        var groups = {};\n        var groupRefs = {};\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.groupSetting) {\n              groups[cell.groupSetting.title] = {\n                groupSetting: cell.groupSetting,\n                members: cell.members,\n              };\n              if (cell.members) {\n                cell.members.forEach((id) => {\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\n                  refs.push(cell.groupSetting);\n                  groupRefs[id] = refs;\n                });\n              }\n            }\n          });\n        });\n\n        var g = _.keys(groups);\n        var ga = g.map((name) => {\n          return { title: name, ...groups[name] };\n        });\n\n        setGroups(_.sortBy(ga, [\"title\"]));\n\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.tile && cell.tile.title) {\n              var tile = { ...cell.tile };\n              tile.sortKey = _.toLower(cell.tile.title);\n              tile.tableId = tableId;\n              tile.correlation =\n                href +\n                \"#\" +\n                (tile.key\n                  ? tile.key\n                  : tile.title\n                  ? tile.title.toLowerCase()\n                  : tile.id);\n              var references = groupRefs[cell.id];\n              tile.references = references;\n              tiles.push(tile);\n            }\n          });\n        });\n      }\n\n      setTiles(_.sortBy(tiles, [\"sortKey\"]));\n    });\n  }\n\n  async function initGraph(refresh) {\n    try {\n      if (refresh) {\n      }\n      var queueCount = 0;\n\n      // await OfficeGraph.initStorage();\n\n      var localCache = localStorage.getItem(\"memberships\");\n      var cachedMemberships;\n      try {\n        if (localCache && !refresh) {\n          cachedMemberships = JSON.parse(localCache);\n          setMemberships(cachedMemberships);\n\n          return;\n        }\n      } catch (error) {}\n\n      setRefresing(true);\n      cachedMemberships = await readCache().catch((error) => {\n        errors.push({ context: \"readCache\", error });\n        setErrors(errors);\n      });\n\n      if (cachedMemberships && !refresh) {\n        setMemberships(cachedMemberships);\n        localStorage.setItem(\"memberships\", JSON.stringify(cachedMemberships));\n        setRefresing(false);\n      } else {\n        queueCount++;\n        setProgress(\"Loading\");\n        teamMemberships((percent) => {\n          setProgressPercent(percent);\n        })\n          .then(async (memberships) => {\n            await saveCache(memberships).catch((error) => {\n              errors.push({ context: \"saveCache\", error });\n              setErrors(errors);\n            });\n            localStorage.setItem(\"memberships\", JSON.stringify(memberships));\n            queueCount--;\n            if (queueCount === 0) setRefresing(false);\n            trace(EVENT.MEMBERSHIPSREAD, {\n              \"count-memberships\": memberships.length,\n            });\n            setMemberships(memberships);\n\n            setProgress(\"\");\n          })\n          .catch((error) => {\n            debugger;\n            queueCount--;\n            if (queueCount <= 0) setRefresing(false);\n            errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\n            setErrors(errors);\n            setProgress(\"\");\n          });\n      }\n      return;\n      // OfficeGraph.initTileStorage()\n      //   .then(async (ztickyFolder) => {\n      //     setZtickyFolder(ztickyFolder);\n      //     queueCount++;\n\n      //     var [layouts, properties, version] = await OfficeGraph.readLayouts(\n      //       ztickyFolder\n      //     );\n      //     //debugger\n      //     var myTools = [];\n      //     if (version < 0) {\n      //       var tileFolders = await OfficeGraph.getMyTools(\n      //         ztickyFolder,\n      //         refresh\n      //       );\n      //       myTools = tileFolders.map((folder) => {\n      //         return {\n      //           title: folder.tile ? folder.tile.title : folder.name,\n      //           tile: folder.tile,\n      //         };\n      //       });\n      //     } else {\n      //       myTools = properties.tiles.map((tile) => {\n      //         if (!tile) return null;\n\n      //         return { title: tile.title, tile };\n      //       });\n      //     }\n\n      //     queueCount--;\n      //     if (queueCount === 0) setRefresing(false);\n      //     setMyTools(myTools);\n      //     setLayouts(layouts);\n      //   })\n      //   .catch((error) => {\n      //     queueCount--;\n      //     if (queueCount <= 0) setRefresing(false);\n      //     errors.push({ context: \"OfficeGraph.initStorage()\", error });\n      //     setErrors(errors);\n      //   });\n    } catch (error) {\n      errors.push({ context: \"initGraph\", error });\n      setErrors(errors);\n    }\n  }\n\n  function matchFilter(tile) {\n    if (!filter) return true;\n    var match =\n      tile &&\n      tile.title &&\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.inShort &&\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.subTitle &&\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n\n    return match;\n  }\n\n  function matchTeam(team) {\n    var include = true;\n    if (tags.length > 0) {\n      include = false;\n      tags.forEach((tag) => {\n        switch (tag.id) {\n          case \"sharepoint\":\n            if (team.hasSharePoint) {\n              include = true;\n            }\n            break;\n          case \"teams\":\n            if (team.hasTeams) {\n              include = true;\n            }\n\n            break;\n          case \"yammer\":\n            if (team.hasYammer) {\n              include = true;\n            }\n            break;\n          case \"private\":\n            if (team.visibility === \"Private\") {\n              include = true;\n            }\n            break;\n          case \"public\":\n            if (team.visibility === \"Public\") {\n              include = true;\n            }\n            break;\n          default:\n            break;\n        }\n      });\n    }\n    if (!include) return false;\n    if (!filter) return true;\n    var details = team.data && team.data.details ? team.data.details : {};\n    var channels = team.data && team.data.channels ? team.data.channels : [];\n    var match =\n      details.displayName &&\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        details.description &&\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    channels.forEach((channel) => {\n      if (!match) {\n        match =\n          channel.displayName &&\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n      if (!match) {\n        match =\n          channel.description &&\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n    });\n\n    return match;\n  }\n  function persistLayouts(layouts) {\n    console.log(\"persistLayouts\");\n\n    writeLayouts(CONTEXTPATH, contextFileName(), { layouts, myTeams });\n    //setLayouts(layouts);\n    // var tiles = myTools.map((tool) => {\n    //   return tool.tile;\n    // });\n    // OfficeGraph.writeLayouts(ztickyFolder, layouts, { tiles })\n    //   .then()\n    //   .catch((error) => {\n    //     errors.push({ context: \"  OfficeGraph.writeLayouts()\", error });\n    //     setErrors(errors);\n    //   });\n  }\n\n  var filteredTiles = !filter && tags.length === 0 ? tiles : [];\n  var filteredMyTools = !filter && tags.length === 0 ? myTools : [];\n  var filteredMemberShips = !filter && tags.length === 0 ? memberships : [];\n  var filteredSiteLinks = !filter && tags.length === 0 ? [] : [];\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\n  if (filter || tags.length > 0) {\n    tiles.forEach((tile) => {\n      if (matchFilter(tile)) {\n        filteredTiles.push(tile);\n      }\n    });\n    myTools.forEach((folder) => {\n      if (matchFilter(folder.tile)) {\n        filteredMyTools.push(folder);\n      }\n    });\n\n    memberships.forEach((team) => {\n      if (matchTeam(team)) {\n        filteredMemberShips.push(team);\n      }\n    });\n\n    // if (\n    //   searchInfo &&\n    //   searchInfo[\"search-for\"] &&\n    //   searchInfo[\"search-for\"] === filter\n    // )\n    //   return;\n\n    // searchInfo = {\n    //   \"search-for\": filter,\n    //   \"found-memberships\": filteredMemberShips.length,\n    //   \"found-tiles\": filteredMyTools.length,\n    // };\n\n    if (logSearchTimer) {\n      console.log(\"Postponing search trace\");\n      clearTimeout(logSearchTimer);\n    }\n    console.log(\"Timeing search trace\");\n    logSearchTimer = setTimeout(() => {\n      console.log(\"sending search trace\");\n      trace(EVENT.SEARCHING, searchInfo);\n      logSearchTimer = null;\n    }, 1000);\n  }\n\n  const dropdownStyles = {\n    dropdown: { width: 300 },\n  };\n\n  if (!props || (!props.auth && props.auth.user)) {\n    return (\n      <div>\n        <h1>Sorry - You cannot get in here</h1>\n        {JSON.stringify(\n          props && props.auth && props.auth.error ? props.auth.error : \"\"\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      {!inFrame && config.components.header}\n      {/* <CommandBar\n        // items={_items}\n        // overflowItems={_overflowItems}\n        // overflowButtonProps={overflowProps}\n        farItems={[\n          // {\n          //   key: \"tile\",\n          //   text: \"Grid view\",\n          //   // This needs an ariaLabel since it's icon-only\n          //   ariaLabel: \"Filter view\",\n          //   iconOnly: true,\n          //   iconProps: { iconName: \"Filter\" },\n          //   onClick: () => {\n          //     if (showFilterOptions) {\n          //       setFilter(\"\");\n          //     }\n          //     setShowFilterOptions(!showFilterOptions);\n          //   }\n          // }\n        ]}\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n      /> */}\n      <div style={{ paddingRight: \"20px\", paddingLeft: \"20px\" }}>\n        {\" \"}\n        {errors.length !== 0 && (\n          <div>\n            <ViewErrors errors={errors} />\n          </div>\n        )}\n        {progress && (\n          <div\n            style={{\n              backgroundColor: \"white\",\n              width: \"100vw\",\n              position: \"fixed\",\n              top: \"0px\",\n              zIndex: 2,\n            }}\n          >\n            <ProgressIndicator\n              percentComplete={progressPercent}\n              xlabel=\"Example title\"\n              xdescription={progress}\n            />\n          </div>\n        )}\n        <img\n          style={{\n            display: \"none\",\n            height: \"64px\",\n            margin: \"13px\",\n            position: \"fixed\",\n            bottom: \"0px\",\n            right: \"0px\",\n          }}\n          src={titlegraphics}\n        ></img>\n        {!isZoomed && (\n          <div style={{ display: \"flex\" }}>\n            {\" \"}\n            <div\n              style={{\n                display: \"xnone\",\n                paddingRight: \"8px\",\n                position: \"fixed\",\n                bottom: \"0px\",\n                backgroundColor: \"white\",\n              }}\n            >\n              {showTabFeature && (\n                <div>\n                  <i\n                    style={{ cursor: \"pointer\", padding: \"4px\" }}\n                    className=\"ms-Icon ms-Icon--Refresh\"\n                    onClick={() => {\n                      initGraph(true);\n                    }}\n                    aria-hidden=\"true\"\n                  ></i>{\" \"}\n                  {refreshing && <>Loading</>}\n                </div>\n              )}\n            </div>\n            {!inFrame && (\n              <div\n                style={{\n                  position: \"fixed\",\n                  right: 0,\n                  top: 0,\n                  zIndex: 32,\n                  marginRight: \"16px\",\n                }}\n              >\n                <div style={{ display: \"flex\" }}>\n\n                {/* <div style={{ padding: \"16px\", marginTop: \"0px\" }}>Contexts</div> */}\n<div style={{ padding: \"0px\", marginLeft: \"8px\",marginTop:\"12px\", flexGrow: 1 ,minWidth:\"300px\"}}>\n<TextField\n                    autoFocus={true}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Filter \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n  </div>\n                <div style={{ marginLeft: \"16px\",marginTop:\"12px\", flexGrow: 0 }}>\n                  \n                      <Dropdown\n                        disabled={showTable}\n                        placeholder=\"Select context\"\n                        selectedKey={selectedContext}\n                        xlabel=\"View as\"\n                        onChanged={(option, index) => {\n                          setSelectedContext(option.key)\n                         // setTileSize(option.key);\n                          //debugger\n                        }}\n                        options={\n                          contexts.map((text)=>{\n                          return {key:text,text}\n                          })\n                          }\n                        styles={dropdownStyles}\n                      />\n                    </div>\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>Edit</div>\n                  <div style={{ marginTop: \"16px\" }}>\n                    <Toggle\n                      checked={editMode}\n                      onChange={(e, checked) => {\n                        setEditMode(checked);\n                        setRefreshCounter(refreshCounter + 1);\n                      }}\n                    />\n                  </div>\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                    Details\n                  </div>\n                  <div style={{ marginTop: \"16px\" }}>\n                    <Toggle\n                      checked={showDetails}\n                      onChange={(e, checked) => {\n                        setShowDetails(checked);\n                        setRefreshCounter(refreshCounter + 1);\n                      }}\n                    />\n                  </div>\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                    Catalogue\n                  </div>\n                  <div style={{ marginTop: \"16px\" }}>\n                    <Toggle\n                      checked={showCatalogue}\n                      onChange={(e, checked) => {\n                        setShowCatalogue(checked);\n                        setRefreshCounter(refreshCounter + 1);\n                      }}\n                    />\n                  </div>\n                </div>\n              </div>\n            )}\n            <div style={{ flexGrow: \"1\" }}>\n              <div\n                style={{\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  marginTop: \"8px\",\n                }}\n              >\n                <div style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}>\n                  {/* <TextField\n                    autoFocus={true}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  /> */}\n\n                  {/* */}\n                </div>{\" \"}\n                {/* <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        placeholder=\"Select an area\"\n                        label=\"Area\"\n                        onChanged={(option, index) => {\n                          readGrid(option.key.api, option.key.id);\n                          setTableUrl(option.key.web);\n                          setTableApiSelected(option.key.api);\n                          setSelectedGroup(\"\");\n                          //debugger\n                        }}\n                        xxselectedKey={tableApiSelected} //\"\"\n                        options={config.options}\n                        styles={dropdownStyles}\n                      />\n                    </div>\n                    <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        placeholder=\"Select a group\"\n                        label=\"Group\"\n                        onChanged={(option, index) => {\n                          setSelectedGroup(option.key);\n                        }}\n                        selectedKey={selectedGroup}\n                        options={groups ? groups.map(group => {\n                          return {\n                            key: group.groupSetting.title,\n                            text: group.groupSetting.title\n                          };\n                        }):[]}\n                        styles={dropdownStyles}\n                      />\n                    </div>\n\n                    <div style={{ marginLeft: \"16px\", flexGrow: 0 }}>\n                      <Dropdown\n                        disabled={showTable}\n                        placeholder=\"Select tile size\"\n                        selectedKey={tileSize}\n                        label=\"View as\"\n                        onChanged={(option, index) => {\n                          setTileSize(option.key);\n                          //debugger\n                        }}\n                        options={[\n                          {\n                            key: 0,\n                            text: \"Tile\"\n                          },\n                          {\n                            key: 1,\n                            text: \"Small\"\n                          }\n                        ]}\n                        styles={dropdownStyles}\n                      />\n                    </div> */}\n              </div>\n              <ToolboxLayout\n                tools={myTools}\n                layouts={layouts}\n                persist={persistLayouts}\n                editMode={editMode}\n                getPin={getPin}\n                onRemovePin={removePin}\n                onTileClick={(tile) => {\n                  setCurrentTile(tile);\n                  setIsZoomed(true);\n                }}\n              />\n\n              {/* {siteUrl && (\n                 \n                    <h3>Which tools do you find good for this site?</h3>\n                    <div>{siteUrl.hostname}</div>\n                    <TextField\n                      label=\"Label\"\n                      placeholder=\"Enter label for this link\"\n                      value={siteUrlLabel}\n                      onChange={(e, value) => {\n                        setSiteUrlLabel(value);\n                      }}\n                    ></TextField>\n                    <TextField\n                      label=\"URL\"\n                      placeholder=\"Enter URL\"\n                      value={siteUrlHref}\n                      onChange={(e, value) => {\n                        setSiteUrlHref(value);\n                      }}\n                    ></TextField>\n                    <PrimaryButton\n                      text=\"Share link\"\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\n                    />\n                  </PivotItem>\n                )} */}\n              {/* <PivotItem\n                  key=\"catalogue\"\n                  headerText=\"Catalogue\"\n                  itemCount={filteredTiles.length}\n                > */}\n              {showTable && (\n                <>\n                  <div style={{ textAlign: \"right\" }}>\n                    <i\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\n                      class=\"ms-Icon ms-Icon--OpenInNewWindow\"\n                      onClick={() => {\n                        window.open(tableUrl, \"_blank\");\n                      }}\n                      aria-hidden=\"true\"\n                    ></i>\n                  </div>\n                  <iframe\n                    style={{\n                      border: \"0\",\n                      height: \"calc(100vh - 150px\",\n                      width: \"95vw\",\n                    }}\n                    src={tableUrl}\n                  ></iframe>\n                </>\n              )}\n              {showCatalogue && showTabFeature && memberships.length > 0 && (\n                <div>\n                  <ReactTags\n                    placeholder=\"Filter by tag, like Yammer, Teams ...\"\n                    autofocus={false}\n                    tags={tags}\n                    suggestions={[\n                      {\n                        name: \"Teams\",\n                        id: \"teams\",\n                      },\n                      {\n                        name: \"SharePoint\",\n                        id: \"sharepoint\",\n                      },\n                      {\n                        name: \"Yammer\",\n                        id: \"yammer\",\n                      },\n                      {\n                        name: \"Private\",\n                        id: \"private\",\n                      },\n                      {\n                        name: \"Public\",\n                        id: \"public\",\n                      },\n                    ]}\n                    handleDelete={(i) => {\n                      const tgs = tags.slice(0);\n                      tgs.splice(i, 1);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                    handleAddition={(tag) => {\n                      var tgs = [].concat(tags, tag);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                  /> \n                <ViewTeams\n                  onSaveTeam={addPin}\n                  refreshCounter={refreshCounter}\n                  tiles={filteredTiles}\n                  details={showDetails}\n                  memberShips={filteredMemberShips}\n                  filter={filter}\n                  highlightStyle={{ backgroundColor: \"yellow\" }}\n                /></div>\n              )}\n              {!showTable && !showTabFeature && (\n                <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                  {filteredTiles.length === 0 && (\n                    <div>\n                      <h2>Sorry. No matches for \"{filter}\"</h2>\n                      {/* <h1>\n                        <a href=\"https://christianiabpos.sharepoint.com/sites/intranets-tools#missing-a-link\">\n                          Request a link\n                        </a>\n                      </h1> */}\n                    </div>\n                  )}\n                  {filteredTiles.map((tile, key) => {\n                    if (selectedGroup) {\n                      var match = false;\n\n                      if (!tile.references) return null;\n                      tile.references.forEach((r) => {\n                        if (r.title === selectedGroup) {\n                          match = true;\n                        }\n                      });\n                      if (!match) return null;\n                    }\n                    return (\n                      <AppSuperTile\n                        tileSize={tileSize}\n                        key={key}\n                        filter={filter}\n                        highlightStyle={{\n                          backgroundColor: \"yellow\",\n                          color: \"#333\",\n                        }}\n                        tile={tile}\n                        onPinnedClicked={(props) => {\n                          if (props.tile) {\n                            addPin(props.tile);\n                          }\n                        }}\n                        onClick={(tile) => {\n                          if (window.amplitude) {\n                            if (\n                              props &&\n                              props.auth &&\n                              props.auth.user &&\n                              props.auth.user.userPrincipalName\n                            )\n                              window.amplitude\n                                .getInstance()\n                                .identify(props.auth.user.userPrincipalName);\n                            window.amplitude\n                              .getInstance()\n                              .logEvent(\"tool\", tile);\n                          }\n                          if (tile.jumpto && !tile.messageBeforeLaunch) {\n                            return window.open(tile.jumpto, \"_blank\");\n                          }\n                          setCurrentTile(tile);\n                          setIsZoomed(true);\n                        }}\n                      />\n                    );\n                  })}\n                </div>\n              )}\n\n              {/* \n\n              */}\n            </div>\n            {showFilterOptions && (\n              <div\n                style={{\n                  borderLeft: \"1px solid #dddddd\",\n                  borderTop: \"1px solid #dddddd\",\n                  padding: \"8px\",\n                  float: \"right\",\n                  minWidth: \"300px\",\n                }}\n              >\n                <div style={{ padding: \"0px\" }}>\n                  <TextField\n                    label=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Filter the list of tools\"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      {props && props.auth && props.auth.user && (\n        <div style={{ textAlign: \"center\" }}>\n          Your are signed in as \"{props.auth.user.displayName}\" with upn{\" \"}\n          {props.auth.user.userPrincipalName}\". Visit your Office profile at\n          &nbsp;\n          <a href=\"https://portal.office.com/account/#apps\" target=\"_blank\">\n            https://portal.office.com/account/#apps\n          </a>\n        </div>\n      )}\n    </div>\n  );\n\n  function contextFileName() {\n    var name = props.context ? props.context : \"default\";\n    return `${name}.json`;\n  }\n}\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\nimport React, { Component, useState, useEffect } from \"react\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport \"./App.css\";\nimport \"./css/normalize.css\";\nimport \"./css/webflow.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\n\n\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\nimport { Toggle } from \"@fluentui/react/lib/Toggle\";\n\nimport config from \"./config\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\nimport { running } from \"animejs\";\n\nimport {verifyAccessForLanuchPad} from \"./helpers/LaunchPad\"\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nexport default function Onboard(props) {\n  const [checkMe, setCheckMe] = useState(\"pending\");\n  const [checkMemberships, setCheckMemberships] = useState(\"pending\");\n  const [checkTeam, setCheckTeam] = useState(\"pending\");\n  const [checkMyExtention, setCheckMyExtention] = useState(\"pending\");\n  const [checkOneDrive, setCheckOneDrive] = useState(\"pending\");\n  const [checkOneDriveFiles, setCheckOneDriveFiles] = useState(\"pending\");\n  \n\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n\n  const inFrame = inIframe();\n\n  useEffect(() => {\n    async function run() {\n      await verifyAccessForLanuchPad(setCheckMe, setCheckMyExtention, setCheckOneDrive, setCheckOneDriveFiles, setCheckMemberships, setCheckTeam);\n    }\n    run();\n  }, []);\n\n  return (\n    <div>\n      <div className=\"OnboardingContainer\" dir=\"ltr\">\n        {!inFrame && config.components.header}\n        \n        {/* <div className=\"ms-fontSize-32\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\n          Checking is everything have been setup for you\n        </div> */}\n       \n        {/* <div>\n          <div className=\"ms-fontSize-20\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\n          <p >jumpto365 are committed to leave your data within your own system, what is yours stay with you. \n          We do not copy any of your information what so ever, period!</p>\n\n           <p>But to make our app work for you, we need your organisation to trust us with the following areas</p>\n\n          \n          </div>\n          <p className=\"ms-fontSize-20\">Allow access to the following areas</p>\n          <ul>\n            <li>\n              <p className=\"ms-fontWeight-bold\">Read and write access to your profile and OneDrive (User.ReadWrite.All)</p>\n              <p>\n                We need this permission to be able to store your preferences as\n                well as your cached data on your profile, and access to store data into your OneDrive.\n              </p>\n              <p>\n                That in order to be able to give you the best performance and to\n                comply with good data pricavy.\n              </p>\n            </li>\n            <li>\n              <p className=\"ms-fontWeight-bold\">Read access to your Groups (Group.Read.All)</p>\n              <p>\n                We need this permission to be able to read details about your\n                group membership and the name, description and tab on your channels in Teams \n              </p>\n            </li>\n          </ul>\n        </div> */}\n        <div>\n          <p className=\"ms-fontSize-20\">Verifying access</p>\n          <ul>\n            <li>Checking access to your profile: ({checkMe})</li>\n            <li>Checking access to your extension: ({checkMyExtention})</li>\n            <li>Checking access to your memberships: ({checkMemberships})</li>\n            <li>Checking access to your teams: ({checkTeam})</li>\n            <li>\n              Checking access to your OneDriver folders: ({checkOneDrive})\n            </li>\n            <li>\n              Checking access to the OneDrive files which we maintain: ({checkOneDriveFiles})\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}","/****\n * \n * \n *  version \n *  1.0 \n * \n * \n * \n */\nimport Axios from \"axios\";\nimport moment from \"moment\";\nexport function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nconst GETACCESSTOKEN = \"getAccessToken\";\nconst RESTOREURL = \"restoreUrl\";\nconst GETGRAPHUSER = \"getGraphUser\";\nconst LOGIN = \"login\";\nconst ACCESSTOKEN = \"access_token\";\nconst ACCESSEXPIRES = \"access_expires\";\n\nfunction isAccessTokenExpired() {\n  try {\n    var exp = sessionStorage.getItem(ACCESSEXPIRES);\n    var expiresIn = moment(exp);\n    var now = moment();\n    var x = now.diff(expiresIn);\n    return x > 0 ? true : false;\n  } catch (error) {\n    return true;\n  }\n}\n\n/**\n * Based on session storage - if no auth token is present, or if is to old, a auth sequence is initiated\n * @param {*} config \n * @param {*} callBackNotifyIfInteractionIsRequired \n */\nexport function authenticate(config, callBackNotifyIfInteractionIsRequired) {\n  // https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow\n\n  return new Promise((resolve, reject) => {\n    var redirect_uri =\n      (window.location.hostname === \"localhost\"\n        ? window.location.protocol\n        : \"https:\") +\n      \"//\" +\n      window.location.hostname +\n      (window.location.port !== 80 &&\n      window.location.port !== 443 &&\n      window.location.port !== \"\"\n        ? \":\" + window.location.port\n        : \"\") +\n      \"/\";\n    // window.location.pathname;\n\n    var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\n    var client_id = config.clientId;\n    var response_type = \"id_token\";\n    var response_mode = \"fragment\";\n    var scope = config.scopes;\n\n    var seq = \"\"; // sessionStorage.getItem(\"authseq\");\n    var search = getSearchParametersFromHash(window.location.href);\n\n    var search2 = getSearchParametersFromHRef(window.location.href);\n    //debugger\n\n    if (search.id_token) {\n      seq = GETACCESSTOKEN;\n    } else if (search.access_token) {\n      seq = RESTOREURL;\n    } else if (search.login) {\n      seq = LOGIN;\n    } else if (seq === \"\") {\n      if (sessionStorage.getItem(ACCESSTOKEN)) {\n        seq = isAccessTokenExpired() ? GETACCESSTOKEN : GETGRAPHUSER;\n      } else {\n        seq = GETACCESSTOKEN;\n      }\n    }\n\n    if (search.error || search2.error) {\n      var e = search.error ? search.error : search2.error;\n      var handled = false;\n      switch (e) {\n        case \"interaction_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired();\n          }\n          sessionStorage.removeItem(\"accesstoken\");\n          sessionStorage.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&response_type=${response_type}&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=openid&nonce=1`;\n          window.location.href = url;\n          return;\n          break;\n        case \"consent_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired();\n          }\n          //debugger;\n          sessionStorage.removeItem(\"accesstoken\");\n          sessionStorage.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&prompt=consent&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=openid&nonce=1`;\n          window.location.href = url;\n          return;\n          break;\n        case \"invalid_request\":\n          \n          break\n        default:\n          if (sessionStorage.setItem(\"returnto\", \"/\"))\n            window.location.href = \"#login\";\n          return;\n          handled = true;\n          break;\n      }\n      if (!handled) {\n        alert(\n          search.error_description\n            ? search.error_description\n            : search2.error_description\n        );\n        //window.location.href = sessionStorage.getItem(\"returnto\");\n        reject(search.error_description)\n        return;\n      }\n    }\n\n    switch (seq) {\n      case LOGIN:\n        sessionStorage.setItem(\"returnto\", window.location.href);\n      \n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n        window.location.href = url;\n        return;\n        break;\n      case GETACCESSTOKEN:\n        sessionStorage.setItem(\"returnto\", window.location.href);\n    \n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}`;\n        window.location.href = url;\n        return;\n        break;\n      case GETGRAPHUSER:\n        sessionStorage.removeItem(\"returnto\");\n\n        Axios.get(\"https://graph.microsoft.com/v1.0/me\", {\n          headers: {\n            \"content-type\": \"application/json\",\n            authorization: `Bearer ${sessionStorage.getItem(ACCESSTOKEN)}`,\n          },\n        })\n          .then((result) => {\n            resolve({ user: result.data });\n          })\n          .catch((error) => {\n            var txt = error.response.data.error.message;\n            if (\n              error &&\n              error.response &&\n              error.response.data &&\n              error.response.data.error\n            ) {\n              //alert(error.response.data.error.message)\n              resolve({ error: error.response.data.error.message });\n            } else {\n              resolve({ error });\n            }\n          });\n        break;\n\n      case RESTOREURL:\n        if (search.access_token) {\n          sessionStorage.setItem(ACCESSTOKEN, search.access_token);\n\n          var expires = moment().add(search.expires_in, \"s\");\n\n          sessionStorage.setItem(ACCESSEXPIRES, expires.toISOString());\n          if (sessionStorage.getItem(\"returnto\"))\n            window.location.href = sessionStorage.getItem(\"returnto\");\n          return;\n        } else {\n          window.location.reload();\n        }\n        resolve();\n        break;\n\n      default:\n        resolve({\n          error:\n            \"Sorry to have put you in this situation, but our authentication logic is not able to detect the next step to taka so we cannot let you in\",\n        });\n        break;\n    }\n  });\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport Onboard from \"./Onboard\";\nimport config from \"./config\";\nimport { authenticate } from \"./authenticate\";\n\nimport { FluentCustomizations } from \"@uifabric/fluent-theme\";\nimport { Customizer, mergeStyles, Fabric } from \"office-ui-fabric-react\";\nimport { loadTheme } from \"@fluentui/react\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\n\nimport { Router, Link } from \"@reach/router\";\nimport {\n  MessageBarButton,\n  DefaultButton,\n} from \"office-ui-fabric-react/lib/Button\";\n\n\n\nexport default class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, info) {\n    // You can also log the error to an error reporting service\n    this.setState({ error, info });\n    console.log(\"componentDidCatch\", error, info);\n    //logErrorToMyService(error, info);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return (\n        <div className=\"pageBody\">\n          <h1 className=\"errorCenterHeader\">\n            Sorry! Something not working as expected\n          </h1>\n          {this.state.error && this.state.error.message && (\n            <h2>{this.state.error.message}</h2>\n          )}\n          <div className=\"errorCenterHeader\">\n            <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                primary\n                text=\"Visit our Help Center\"\n                onClick={() => {\n                  window.open(\n                    \"https://jumpto365.zendesk.com/hc/en-us\",\n                    \"_blank\"\n                  );\n                }}\n              />\n            </div>\n            <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                text=\"Check service availabiliy\"\n                onClick={() => {\n                  window.open(\"https://uptime.com/s/overview\", \"_blank\");\n                }}\n              />\n            </div>\n            {/* <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                text=\"File a support request\"\n                onClick={() => {\n                  if (window.zE) {\n                    zE(function() {\n                      debugger;\n                    });\n                  }\n                }}\n              />\n            </div> */}\n\n            <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                text=\"View error details\"\n                onClick={() => {\n                  this.setState({ viewDetails: true });\n                }}\n              />\n            </div>\n          </div>\n          {this.state.info &&\n          this.state.info.componentStack &&\n          this.state.viewDetails ? (\n            <div>\n              <textarea\n                style={{ width: \"100%\" }}\n                readOnly\n                rows=\"30\"\n                cols=\"80\"\n                value={this.state.info.componentStack}\n              />{\" \"}\n            </div>\n          ) : null}\n        </div>\n      );\n    }\n\n    return this.props.children\n  }\n}\n\nvar x = loadTheme({\n  defaultFontStyle: {\n    fontFamily: \"Monaco, Menlo, Consolas\",\n    fontWeight: \"regular\",\n  },\n  fonts: {\n    small: {\n      fontSize: \"11px\",\n    },\n    medium: {\n      fontSize: \"13px\",\n    },\n    large: {\n      fontSize: \"20px\",\n      fontWeight: \"semibold\",\n    },\n    xLarge: {\n      fontSize: \"22px\",\n      fontWeight: \"semibold\",\n    },\n  },\n});\n\n// // Inject some global styles\n// mergeStyles({\n//   selectors: {\n//     ':global(body), :global(html), :global(#root)': {\n//       margin: 0,\n//       padding: 0,\n//       height: '100vh'\n//     }\n//   }\n// });\nasync function start() {\n  var auth = await authenticate(config, () => {\n    // this is where you can send a signal to a host that intercati ons is required\n  }).catch((error) => {\n    console.log(error);\n    document.getElementById(\"root\").innerHTML = error;\n    return;\n  });\n  if (auth && auth.user) {\n    who(auth.user.userPrincipalName);\n    const key = \"HASLANDED\";\n\n    var landed = sessionStorage.getItem(key);\n    if (!landed) {\n      trace(EVENT.LANDING);\n      sessionStorage.setItem(key, \"1\");\n    }\n  }\n  // const key = \"ONBOARDING\";\n\n  // var landed = sessionStorage.getItem(key);\n  // if (!landed) {\n  //   trace(EVENT.ONBOARDING);\n  //   sessionStorage.setItem(key, \"1\");\n  // }\n\n  ReactDOM.render(\n    <Customizer {...FluentCustomizations}>\n      <Fabric theme={x}>\n        <ErrorBoundary auth={auth}>\n        <Router>\n          <Onboard path=\"/check\" />\n          <App auth={auth} path=\"/\" />\n          <App auth={auth} path=\"/ctx/:context\" />\n          <App auth={auth} path=\"/ctx\" />\n        </Router>\n        </ErrorBoundary>\n      </Fabric>\n    </Customizer>,\n    document.getElementById(\"root\")\n  );\n}\n\nstart();\n"],"sourceRoot":""}