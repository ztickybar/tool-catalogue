(this["webpackJsonptool-catalogue"]=this["webpackJsonptool-catalogue"]||[]).push([[0],{124:function(e,t,n){e.exports=n(179)},129:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},165:function(e,t){},166:function(e,t){},172:function(e,t){},174:function(e,t){},179:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(35),o=n.n(i),c=(n(129),n(32)),l=n(2),s=n.n(l),u=n(13),p=n(12);n(131),n(132),n(133),n(134);var d=n(27),f=n.n(d),m=n(55),h=n.n(m),v=function(e){return e&&e.references?a.a.createElement("div",{className:"tags",style:{display:"flex",flexWrap:"wrap"}},e.references.map((function(e,t){return a.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px",backgroundColor:e.color,color:e.textColor}},e.title)}))):null},x=function(e){if(!e.text)return null;if(!e.filter)return e.text;var t=e.text.toLowerCase().indexOf(e.filter.toLowerCase());if(-1===t)return e.text;var n=e.text.substr(0,t),r=e.text.substr(t,e.filter.length),i=e.text.substr(t+e.filter.length);return a.a.createElement(a.a.Fragment,null,a.a.createElement("span",null,n),a.a.createElement("span",{style:e.style},r),a.a.createElement("span",null,i))},g=function(e){var t=e.tile?e.tile:{},n=Object(r.useState)(""),i=Object(p.a)(n,2);i[0],i[1];return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},a.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:300,maxHeight:300,overflow:"auto"}},a.a.createElement("div",{style:{cursor:"pointer"},xonClick:function(){e.onClick}},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{flexGrow:1}},a.a.createElement(x,{text:t.title,filter:e.filter,style:e.highlightStyle})," "),a.a.createElement("div",{style:{alignItems:"flex-end"}},a.a.createElement("i",{style:{cursor:"pointer"},class:e.isPinned?"ms-Icon ms-Icon--PinnedFill":"ms-Icon ms-Icon--Pinned",onClick:function(){e.onPinnedClicked&&e.onPinnedClicked(e)},"aria-hidden":"true"}))),a.a.createElement("div",{style:{textAlign:"center",margin:20,marginTop:40,height:120}},a.a.createElement("img",{style:{height:"auto",width:80},src:t.icon})),a.a.createElement(v,{references:t.references}))),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&a.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,rel:"noopener noreferrer",target:"_blank"},"Jump to"),t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,rel:"noopener noreferrer",target:"_blank"},"Details"))))},b=n(100),y=function(e){var t=e.tile?e.tile:{},n=Object(r.useState)(""),i=Object(p.a)(n,2),o=i[0],c=i[1],l=Object(r.useState)(null),s=Object(p.a)(l,2),u=s[0],d=s[1];return Object(r.useEffect)((function(){t.contentRef&&f.a.get(t.contentRef).then((function(e){var t=new b.QuillDeltaToHtmlConverter(e.data.ops);c(t.convert())})).catch((function(e){404!==e.response.status&&d(e.message)}))})),a.a.createElement(a.a.Fragment,null,u&&a.a.createElement("div",null,u),a.a.createElement("div",{onClick:e.onClose,style:{backgroundColor:t.color,color:t.textcolor,width:"100vw",height:"100vh",overflow:"auto"}},a.a.createElement("div",null,a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{minWidth:"10vw"}}," ",a.a.createElement("img",{style:{margin:"1vh",height:"auto",width:"10vw"},src:t.icon})),a.a.createElement("div",{style:{height:"10vh",width:"auto"}},a.a.createElement("div",{className:"fullSizeHeading",style:{padding:"3vh",fontSize:"5vh",textOverflow:"nowrap",whiteSpace:"no-wrap"}},t.title),a.a.createElement("div",{className:"fullSizeDescription",style:{paddingLeft:"3vh",fontSize:"3vh"}},t.inShort))),a.a.createElement("div",{style:{height:"80vh",overflow:"auto",backgroundColor:"#ffffff",color:"#000000",padding:"20px"}},a.a.createElement(v,{references:t.references}),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&a.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,target:"_blank"},"Jump to"),t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")),a.a.createElement("div",{dangerouslySetInnerHTML:{__html:o}})),a.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&a.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,target:"_blank"},"Jump to"),t.externalArticle&&a.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")))))},w=n(213),k=n(113),E=n(31),O=n(112),j=n(102),S=n(5),C=n(7);function T(){try{return window.self!==window.top}catch(e){return!0}}var P=function(){function e(t,n){Object(S.a)(this,e),this.options=n,this.msalApplication=t}return Object(C.a)(e,[{key:"getAccessToken",value:function(e){var t=this,n=this;return new Promise(function(){var r=Object(u.a)(s.a.mark((function r(a,i){var o,c,l,u,p,d,f,m;return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("undefined"!==typeof(o=e)&&(c=o.scopes),"undefined"!==typeof c&&0!==c.length||(c=t.options.scopes),0!==c.length){r.next=8;break}throw(l=new Error).name="EmptyScopes",l.message="Scopes cannot be empty, Please provide a scopes",l;case 8:if(n.msalApplication.handleRedirectCallback((function(e,t){if(e)return i(e)})),!t.msalApplication.getAccount()){r.next=42;break}return u={scopes:c},r.prev=11,r.next=14,t.msalApplication.acquireTokenSilent(u);case 14:p=r.sent,a(p.accessToken),r.next=40;break;case 18:if(r.prev=18,r.t0=r.catch(11),!(r.t0 instanceof E.a)){r.next=38;break}if(r.prev=21,!T()){r.next=29;break}return r.next=25,t.msalApplication.acquireTokenPopup(u);case 25:d=r.sent,a(d.accessToken),r.next=30;break;case 29:case 30:r.next=36;break;case 32:r.prev=32,r.t1=r.catch(21),i(r.t1);case 36:r.next=40;break;case 38:i(r.t0);case 40:r.next=60;break;case 42:if(r.prev=42,f={scopes:c},!T()){r.next=53;break}return r.next=47,t.msalApplication.loginPopup(f);case 47:return r.next=49,t.msalApplication.acquireTokenSilent(f);case 49:m=r.sent,a(m.accessToken),r.next=55;break;case 53:return n.msalApplication.loginRedirect(f),r.abrupt("return");case 55:r.next=60;break;case 57:r.prev=57,r.t2=r.catch(42),i(r.t2);case 60:case"end":return r.stop()}}),r,null,[[11,18],[21,32],[42,57]])})));return function(e,t){return r.apply(this,arguments)}}())}}]),e}(),I=n(163),A=(n(167),["User.Read.All","User.ReadWrite.All","mail.send","Files.ReadWrite.All"]),L={auth:{clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",redirectUri:window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,authority:"https://login.microsoftonline.com/common"}};new E.b(L).handleRedirectCallback((function(e,t){}));var N={authProvider:new P(new E.b(L),new j.MSALAuthenticationProviderOptions(A))};function R(){return O.a.initWithMiddleware(N)}function _(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,r){var a,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=R(),t.prev=1,t.next=4,a.api(e).get();case 4:return i=t.sent,t.abrupt("return",n(i));case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",r(t.t0));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,n){return t.apply(this,arguments)}}())}function W(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,r){var a,i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=R(),t.next=4,a.api("/me/drive/items/".concat(e.id,":/tile.xlsx:")).get();case 4:i=t.sent,f()({url:i["@microsoft.graph.downloadUrl"],method:"GET",responseType:"arraybuffer"}).then((function(e){var t=I.read(e.data,{type:"buffer"});if(!t.Sheets.ZTICKYBAR)return n(null);var r=I.utils.sheet_to_json(t.Sheets.ZTICKYBAR,{header:1,raw:!1}),a={};r.forEach((function(e){a[e[0]]=e[1]})),n(a)})),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),n(null);case 12:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,n){return t.apply(this,arguments)}}())}function F(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,r){var a,i,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,W(e);case 3:if(!(a=t.sent)){t.next=6;break}return t.abrupt("return",n(a));case 6:return i=R(),t.next=9,i.api("/me/drive/items/".concat(e.id,":/tile.json:")).get();case 9:o=t.sent,f.a.get(o["@microsoft.graph.downloadUrl"]).then((function(e){n(e.data)})),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),r(t.t0);case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n){return t.apply(this,arguments)}}())}function U(e){return new Promise((function(t,n){try{var r=URL.createObjectURL(e),a=new XMLHttpRequest;a.responseType="blob",a.onload=function(){var e=a.response,n=new FileReader;n.onload=function(){var e=n.result;t(e)},n.readAsDataURL(e)},a.open("GET",r),a.send()}catch(i){t(null)}}))}var B={me:function(){return _("/me")},rootSite:function(){return _("/sites/root")},initStorage:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r,a,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=R(),e.prev=1,e.next=4,r.api("/me/drive/root:/ZTICKYBAR").get();case 4:return a=e.sent,e.abrupt("return",t(a));case 8:if(e.prev=8,e.t0=e.catch(1),404!==e.t0.statusCode){e.next=24;break}return e.prev=11,i={name:"ZTICKYBAR",folder:{},"@microsoft.graph.conflictBehavior":"rename"},e.next=15,r.api("/me/drive/root/children").post(i);case 15:return o=e.sent,e.abrupt("return",t(o));case 19:return e.prev=19,e.t1=e.catch(11),e.abrupt("return",n(e.t1));case 22:e.next=25;break;case 24:return e.abrupt("return",n(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,8],[11,19]])})));return function(t,n){return e.apply(this,arguments)}}())},initTileStorage:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r,a,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=R(),e.prev=1,e.next=4,r.api("/me/drive/root:/ZTICKYBAR/tiles").get();case 4:return a=e.sent,e.abrupt("return",t(a));case 8:if(e.prev=8,e.t0=e.catch(1),404!==e.t0.statusCode){e.next=24;break}return e.prev=11,i={name:"tiles",folder:{},"@microsoft.graph.conflictBehavior":"rename"},e.next=15,r.api("/me/drive/root:/ZTICKYBAR:/children").post(i);case 15:return o=e.sent,e.abrupt("return",t(o));case 19:return e.prev=19,e.t1=e.catch(11),e.abrupt("return",n(e.t1));case 22:e.next=25;break;case 24:return e.abrupt("return",n(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,8],[11,19]])})));return function(t,n){return e.apply(this,arguments)}}())},addTile:function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(r,a){var i,o,c,l,p,d,m,v,x;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=R(),n.prev=1,o={name:t.title,folder:{},"@microsoft.graph.conflictBehavior":"replace"},n.next=5,i.api("/me/drive/items/".concat(e.id,"/children")).post(o);case 5:return c=n.sent,n.next=8,i.api("/me/drive/items/".concat(c.id,":/tile.json:/content")).put(t);case 8:return n.sent,l=h.a.keys(t),p=[],l.forEach((function(e){"references"!==e&&p.push([e,t[e]])})),d=I.utils.book_new(),m=I.utils.aoa_to_sheet(p),I.utils.book_append_sheet(d,m,"ZTICKYBAR"),v={bookType:"xlsx",bookSST:!1,type:"array"},x=I.write(d,v),n.next=19,i.api("/me/drive/items/".concat(c.id,":/tile.xlsx:/content")).put(x);case 19:return n.sent,f.a.request({responseType:"arraybuffer",url:t.icon,method:"get"}).then(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.api("/me/drive/items/".concat(c.id,":/image.png:/content")).put(t.data);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){})),n.abrupt("return",r(c));case 24:return n.prev=24,n.t0=n.catch(1),n.abrupt("return",a(n.t0));case 28:case"end":return n.stop()}}),n,null,[[1,24]])})));return function(e,t){return n.apply(this,arguments)}}())},getMyTools:function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(r,a){var i,o,c,l;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t){n.next=5;break}if(!(i=localStorage.getItem("mytools"))){n.next=5;break}return n.abrupt("return",r(JSON.parse(i)));case 5:return o=R(),n.next=8,o.api("/me/drive/items/".concat(e.id,"/children")).get();case 8:if(c=n.sent,l=0,0!==c.value.length){n.next=12;break}return n.abrupt("return",r(c.value));case 12:c.value.forEach(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l++,e.next=3,F(t);case 3:if(t.tile=e.sent,0!==--l){e.next=8;break}return localStorage.setItem("mytools",JSON.stringify(c.value)),e.abrupt("return",r(c.value));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),a(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e,t){return n.apply(this,arguments)}}())},teamMemberships:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var r,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],e.prev=1,(a=R()).api("/me/joinedTeams").get(function(){var e=Object(u.a)(s.a.mark((function e(i,o){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i){e.next=2;break}return e.abrupt("return",n(i));case 2:c=0,o.value.map(function(){var e=Object(u.a)(s.a.mark((function e(n){var i,o,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c++,e.prev=1,e.next=4,a.api("/groups/".concat(n.id,"/photo/$value")).get();case 4:return i=e.sent,e.next=7,U(i);case 7:o=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:return e.next=14,a.api("/teams/".concat(n.id)).get();case 14:return l=e.sent,e.next=17,a.api("/teams/".concat(n.id,"/channels")).version("beta").get();case 17:if(u=e.sent,r.push({key:n.id,text:n.displayName,title:n.description,data:{details:l,photo:o,channels:u.value}}),0!==--c){e.next=22;break}return e.abrupt("return",t(r.sort((function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}))));case 22:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",n(e.t0));case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}())}},D=n(215),G=n(111),z=function(e){return e&&e.errors?a.a.createElement("div",{className:"tags"},e.errors.map((function(e,t){return a.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px"}},"When trying ",e.context,", you got",JSON.stringify(e))}))):null},H=function(e){return e&&e.memberShips?a.a.createElement("div",{className:"tags",style:{padding:"4px",margin:"4px",fontSize:"16px",display:"flex",flexWrap:"wrap"}},e.memberShips.map((function(t,n){var r=t.data&&t.data.details?t.data.details.webUrl:"";if(r)var i=r.split("https://teams.microsoft.com/l/team/")[1].split("/conversations?"),o=r.split("groupId=")[1].split("&"),c=r.split("tenantId="),l=i[0],s=o[0],u=c[1],p="https://teams.microsoft.com/_?tenantId=".concat(u,"#/conversations/unknown?groupId=").concat(s,"&threadId=").concat(l,"&ctx=channel"),d="https://teams.microsoft.com/_?tenantId=".concat(u,"#/files/unknown?groupId=").concat(s,"&threadId=").concat(l,"&ctx=channel");var f=t.data&&t.data.details?t.data.details:{displayName:t.title},m=t.data?t.data.photo:null,h=t.data&&t.data.channels?t.data.channels:[];return a.a.createElement("div",{key:n,style:{padding:"10px",margin:"10px",fontSize:"16px",display:"flex",border:"1px solid #dddddd",minWidth:"450px",maxWidth:"450px"}},a.a.createElement("div",{style:{minWidth:"84px"}},m&&a.a.createElement("img",{src:m,style:{height:"64px",margin:"10px"}})),a.a.createElement("div",{tyle:{minWidth:"366px"}},a.a.createElement("div",{className:"ms-font-xxl",style:{padding:"8px"}},a.a.createElement(x,{text:f.displayName,filter:e.filter,style:e.highlightStyle})),a.a.createElement("div",null,a.a.createElement("a",{style:{padding:"8px"},href:p,rel:"noopener noreferrer",target:"_blank"},"Posts"),a.a.createElement("a",{style:{padding:"8px"},href:d,rel:"noopener noreferrer",target:"_blank"},"Files")),a.a.createElement("div",{style:{padding:"8px",margin:"4px",fontSize:"14px",display:"flex",flexWrap:"wrap"}},h.map((function(t,n){return a.a.createElement("div",{key:n,style:{padding:"3px"}},a.a.createElement(x,{text:t.displayName,filter:e.filter,style:e.highlightStyle}),t.description&&a.a.createElement(a.a.Fragment,null,"(",t.description,")"))})))))}))):null},M=n(217),q=n(211),J=n(210);function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}Object(k.a)();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement((function(){var e=Object(r.useState)(""),t=Object(p.a)(e,2),n=t[0],i=t[1],o=Object(r.useState)(""),l=Object(p.a)(o,2),d=l[0],m=l[1],v=Object(r.useState)([]),x=Object(p.a)(v,2),b=x[0],k=x[1],E=Object(r.useState)(!1),O=Object(p.a)(E,2),j=O[0],S=O[1],C=Object(r.useState)(null),T=Object(p.a)(C,2),P=T[0],I=T[1],A=Object(r.useState)({}),L=Object(p.a)(A,2),N=(L[0],L[1]),R=Object(r.useState)({}),_=Object(p.a)(R,2),W=_[0],F=_[1],U=Object(r.useState)([]),Y=Object(p.a)(U,2),Z=Y[0],$=Y[1],Q=Object(r.useState)(""),X=Object(p.a)(Q,2),V=X[0],ee=X[1],te=Object(r.useState)([]),ne=Object(p.a)(te,2),re=ne[0],ae=ne[1],ie=Object(r.useState)([]),oe=Object(p.a)(ie,2),ce=oe[0],le=(oe[1],Object(r.useState)("")),se=Object(p.a)(le,2),ue=se[0],pe=se[1],de=Object(r.useState)(""),fe=Object(p.a)(de,2),me=fe[0],he=fe[1],ve=Object(r.useState)(!1),xe=Object(p.a)(ve,2),ge=xe[0],be=xe[1];function ye(e){f.a.get(e).then((function(t){var n=t.data;i(n.titlegraphics);var r=[];if(n.grid){var a={},o={};n.grid.forEach((function(e){return e.forEach((function(e){e.groupSetting&&(a[e.groupSetting.title]={groupSetting:e.groupSetting,members:e.members},e.members&&e.members.forEach((function(t){var n=o[t]?o[t]:[];n.push(e.groupSetting),o[t]=n})))}))})),n.grid.forEach((function(t){return t.forEach((function(t){if(t.tile&&t.tile.title){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.tile);n.correlation=e+"#"+(n.key?n.key:n.title?n.title.toLowerCase():n.id);var a=o[t.id];n.references=a,r.push(n)}}))}))}k(h.a.sortBy(r,["title","href"]))}))}function we(e){return ke.apply(this,arguments)}function ke(){return(ke=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t&&(localStorage.removeItem("memberships"),localStorage.removeItem("mytools")),n=0,be(!0),e.next=6,B.initStorage();case 6:B.initTileStorage().then(function(){var e=Object(u.a)(s.a.mark((function e(r){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(r),n++,e.next=4,B.getMyTools(r,t);case 4:a=e.sent,0===--n&&be(!1),$(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){--n<=0&&be(!1),re.push({context:"OfficeGraph.initStorage()",error:e}),ae(re)})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),re.push({context:"initGraph",error:e.t0}),ae(re);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function Ee(e){var t=e.title&&-1!==e.title.toLowerCase().indexOf(d.toLowerCase());return t||(t=e.inShort&&-1!==e.inShort.toLowerCase().indexOf(d.toLowerCase())),t||(t=e.subTitle&&-1!==e.subTitle.toLowerCase().indexOf(d.toLowerCase())),t}Object(r.useEffect)((function(){we(),B.me().then((function(e){N(e),window.document.title=e.displayName+" Tools"})).catch((function(e){re.push({context:"OfficeGraph.me()",error:e}),ae(re)}));var e=function(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var r=n[1].split("&"),a=0;a<r.length;a++){var i=r[a].split("=");t[i[0]]=decodeURIComponent(i[1])}return t}(window.location.href);e.ztickyref&&ee(e.ztickyref),ye(e.src?e.src:"https://api.jumpto365.com/table/hexatown.com/PTO365")}),[]);var Oe=d?[]:b,je=d?[]:Z,Se=d?[]:ce,Ce=[],Te=V?new URL(V):null;return d&&(b.forEach((function(e){Ee(e)&&Oe.push(e)})),Z.forEach((function(e){Ee(e.tile)&&je.push(e)})),ce.forEach((function(e){(function(e){var t=e.data&&e.data.details?e.data.details:{},n=e.data&&e.data.channels?e.data.channels:[],r=t.displayName&&-1!==t.displayName.toLowerCase().indexOf(d.toLowerCase());return r||(r=t.description&&-1!==t.description.toLowerCase().indexOf(d.toLowerCase())),n.forEach((function(e){r||(r=e.displayName&&-1!==e.displayName.toLowerCase().indexOf(d.toLowerCase())),r||(r=e.description&&-1!==e.description.toLowerCase().indexOf(d.toLowerCase()))})),r})(e)&&Se.push(e)}))),a.a.createElement(a.a.Fragment,null,a.a.createElement("img",{style:{height:"64px",margin:"13px",position:"fixed",bottom:"0px",right:"0px"},src:n}),j&&a.a.createElement("div",null,a.a.createElement(y,{tile:P||(b?b[0]:null),onClose:function(){S(!1)}})),!j&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{style:{padding:"20px"}},a.a.createElement(w.a,{label:"Filter",value:d,onChange:function(e,t){m(t)},placeholder:"Filter the list of tools",iconProps:{iconName:"Filter"}})),a.a.createElement(D.a,{style:{padding:"20px"}},je.length>0&&a.a.createElement(G.a,{headerText:"Pinned",itemCount:je.length},a.a.createElement("div",{style:{marginLeft:"16px"}},a.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},class:"ms-Icon ms-Icon--Refresh",onClick:function(){we(!0)},"aria-hidden":"true"})," ",ge&&a.a.createElement(a.a.Fragment,null,"Loading"),a.a.createElement("a",{href:W.webUrl,target:"_blank"},a.a.createElement("i",{style:{cursor:"pointer",padding:"4px",color:"black"},class:"ms-Icon ms-Icon--OpenFolderHorizontal","aria-hidden":"true"})," ")),a.a.createElement("div",null,a.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},je.map((function(e,t){var n=e.tile?e.tile:{title:e.name,color:"#dddddd"};return a.a.createElement(g,{isPinned:!0,key:t,tile:n,filter:d,highlightStyle:{backgroundColor:"yellow"},onClick:function(e){I(e),S(!0)}})}))))),Te&&a.a.createElement(G.a,{headerText:"Site",itemCount:Ce.length},a.a.createElement("h3",null,"Which tools do you find good for this site?"),a.a.createElement("div",null,Te.hostname),a.a.createElement(w.a,{label:"Label",placeholder:"Enter label for this link",value:ue,onChange:function(e,t){pe(t)}}),a.a.createElement(w.a,{label:"URL",placeholder:"Enter URL",value:me,onChange:function(e,t){he(t)}}),a.a.createElement(M.a,{text:"Share link",disabled:!me&&!ue})),a.a.createElement(G.a,{headerText:"Global",itemCount:Oe.length},a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{marginLeft:"16px"}},a.a.createElement(q.a,{placeholder:"Select a catalogue option",label:"Catalogue",onChanged:function(e,t){ye(e.key.api)},xselectedKey:"https://api.jumpto365.com/table/hexatown.com/PTO365",options:[{key:"fruitsHeader",text:"Nets Group Periodic Tables",itemType:J.a.Header},{key:{id:"nets.eu/2019-q4",api:"https://api.jumpto365.com/table/nets.eu/2019-q4",web:"https://pro.jumpto365.com/@/nets.eu/2019-q4"},text:"One Tenant - Wave 1"},{key:{id:"nets.eu/digital-workplace",api:"https://api.jumpto365.com/table/nets.eu/digital-workplace",web:"https://pro.jumpto365.com/@/nets.eu/digital-workplace"},text:"Digital Workplace"},{key:{id:"nets.eu/group-tech-highlevel",api:"https://api.jumpto365.com/table/nets.eu/group-tech-highlevel",web:"https://pro.jumpto365.com/@/nets.eu/group-tech-highlevel"},text:"Group Tech Playbook"},{key:"divider_1",text:"-",itemType:J.a.Divider},{key:"jumpto365",text:"Generic Periodic Tables",itemType:J.a.Header},{key:{id:"hexatown.com/PTO365",api:"https://api.jumpto365.com/table/hexatown.com/PTO365",web:"https://pro.jumpto365.com/@/hexatown.com/PTO365"},text:"Office 365"},{key:{id:"jumpto365.com/ems5",api:"https://api.jumpto365.com/table/jumpto365.com/ems5",web:"https://pro.jumpto365.com/@/jumpto365.com/ems5"},text:"EMS"}],styles:{dropdown:{width:300}}}))," "),a.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},Oe.map((function(e,t){return a.a.createElement(g,{key:t,filter:d,highlightStyle:{backgroundColor:"yellow"},tile:e,onPinnedClicked:function(e){e.tile&&function(e){B.addTile(W,e).then(function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.getMyTools(W,!0);case 3:n=e.sent,$(n),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),re.push({context:"AddTile > myTools.push() ",error:e.t0}),ae(re);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){re.push({context:"OfficeGraph.addTile()",error:e}),ae(re)}))}(e.tile)},onClick:function(e){I(e),S(!0)}})})))),ce.length>0&&a.a.createElement(G.a,{headerText:"Teams",itemCount:Se.length},a.a.createElement(H,{memberShips:Se,filter:d,highlightStyle:{backgroundColor:"yellow"}})),0!==re.length&&a.a.createElement(G.a,{headerText:"Developer feedback",itemCount:re.length},a.a.createElement("div",null,a.a.createElement(z,{errors:re}))))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},91:function(e,t){}},[[124,1,2]]]);
//# sourceMappingURL=main.9875cf5f.chunk.js.map