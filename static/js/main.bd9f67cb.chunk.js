(this["webpackJsonptool-catalogue"]=this["webpackJsonptool-catalogue"]||[]).push([[0],{106:function(e,t){},123:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return y}));var a=n(87),r=n(19),o=n(5),i=n(7),c=n(48),l=n(31),s=n(50),u=n(0),p=n.n(u),d=n(25),f=n.n(d),m=n(66);n(205);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var b=Object(m.WidthProvider)(m.Responsive),v=function(e){function t(){return Object(o.a)(this,t),Object(c.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return p.a.createElement("div",{className:"toolbox__items__item",onClick:this.props.onTakeItem.bind(void 0,this.props.item)},this.props.item.i)}}]),t}(p.a.Component),y=(p.a.Component,function(t){function n(t){var i;return Object(o.a)(this,n),(i=Object(c.a)(this,Object(l.a)(n).call(this,t))).onBreakpointChange=function(e){i.setState((function(t){return{currentBreakpoint:e,toolbox:g({},t.toolbox,Object(r.a)({},e,t.toolbox[e]||t.toolbox[t.currentBreakpoint]||[]))}}))},i.onCompactTypeChange=function(){var e=i.state.compactType,t="horizontal"===e?"vertical":"vertical"===e?null:"horizontal";i.setState({compactType:t})},i.onTakeItem=function(e){i.setState((function(t){return{toolbox:g({},t.toolbox,Object(r.a)({},t.currentBreakpoint,t.toolbox[t.currentBreakpoint].filter((function(t){return t.i!==e.i})))),layouts:g({},t.layouts,Object(r.a)({},t.currentBreakpoint,[].concat(Object(a.a)(t.layouts[t.currentBreakpoint]),[e])))}}))},i.onPutItem=function(e){i.setState((function(t){return{toolbox:g({},t.toolbox,Object(r.a)({},t.currentBreakpoint,[].concat(Object(a.a)(t.toolbox[t.currentBreakpoint]||[]),[e]))),layouts:g({},t.layouts,Object(r.a)({},t.currentBreakpoint,t.layouts[t.currentBreakpoint].filter((function(t){return t.i!==e.i}))))}}))},i.onLayoutChange=function(t,n){var a,o;a="layouts",o=n,e.localStorage&&e.localStorage.setItem("rgl-8",JSON.stringify(Object(r.a)({},a,o))),i.props.persist&&i.props.persist(n),i.setState({layouts:n})},i.onNewLayout=function(){i.setState({layouts:{lg:x()}})},i.state={currentBreakpoint:"lg",compactType:"vertical",mounted:!1,layouts:t.layouts?t.layouts:{lg:t.tools?t.tools.map((function(e,t){return{x:0,y:t,w:3,h:3,i:t.toString(),static:0}})):t.initialLayout},toolbox:{lg:[]}},i}return Object(s.a)(n,t),Object(i.a)(n,[{key:"componentDidMount",value:function(){this.setState({mounted:!0})}},{key:"generateDOM",value:function(){var e=this,t=this;return f.a.map(this.state.layouts[this.state.currentBreakpoint],(function(n){var a=t.props.tools&&t.props.tools[n.i]&&t.props.tools[n.i].tile?t.props.tools[n.i].tile:{title:n.i};return p.a.createElement("div",{style:{backgroundColor:a.color,color:a.textcolor,cursor:e.props.editingLayout?"default":"pointer"},onClick:function(){e.props.onTileClick&&!e.props.editingLayout&&e.props.onTileClick(a)},key:n.i,className:n.static?"static":""},p.a.createElement("img",{src:a.icon,style:{height:"100%",maxHeight:"128px",width:"auto",padding:"8px"}}),p.a.createElement("span",{className:"text"},a.title," "))}))}},{key:"render",value:function(){return p.a.createElement("div",null,p.a.createElement(b,Object.assign({},this.props,{layouts:this.state.layouts,onBreakpointChange:this.onBreakpointChange,onLayoutChange:this.onLayoutChange,measureBeforeMount:!1,useCSSTransforms:this.state.mounted,compactType:this.state.compactType,preventCollision:!this.state.compactType}),this.generateDOM()))}}]),n}(p.a.Component));function x(){return f.a.map(f.a.range(0,25),(function(e,t){var n=Math.ceil(4*Math.random())+1;return{x:2*f.a.random(0,5)%12,y:Math.floor(t/6)*n,w:2,h:n,i:t.toString(),static:Math.random()<.05}}))}y.defaultProps={className:"layout",rowHeight:30,onLayoutChange:function(){},cols:{lg:12,md:10,sm:6,xs:4,xxs:2},initialLayout:x()}}).call(this,n(24))},140:function(e,t,n){e.exports=n(206)},145:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){},180:function(e,t){},181:function(e,t){},187:function(e,t){},189:function(e,t){},205:function(e,t,n){},206:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(29),i=n.n(o),c=(n(145),n(19)),l=n(2),s=n.n(l),u=n(13),p=n(11);n(147),n(148),n(149),n(150);var d=n(35),f=n.n(d),m=n(25),h=n.n(m),g=function(e){return e&&e.references?r.a.createElement("div",{className:"tags",style:{display:"flex",flexWrap:"wrap"}},e.references.map((function(e,t){return r.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px",backgroundColor:e.color,color:e.textColor}},e.title)}))):null},b=function(e){if(!e.text)return null;if(!e.filter)return e.text;var t=e.text.toLowerCase().indexOf(e.filter.toLowerCase());if(-1===t)return e.text;var n=e.text.substr(0,t),a=e.text.substr(t,e.filter.length),o=e.text.substr(t+e.filter.length);return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,n),r.a.createElement("span",{style:e.style},a),r.a.createElement("span",null,o))},v=function(e){var t=e.tile?e.tile:{},n=Object(a.useState)(""),o=Object(p.a)(n,2);o[0],o[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{border:"0px dashed grey",margin:10,maxWidth:"300px"}},r.a.createElement("div",{style:{margin:10,padding:10,backgroundColor:t.color,color:t.textcolor,width:300,height:300,maxHeight:300,overflow:"auto"}},r.a.createElement("div",{style:{cursor:"pointer"},onClick:function(){e.onClick&&e.onClick(t)}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{flexGrow:1}},r.a.createElement(b,{text:t.title,filter:e.filter,style:e.highlightStyle})," "),r.a.createElement("div",{style:{alignItems:"flex-end"}},r.a.createElement("i",{style:{cursor:"pointer"},class:e.isPinned?"ms-Icon ms-Icon--PinnedFill":"ms-Icon ms-Icon--Pinned",onClick:function(t){e.onPinnedClicked&&(t.preventDefault(),t.stopPropagation(),e.onPinnedClicked(e))},"aria-hidden":"true"}))),r.a.createElement("div",{style:{textAlign:"center",margin:20,marginTop:40,height:120}},r.a.createElement("img",{style:{height:"auto",width:112},src:t.icon})),r.a.createElement("div",{style:{maxHeight:60,height:60,overflow:"auto"}},t.inShort))),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&r.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,rel:"noopener noreferrer",target:"_blank"},"Jump to"),t.externalArticle&&r.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,rel:"noopener noreferrer",target:"_blank"},"Details"))))},y=n(120),x=function(e){var t=e.tile?e.tile:{},n=Object(a.useState)(""),o=Object(p.a)(n,2),i=o[0],c=o[1],l=Object(a.useState)(null),s=Object(p.a)(l,2),u=s[0],d=s[1];return Object(a.useEffect)((function(){t.contentRef&&f.a.get(t.contentRef).then((function(e){var t=new y.QuillDeltaToHtmlConverter(e.data.ops);c(t.convert())})).catch((function(e){404!==e.response.status&&d(e.message)}))})),r.a.createElement(r.a.Fragment,null,u&&r.a.createElement("div",null,u),r.a.createElement("div",{onClick:e.onClose,style:{backgroundColor:t.color,color:t.textcolor,width:"100vw",height:"100vh",overflow:"auto"}},r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{minWidth:"10vw"}}," ",r.a.createElement("img",{style:{margin:"1vh",height:"auto",width:"10vw"},src:t.icon})),r.a.createElement("div",{style:{height:"10vh",width:"auto"}},r.a.createElement("div",{className:"fullSizeHeading",style:{padding:"3vh",fontSize:"5vh",textOverflow:"nowrap",whiteSpace:"no-wrap"}},t.title),r.a.createElement("div",{className:"fullSizeDescription",style:{paddingLeft:"3vh",fontSize:"3vh"}},t.inShort))),r.a.createElement("div",{style:{height:"80vh",overflow:"auto",backgroundColor:"#ffffff",color:"#000000",padding:"20px"}},r.a.createElement(g,{references:t.references}),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&r.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,target:"_blank"},"Jump to"),t.externalArticle&&r.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:i}})),r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-end"}},t.jumpto&&r.a.createElement("a",{style:{height:24},className:"button",href:t.jumpto,target:"_blank"},"Jump to"),t.externalArticle&&r.a.createElement("a",{style:{height:24},className:"button",href:t.externalArticle,target:"_blank"},"Details")))))},w=n(246),k=n(133),O=n(40),E=n(132),j=n(122),S=n(5),C=n(7);function T(){try{return window.self!==window.top}catch(e){return!0}}var L=function(){function e(t,n){Object(S.a)(this,e),this.options=n,this.msalApplication=t}return Object(C.a)(e,[{key:"getAccessToken",value:function(e){var t=this,n=this;return new Promise(function(){var a=Object(u.a)(s.a.mark((function a(r,o){var i,c,l,u,p,d,f,m;return s.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("undefined"!==typeof(i=e)&&(c=i.scopes),"undefined"!==typeof c&&0!==c.length||(c=t.options.scopes),0!==c.length){a.next=8;break}throw(l=new Error).name="EmptyScopes",l.message="Scopes cannot be empty, Please provide a scopes",l;case 8:if(n.msalApplication.handleRedirectCallback((function(e,t){if(e)return o(e)})),!t.msalApplication.getAccount()){a.next=42;break}return u={scopes:c},a.prev=11,a.next=14,t.msalApplication.acquireTokenSilent(u);case 14:p=a.sent,r(p.accessToken),a.next=40;break;case 18:if(a.prev=18,a.t0=a.catch(11),!(a.t0 instanceof O.a)){a.next=38;break}if(a.prev=21,!T()){a.next=29;break}return a.next=25,t.msalApplication.acquireTokenPopup(u);case 25:d=a.sent,r(d.accessToken),a.next=30;break;case 29:case 30:a.next=36;break;case 32:a.prev=32,a.t1=a.catch(21),o(a.t1);case 36:a.next=40;break;case 38:o(a.t0);case 40:a.next=60;break;case 42:if(a.prev=42,f={scopes:c},!T()){a.next=53;break}return a.next=47,t.msalApplication.loginPopup(f);case 47:return a.next=49,t.msalApplication.acquireTokenSilent(f);case 49:m=a.sent,r(m.accessToken),a.next=55;break;case 53:return n.msalApplication.loginRedirect(f),a.abrupt("return");case 55:a.next=60;break;case 57:a.prev=57,a.t2=a.catch(42),o(a.t2);case 60:case"end":return a.stop()}}),a,null,[[11,18],[21,32],[42,57]])})));return function(e,t){return a.apply(this,arguments)}}())}}]),e}(),P=n(178),I=(n(182),["User.Read.All","User.ReadWrite.All","mail.send","Files.ReadWrite.All"]),N={auth:{clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",redirectUri:window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,authority:"https://login.microsoftonline.com/common"}};new O.b(N).handleRedirectCallback((function(e,t){}));var A={authProvider:new L(new O.b(N),new j.MSALAuthenticationProviderOptions(I))},B={grid:{pending:!1}};function R(){return E.a.initWithMiddleware(A)}function _(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,a){var r,o;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=R(),t.prev=1,t.next=4,r.api(e).get();case 4:return o=t.sent,t.abrupt("return",n(o));case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",a(t.t0));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,n){return t.apply(this,arguments)}}())}function W(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(a,r){var o,i;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o=R(),n.next=4,o.api("/me/drive/items/".concat(e.id,":/").concat(t,":")).get();case 4:i=n.sent,f.a.get(i["@microsoft.graph.downloadUrl"]).then((function(e){a(e.data)})),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),a(null);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e,t){return n.apply(this,arguments)}}())}function D(e){return new Promise((function(t,n){try{var a=URL.createObjectURL(e),r=new XMLHttpRequest;r.responseType="blob",r.onload=function(){var e=r.response,n=new FileReader;n.onload=function(){var e=n.result;t(e)},n.readAsDataURL(e)},r.open("GET",a),r.send()}catch(o){t(null)}}))}function M(){setTimeout((function(){if(console.log("delaywriteLayouts"),B.grid.pending)return B.grid.writing?M():void F(B.grid.folder,B.grid.data)}),500)}function F(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(a,r){var o;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log("writeLayouts"),!B.grid.writing){n.next=10;break}if(!h.a.isEqual(B.grid.current,t)){n.next=5;break}return console.log("writeLayouts no changes"),n.abrupt("return",a());case 5:return B.grid.pending=!0,B.grid.data=t,B.grid.folder=e,M(),n.abrupt("return",a());case 10:return n.prev=10,B.grid.writing=!0,B.grid.current=t,o=R(),console.log("writeLayouts > got Client"),n.next=17,o.api("/me/drive/items/".concat(e.id,":/layouts.json:/content")).put(t);case 17:console.log("writeLayouts > wrote"),a(),n.next=25;break;case 21:return n.prev=21,n.t0=n.catch(10),console.log("writeLayouts > error",n.t0),n.abrupt("return",r(n.t0));case 25:return n.prev=25,B.grid.writing=!1,n.finish(25);case 28:case"end":return n.stop()}}),n,null,[[10,21,25,28]])})));return function(e,t){return n.apply(this,arguments)}}())}var G={me:function(){return _("/me")},rootSite:function(){return _("/sites/root")},initStorage:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=R(),e.prev=1,e.next=4,a.api("/me/drive/root:/ZTICKYBAR").get();case 4:return r=e.sent,e.abrupt("return",t(r));case 8:if(e.prev=8,e.t0=e.catch(1),404!==e.t0.statusCode){e.next=24;break}return e.prev=11,o={name:"ZTICKYBAR",folder:{},"@microsoft.graph.conflictBehavior":"rename"},e.next=15,a.api("/me/drive/root/children").post(o);case 15:return i=e.sent,e.abrupt("return",t(i));case 19:return e.prev=19,e.t1=e.catch(11),e.abrupt("return",n(e.t1));case 22:e.next=25;break;case 24:return e.abrupt("return",n(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,8],[11,19]])})));return function(t,n){return e.apply(this,arguments)}}())},initTileStorage:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=R(),e.prev=1,e.next=4,a.api("/me/drive/root:/ZTICKYBAR/tiles").get();case 4:return r=e.sent,e.abrupt("return",t(r));case 8:if(e.prev=8,e.t0=e.catch(1),404!==e.t0.statusCode){e.next=24;break}return e.prev=11,o={name:"tiles",folder:{},"@microsoft.graph.conflictBehavior":"rename"},e.next=15,a.api("/me/drive/root:/ZTICKYBAR:/children").post(o);case 15:return i=e.sent,e.abrupt("return",t(i));case 19:return e.prev=19,e.t1=e.catch(11),e.abrupt("return",n(e.t1));case 22:e.next=25;break;case 24:return e.abrupt("return",n(e.t0));case 25:case"end":return e.stop()}}),e,null,[[1,8],[11,19]])})));return function(t,n){return e.apply(this,arguments)}}())},addTile:function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(a,r){var o,i,c,l,p,d,m,g,b,v;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=R(),n.prev=1,i=t.tableId?t.title+" ("+t.tableId.replace("/","-")+")":t.title,c={name:i,folder:{},"@microsoft.graph.conflictBehavior":"replace"},n.next=6,o.api("/me/drive/items/".concat(e.id,"/children")).post(c);case 6:return l=n.sent,n.next=9,o.api("/me/drive/items/".concat(l.id,":/tile.json:/content")).put(t);case 9:return n.sent,p=h.a.keys(t),d=[],p.forEach((function(e){"references"!==e&&d.push([e,t[e]])})),m=P.utils.book_new(),g=P.utils.aoa_to_sheet(d),P.utils.book_append_sheet(m,g,"ZTICKYBAR"),b={bookType:"xlsx",bookSST:!1,type:"array"},v=P.write(m,b),n.next=20,o.api("/me/drive/items/".concat(l.id,":/tile.xlsx:/content")).put(v);case 20:return n.sent,f.a.request({responseType:"arraybuffer",url:t.icon,method:"get"}).then(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.api("/me/drive/items/".concat(l.id,":/image.png:/content")).put(t.data);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){})),n.abrupt("return",a(l));case 25:return n.prev=25,n.t0=n.catch(1),n.abrupt("return",r(n.t0));case 29:case"end":return n.stop()}}),n,null,[[1,25]])})));return function(e,t){return n.apply(this,arguments)}}())},getMyTools:function(e,t){return new Promise(function(){var n=Object(u.a)(s.a.mark((function n(a,r){var o,i,c,l;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,t){n.next=5;break}if(!(o=localStorage.getItem("mytools"))){n.next=5;break}return n.abrupt("return",a(JSON.parse(o)));case 5:return i=R(),n.next=8,i.api("/me/drive/items/".concat(e.id,"/children")).get();case 8:if(c=n.sent,l=0,0!==c.value.length){n.next=12;break}return n.abrupt("return",a(c.value));case 12:c.value.forEach(function(){var e=Object(u.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l++,e.next=3,W(t,"tile.json");case 3:if(t.tile=e.sent,0!==--l){e.next=8;break}return localStorage.setItem("mytools",JSON.stringify(c.value)),e.abrupt("return",a(c.value));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(0),r(n.t0);case 18:case"end":return n.stop()}}),n,null,[[0,15]])})));return function(e,t){return n.apply(this,arguments)}}())},teamMemberships:function(){return new Promise(function(){var e=Object(u.a)(s.a.mark((function e(t,n){var a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],e.prev=1,(r=R()).api("/me/joinedTeams").get(function(){var e=Object(u.a)(s.a.mark((function e(o,i){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o){e.next=2;break}return e.abrupt("return",n(o));case 2:c=0,i.value.map(function(){var e=Object(u.a)(s.a.mark((function e(n){var o,i,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c++,e.prev=1,e.next=4,r.api("/groups/".concat(n.id,"/photo/$value")).get();case 4:return o=e.sent,e.next=7,D(o);case 7:i=e.sent,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:return e.next=14,r.api("/teams/".concat(n.id)).get();case 14:return l=e.sent,e.next=17,r.api("/teams/".concat(n.id,"/channels")).version("beta").get();case 17:if(u=e.sent,a.push({key:n.id,text:n.displayName,title:n.description,data:{details:l,photo:i,channels:u.value}}),0!==--c){e.next=22;break}return e.abrupt("return",t(a.sort((function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}))));case 22:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",n(e.t0));case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}())},writeLayouts:F,readLayouts:function(e){return new Promise(function(){var t=Object(u.a)(s.a.mark((function t(n,a){var r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,W(e,"layouts.json");case 2:r=t.sent,n(r);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},U=n(248),z=n(131),H=function(e){return e&&e.errors?r.a.createElement("div",{className:"tags"},e.errors.map((function(e,t){return r.a.createElement("div",{key:t,style:{padding:"4px",margin:"4px"}},"When trying ",e.context,", you got",JSON.stringify(e))}))):null},q=function(e){return e&&e.memberShips?r.a.createElement("div",{className:"tags",style:{padding:"4px",margin:"4px",fontSize:"16px",display:"flex",flexWrap:"wrap"}},e.memberShips.map((function(t,n){var a=t.data&&t.data.details?t.data.details.webUrl:"";if(a)var o=a.split("https://teams.microsoft.com/l/team/")[1].split("/conversations?"),i=a.split("groupId=")[1].split("&"),c=a.split("tenantId="),l=o[0],s=i[0],u=c[1],p="https://teams.microsoft.com/_?tenantId=".concat(u,"#/conversations/unknown?groupId=").concat(s,"&threadId=").concat(l,"&ctx=channel"),d="https://teams.microsoft.com/_?tenantId=".concat(u,"#/files/unknown?groupId=").concat(s,"&threadId=").concat(l,"&ctx=channel");var f=t.data&&t.data.details?t.data.details:{displayName:t.title},m=t.data?t.data.photo:null,h=t.data&&t.data.channels?t.data.channels:[];return r.a.createElement("div",{key:n,style:{padding:"10px",margin:"10px",fontSize:"16px",display:"flex",border:"1px solid #dddddd",minWidth:"450px",maxWidth:"450px"}},r.a.createElement("div",{style:{minWidth:"84px"}},m&&r.a.createElement("img",{src:m,style:{height:"64px",margin:"10px"}})),r.a.createElement("div",{tyle:{minWidth:"366px"}},r.a.createElement("div",{className:"ms-font-xxl",style:{padding:"8px"}},r.a.createElement(b,{text:f.displayName,filter:e.filter,style:e.highlightStyle})),r.a.createElement("div",null,r.a.createElement("a",{style:{padding:"8px"},href:p,rel:"noopener noreferrer",target:"_blank"},"Posts"),r.a.createElement("a",{style:{padding:"8px"},href:d,rel:"noopener noreferrer",target:"_blank"},"Files")),r.a.createElement("div",{style:{padding:"8px",margin:"4px",fontSize:"14px",display:"flex",flexWrap:"wrap"}},h.map((function(t,n){return r.a.createElement("div",{key:n,style:{padding:"3px"}},r.a.createElement(b,{text:t.displayName,filter:e.filter,style:e.highlightStyle}),t.description&&r.a.createElement(r.a.Fragment,null,"(",t.description,")"))})))))}))):null},J=n(249),K=n(244),Y=n(242),Z=n(250),$=n(251),Q=n(243),X=(n(194),n(195),n(196),n(66),n(123));function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}Object(k.a)();Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement((function(){var e=Object(a.useState)(""),t=Object(p.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(""),l=Object(p.a)(i,2),d=l[0],m=l[1],g=Object(a.useState)([]),b=Object(p.a)(g,2),y=b[0],k=b[1],O=Object(a.useState)(!1),E=Object(p.a)(O,2),j=E[0],S=E[1],C=Object(a.useState)(null),T=Object(p.a)(C,2),L=T[0],P=T[1],I=Object(a.useState)({}),N=Object(p.a)(I,2),A=(N[0],N[1]),B=Object(a.useState)({}),R=Object(p.a)(B,2),_=R[0],W=R[1],D=Object(a.useState)([]),M=Object(p.a)(D,2),F=M[0],ee=M[1],te=Object(a.useState)(""),ne=Object(p.a)(te,2),ae=ne[0],re=ne[1],oe=Object(a.useState)([]),ie=Object(p.a)(oe,2),ce=ie[0],le=ie[1],se=Object(a.useState)([]),ue=Object(p.a)(se,2),pe=ue[0],de=(ue[1],Object(a.useState)("")),fe=Object(p.a)(de,2),me=fe[0],he=fe[1],ge=Object(a.useState)(""),be=Object(p.a)(ge,2),ve=be[0],ye=be[1],xe=Object(a.useState)(!1),we=Object(p.a)(xe,2),ke=we[0],Oe=we[1],Ee=Object(a.useState)(""),je=Object(p.a)(Ee,2),Se=je[0],Ce=je[1],Te=Object(a.useState)(!1),Le=Object(p.a)(Te,2),Pe=Le[0],Ie=Le[1],Ne=Object(a.useState)(!1),Ae=Object(p.a)(Ne,2),Be=Ae[0],Re=Ae[1],_e=Object(a.useState)(!1),We=Object(p.a)(_e,2),De=We[0],Me=We[1],Fe=Object(a.useState)(""),Ge=Object(p.a)(Fe,2),Ue=Ge[0],ze=Ge[1],He=Object(a.useState)({}),qe=Object(p.a)(He,2),Je=qe[0],Ke=qe[1];function Ye(e,t){f.a.get(e).then((function(n){var a=n.data;o(a.titlegraphics);var r=[];if(a.grid){var i={},l={};a.grid.forEach((function(e){return e.forEach((function(e){e.groupSetting&&(i[e.groupSetting.title]={groupSetting:e.groupSetting,members:e.members},e.members&&e.members.forEach((function(t){var n=l[t]?l[t]:[];n.push(e.groupSetting),l[t]=n})))}))})),a.grid.forEach((function(n){return n.forEach((function(n){if(n.tile&&n.tile.title){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(n,!0).forEach((function(t){Object(c.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n.tile);a.tableId=t,a.correlation=e+"#"+(a.key?a.key:a.title?a.title.toLowerCase():a.id);var o=l[n.id];a.references=o,r.push(a)}}))}))}k(h.a.sortBy(r,["title","href"]))}))}function Ze(e){return $e.apply(this,arguments)}function $e(){return($e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t&&(localStorage.removeItem("memberships"),localStorage.removeItem("mytools")),n=0,Oe(!0),e.next=6,G.initStorage();case 6:G.initTileStorage().then(function(){var e=Object(u.a)(s.a.mark((function e(a){var r,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W(a),n++,e.next=4,G.getMyTools(a,t);case 4:return r=e.sent,e.next=7,G.readLayouts(a);case 7:o=e.sent,0===--n&&Oe(!1),ee(r),Ke(o);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){--n<=0&&Oe(!1),ce.push({context:"OfficeGraph.initStorage()",error:e}),le(ce)})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),ce.push({context:"initGraph",error:e.t0}),le(ce);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function Qe(e){var t=e.title&&-1!==e.title.toLowerCase().indexOf(d.toLowerCase());return t||(t=e.inShort&&-1!==e.inShort.toLowerCase().indexOf(d.toLowerCase())),t||(t=e.subTitle&&-1!==e.subTitle.toLowerCase().indexOf(d.toLowerCase())),t}Object(a.useEffect)((function(){Ze(),G.me().then((function(e){A(e),window.document.title=e.displayName+" Tools"})).catch((function(e){ce.push({context:"OfficeGraph.me()",error:e}),le(ce)}));var e=function(e){if(!e)return{};var t={},n=e.split("?");if(n.length>1)for(var a=n[1].split("&"),r=0;r<a.length;r++){var o=a[r].split("=");t[o[0]]=decodeURIComponent(o[1])}return t}(window.location.href);e.ztickyref&&re(e.ztickyref);var t=e.src?e.src:"https://api.jumpto365.com/table/hexatown.com/PTO365";ze("https://pro.jumpto365.com/@/hexatown.com/PTO365"),Ye(t,"hexatown.com/PTO365")}),[]);var Xe=d?[]:y,Ve=d?[]:F,et=d?[]:pe,tt=[],nt=ae?new URL(ae):null;return d&&(y.forEach((function(e){Qe(e)&&Xe.push(e)})),F.forEach((function(e){Qe(e.tile)&&Ve.push(e)})),pe.forEach((function(e){(function(e){var t=e.data&&e.data.details?e.data.details:{},n=e.data&&e.data.channels?e.data.channels:[],a=t.displayName&&-1!==t.displayName.toLowerCase().indexOf(d.toLowerCase());return a||(a=t.description&&-1!==t.description.toLowerCase().indexOf(d.toLowerCase())),n.forEach((function(e){a||(a=e.displayName&&-1!==e.displayName.toLowerCase().indexOf(d.toLowerCase())),a||(a=e.description&&-1!==e.description.toLowerCase().indexOf(d.toLowerCase()))})),a})(e)&&et.push(e)}))),r.a.createElement("div",null,r.a.createElement(Q.a,{farItems:[{key:"tile",text:"Grid view",ariaLabel:"Filter view",iconOnly:!0,iconProps:{iconName:"Filter"},onClick:function(){De&&m(""),Me(!De)}}],ariaLabel:"Use left and right arrow keys to navigate between commands"}),r.a.createElement("div",{style:{paddingRight:"20px",paddingLeft:"20px"}}," ",Se&&r.a.createElement("div",{style:{backgroundColor:"white",width:"100vw",position:"fixed",top:"0px"}},r.a.createElement(Z.a,{xlabel:"Example title",description:Se})),r.a.createElement("img",{style:{height:"64px",margin:"13px",position:"fixed",bottom:"0px",right:"0px"},src:n}),j&&r.a.createElement("div",null,r.a.createElement(x,{tile:L||(y?y[0]:null),onClose:function(){S(!1)}})),!j&&r.a.createElement("div",{style:{display:"flex"}}," ",r.a.createElement("div",{style:{paddingRight:"8px",position:"fixed",bottom:"0px",backgroundColor:"white"}},r.a.createElement("a",{href:_.webUrl,target:"_blank"},r.a.createElement("i",{style:{cursor:"pointer",padding:"4px",color:"black"},class:"ms-Icon ms-Icon--OpenFolderHorizontal","aria-hidden":"true"})," "),r.a.createElement("i",{style:{cursor:"pointer",padding:"4px"},class:"ms-Icon ms-Icon--Refresh",onClick:function(){Ze(!0)},"aria-hidden":"true"})," ",ke&&r.a.createElement(r.a.Fragment,null,"Loading")),r.a.createElement("div",{style:{flexGrow:"1"}},r.a.createElement(U.a,{style:{padding:"0px"}},Ve.length>0&&r.a.createElement(z.a,{headerText:"Pinned",itemCount:Ve.length},r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},Ve.map((function(e,t){var n=e.tile?e.tile:{title:e.name,color:"#dddddd"};return r.a.createElement(v,{isPinned:!0,key:t,tile:n,filter:d,highlightStyle:{backgroundColor:"yellow"},onClick:function(e){P(e),S(!0)}})}))))),nt&&r.a.createElement(z.a,{headerText:"Site",itemCount:tt.length},r.a.createElement("h3",null,"Which tools do you find good for this site?"),r.a.createElement("div",null,nt.hostname),r.a.createElement(w.a,{label:"Label",placeholder:"Enter label for this link",value:me,onChange:function(e,t){he(t)}}),r.a.createElement(w.a,{label:"URL",placeholder:"Enter URL",value:ve,onChange:function(e,t){ye(t)}}),r.a.createElement(J.a,{text:"Share link",disabled:!ve&&!me})),r.a.createElement(z.a,{headerText:"Catalogue",itemCount:Xe.length},r.a.createElement("div",{style:{display:"flex",marginTop:"8px"}},r.a.createElement("div",{style:{marginLeft:"16px",flexGrow:1}},r.a.createElement(K.a,{placeholder:"Select an area",xlabel:"Catalogue",onChanged:function(e,t){Ye(e.key.api,e.key.id),ze(e.key.web)},xselectedKey:"https://api.jumpto365.com/table/hexatown.com/PTO365",options:[{key:"fruitsHeader",text:"Nets Group Periodic Tables",itemType:Y.a.Header},{key:{id:"nets.eu/2019-q4",api:"https://api.jumpto365.com/table/nets.eu/2019-q4",web:"https://pro.jumpto365.com/@/nets.eu/2019-q4"},text:"One Tenant - Wave 1"},{key:{id:"nets.eu/digital-workplace",api:"https://api.jumpto365.com/table/nets.eu/digital-workplace",web:"https://pro.jumpto365.com/@/nets.eu/digital-workplace"},text:"Digital Workplace"},{key:{id:"nets.eu/group-tech-highlevel",api:"https://api.jumpto365.com/table/nets.eu/group-tech-highlevel",web:"https://pro.jumpto365.com/@/nets.eu/group-tech-highlevel"},text:"Group Tech Playbook"},{key:"divider_1",text:"-",itemType:Y.a.Divider},{key:"jumpto365",text:"Generic Periodic Tables",itemType:Y.a.Header},{key:{id:"hexatown.com/PTO365",api:"https://api.jumpto365.com/table/hexatown.com/PTO365",web:"https://pro.jumpto365.com/@/hexatown.com/PTO365"},text:"Office 365"},{key:{id:"jumpto365.com/ems5",api:"https://api.jumpto365.com/table/jumpto365.com/ems5",web:"https://pro.jumpto365.com/@/jumpto365.com/ems5"},text:"EMS"}],styles:{dropdown:{width:300}}}))," ",r.a.createElement("div",{style:{marginLeft:"16px"}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{padding:"8px"}},"Table view"),r.a.createElement("div",null,r.a.createElement($.a,{xlabel:"Show Table",checked:Pe,style:{marginTop:"8px"},xonText:"Table view On",xoffText:"Table view Off",onChange:function(e,t){Ie(t)}}))))),Pe&&r.a.createElement(r.a.Fragment,null,Ue,r.a.createElement("iframe",{style:{height:"calc(100vh - 300px",width:"calc(100vw - 100px"},src:Ue})),!Pe&&r.a.createElement("div",{style:{display:"flex",flexWrap:"wrap"}},Xe.map((function(e,t){return r.a.createElement(v,{key:t,filter:d,highlightStyle:{backgroundColor:"yellow"},tile:e,onPinnedClicked:function(e){e.tile&&function(e){Ce("Adding pin"),G.addTile(_,e).then(function(){var e=Object(u.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.getMyTools(_,!0);case 3:n=e.sent,h.a.keys(Je).forEach((function(e){Je[e].push({x:0,y:1/0,w:3,h:3,i:Je[e].length.toString(),static:0})})),Ke(Je),ee(n),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),ce.push({context:"AddTile > myTools.push() ",error:e.t0}),le(ce);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){ce.push({context:"OfficeGraph.addTile()",error:e}),le(ce)})).finally((function(){Ce("")}))}(e.tile)},onClick:function(e){P(e),S(!0)}})})))),pe.length>0&&r.a.createElement(z.a,{headerText:"Teams",itemCount:et.length},r.a.createElement(q,{memberShips:et,filter:d,highlightStyle:{backgroundColor:"yellow"}})),r.a.createElement(z.a,{headerText:"Grid"},r.a.createElement("div",null,r.a.createElement("div",{style:{display:"flex",marginTop:"8px"}},r.a.createElement("div",{style:{marginLeft:"16px",flexGrow:1}}),r.a.createElement("div",{style:{marginLeft:"16px"}},r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{padding:"8px"}},"Edit Layout"),r.a.createElement("div",null,r.a.createElement($.a,{checked:Be,style:{marginTop:"8px"},onChange:function(e,t){Re(t)}}))))),r.a.createElement(X.a,{tools:F,layouts:Je,persist:function(e){Ke(e),G.writeLayouts(_,e).then().catch((function(e){ce.push({context:"  OfficeGraph.writeLayouts()",error:e}),le(ce)}))},editingLayout:Be,onTileClick:function(e){P(e),S(!0)}}))),0!==ce.length&&r.a.createElement(z.a,{headerText:"Developer feedback",itemCount:ce.length},r.a.createElement("div",null,r.a.createElement(H,{errors:ce}))))),De&&r.a.createElement("div",{style:{borderLeft:"1px solid #dddddd",borderTop:"1px solid #dddddd",padding:"8px",float:"right",minWidth:"300px"}},r.a.createElement("div",{style:{padding:"0px"}},r.a.createElement(w.a,{label:"Filter",value:d,onChange:function(e,t){m(t)},placeholder:"Filter the list of tools",iconProps:{iconName:"Filter"}}))))))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[140,1,2]]]);
//# sourceMappingURL=main.bd9f67cb.chunk.js.map