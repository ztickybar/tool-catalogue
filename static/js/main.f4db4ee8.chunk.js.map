{"version":3,"sources":["components/ToolboxLayout.js","components/WidthProvider.jsx","config/default/favicon-96x96.png","components/Tags.js","components/Highlight.js","components/AppSuperTile.js","components/ViewErrors.js","components/MouseOver.js","helpers/trace.js","helpers/OfficeGraph/index.js","helpers/LaunchPad.js","components/ViewTeams.js","config/index.js","helpers/index.js","components/BreakPointSelector.js","App.js","Onboard.js","authenticate.js","components/DragableDetailsList.js","containers/Boards.js","index.js"],"names":["ResponsiveReactGridLayout","breakpoints","lg","md","sm","xs","xxs","ToolboxLayout","props","onBreakpointChange","breakpoint","setState","prevState","currentBreakpoint","toolbox","onCompactTypeChange","oldCompactType","state","compactType","onTakeItem","item","filter","i","layouts","onPutItem","onLayoutChange","layout","key","value","global","localStorage","setItem","JSON","stringify","persist","onNewLayout","generateLayout","onResize","tools","forEach","tool","WidthProvider","Responsive","fixedWidth","mounted","this","x","y","that","_","map","l","tile","title","refresh","Date","now","style","backgroundColor","color","textcolor","cursor","editingLayout","overflow","data-grid","w","h","className","static","getPin","cols","measureBeforeMount","useCSSTransforms","preventCollision","isDraggable","editMode","isResizable","generateDOM","React","Component","range","Math","ceil","random","floor","toString","defaultProps","rowHeight","initialLayout","ComposedComponent","width","onWindowResize","node","ReactDOM","findDOMNode","HTMLElement","offsetWidth","window","addEventListener","removeEventListener","prevProps","rest","module","exports","Tags","references","display","flexWrap","group","padding","margin","textColor","Highlight","text","ix","toLowerCase","indexOf","first","substr","middle","length","last","AppSuperTile","useState","tileSize","border","maxWidth","height","maxHeight","borderRadius","onClick","marginTop","src","icon","flexGrow","lineHeight","marginLeft","fontSize","highlightStyle","alignItems","class","isPinned","e","onPinnedClicked","preventDefault","stopPropagation","aria-hidden","textAlign","inShort","justifyContent","externalArticle","href","rel","target","ViewErrors","errors","error","context","theme","ContextualMenu","getTheme","EVENT","mergeStyleSets","container","flexFlow","header","fonts","xLargePlus","flex","borderTop","palette","themePrimary","neutralPrimary","fontWeight","FontWeights","semibold","body","overflowY","selectors","p","marginBottom","neutralDark","LANDING","ONBOARDING","SEARCHING","SEARCHCLICKED","TILECLICKED","TABCLICKED","DETAILSTOGGLED","MEMBERSHIPSREAD","who","upn","amplitude","amp","getInstance","setUserId","s","split","setDomain","trace","event","details","logEvent","console","log","Object","freeze","graph","analyseMembers","token","emailAddresses","cb","addresses","element1","element2","match","smtp","push","checked","results","address","readUser","err","user","invite","emailAddress","invitationRedirectUrl","post","invitedUserEmailAddress","inviteRedirectUrl","invitedUserDisplayName","sendInvitationMessage","invitedUserMessageInfo","customizedMessageBody","ccRecipients","name","response","addcrm","tag","msg","properties","property","post2","addmember","userId","groupId","getSharePointList","host","site","list","listfilter","itemfilter","get","items","itemList","next","pop","id","getPages","readGroupMembers","readGroupMemberShipFor","readManager","userPrincipalName","index","matchingGroups","searchText","findGroup","getGroupDocuments","folderName","getGroupDrive","getGroupSite","getDriveChildren","driveId","itemId","getGroupRootFolders","getSharePointSiteByName","hostName","relativePath","getSharePointSiteDrive","path","copyfile","groupNickName","fromFolder","fromName","toFolder","toName","groups","fromItems","find","targetFolders","destFolder","newDoc","parentReference","result","sourceGroupId","lookupFile","iterations","file","iteration","setTimeout","Client","url","Promise","resolve","reject","payload","patch","axios","headers","authorization","then","data","catch","put","getRaw","request","getImage","xhr","XMLHttpRequest","onload","reader","FileReader","onloadend","readAsDataURL","open","setRequestHeader","responseType","send","auth","getAccessToken","get2","put2","me","myGroups","readTeam","readTeamChannelMessages","channelId","getMyExtention","extensionName","getOneDriveFolder","folderNameWithOutInitialSlash","getOneDriveFolderContent","getOneDriveFile","filename","a","folder","saveOneDriveFile","createOneDriveFolder","createOneDriveFolderChild","parentFolderNameWithOutInitialSlash","driveItem","saveMyExtention","updateMyExtention","r","addMyExtention","patch2","teamMemberships","reportProgessPercent","client","memberships","pending","total","processed","readGroup","sort","b","displayName","description","photo","creationOptions","v","hasYammer","hasSharePoint","resourceProvisioningOptions","readChannels","channels","readEndpoints","endPoints","hasTeams","undefined","queue","channel","tabs","appendTo","retrycount","parsedBody","errCounter","parse","concat","sessionStorage","getItem","extentionName","OURPATH","BOARDSPATH","BOARDS","OURCONFIGFILENAME","BOARDINDEXFILENAME","saveCache","membershipIndex","membership","cachedFileName","verifyAccessForLanuchPad","setCheckMe","setCheckMyExtention","setCheckOneDrive","setCheckOneDriveFiles","setCheckMemberships","setCheckTeam","checkAccessToConfig","version","projectInfo","message","checkAccessToContexts","m","hello","extention","teamId","member","buffer","delaywriteLayouts","writing","writeLayouts","isEqual","current","readBoards","ctx","fullname","content","myTeams","team","getHref","files","Axios","webUrl","uniqueEndPoints","groupBy","endPoint","providerName","jumpto","uri","part2","part4","part5","threadId","tenantId","conversationsHref","teamsLink","breakpointColumnsObj","default","3600","3300","3000","2700","2400","2100","1800","1500","1200","900","600","ViewTeams","viewDates","memberShips","cloneDeep","tiles","sortBy","minWidth","breakpointCols","columnClassName","ViewTeam","viewChannels","onSaveTeam","mouseOver","setMouseOver","componentRef","useRef","logo","show","c","offsetParent","offsetHeight","ref","position","right","top","bottom","visibility","onMouseEnter","onMouseLeave","xborder","xborderRadius","onRemovePin","pinId","marginRight","xdisplay","TeamChannel","viewMode","ListTags","indexLaunzhContexts","paddingLeft","paddingBottom","zIndex","ActionButton","styles","iconProps","iconName","ariaLabel","fontStyle","paddingRight","noMessages","expirationDateTime","moment","fromNow","Messages","messages","textDecoration","from","createdDateTime","useEffect","_messages","setMessages","load","membershipType","IconButton","onSaveChannel","filesLink","generalLink","tab","configuration","websiteUrl","decodeURIComponent","location","clientId","directoryId","scopes","defaultTableAPI","niels","teamsIntegration","options","components","borderBottom","left","getSearchParametersFromHRef","search","s1","s2","s3","BreakPointSelector","breakPoints","keys","breakPoint","selected","onSelect","logSearchTimer","searchInfo","dragOptions","moveMenuItemText","closeMenuItemText","menu","cancelIcon","contentStyles","minHeight","iconButtonStyles","root","rootHovered","inIframe","self","App","inFrame","searchIconRef","config","upnIs","showTabFeature","titlegraphics","setTitlegraphics","_setFilter","setSearch","setTiles","isZoomed","setIsZoomed","setCurrentTile","myTools","setMyTeams","ztickyRef","setZtickyRef","setErrors","setMemberships","contexts","setContexts","board","selectedBoard","setSelectedBoard","refreshing","setRefresing","progress","setProgress","progressPercent","setProgressPercent","showTable","showFilterOptions","tableUrl","setTableUrl","setLayouts","refreshCounter","setRefreshCounter","tags","showDetails","_setShowDetails","showCatalogue","_setShowCatalogue","_setEditMode","isLoaded","setIsLoaded","selectedGroup","setGroups","isModalOpen","setIsModalOpen","selectedBreakPoint","setSelectedBreakPoint","isMounted","setIsMounted","isDirty","setIsDirty","showWarning","setShowWarning","setIndexLaunzhContexts","myDrive","setMyDrive","setEditMode","on","setFilter","startsWith","removePin","splice","addPin","_team","showSearch","readGrid","tableId","grid","groupRefs","row","cell","groupSetting","members","refs","ga","sortKey","toLower","correlation","initGraph","queueCount","localCache","cachedMemberships","percent","matchFilter","subTitle","boardFileName","document","ztickyref","ctxs","endsWith","defaultTableKey","drive","filteredTiles","filteredMyTools","filteredMemberShips","URL","include","matchTeam","clearTimeout","editorCanvasWidth","ProgressIndicator","percentComplete","xlabel","xdescription","Dropdown","disabled","placeholder","selectedKey","onChanged","option","dropdown","saveLayout","Toggle","onChange","CommandBar","farItems","iconOnly","subMenuProps","navigate","Spinner","label","MessageBar","messageBarType","MessageBarType","warning","isMultiline","onDismiss","dismissButtonAriaLabel","actions","MessageBarButton","Coachmark","positioningContainerProps","directionalHint","DirectionalHint","topAutoEdge","doNotLayer","ariaAlertText","ariaDescribedBy","ariaLabelledBy","ariaDescribedByText","ariaLabelledByText","newLayouts","parseInt","onTileClick","Modal","titleAriaId","isOpen","isBlocking","containerClassName","xdragOptions","TextField","autoFocus","newValue","identify","messageBeforeLaunch","borderLeft","float","initializeIcons","Onboard","checkMe","checkMemberships","checkTeam","checkMyExtention","checkOneDrive","checkOneDriveFiles","run","dir","GETACCESSTOKEN","RESTOREURL","GETGRAPHUSER","LOGIN","ACCESSTOKEN","ACCESSEXPIRES","authenticate","callBackNotifyIfInteractionIsRequired","redirect_uri","hostname","protocol","port","client_id","scope","seq","getSearchParametersFromHash","search2","id_token","access_token","login","exp","expiresIn","diff","isAccessTokenExpired","handled","removeItem","error_description","expires","add","expires_in","toISOString","reload","overflowProps","dragEnterClass","mergeStyles","neutralLight","DragableDetailsList","cmdItems","_selection","getSelectedCount","cacheKey","_handleColumnReorder","draggedIndex","targetIndex","draggedItems","columns","newColumns","_onChangeStartCountText","frozenColumnCountFromStart","_onChangeEndCountText","frozenColumnCountFromEnd","_onChangeColumnReorderEnabled","ev","isColumnReorderEnabled","_onItemInvoked","alert","_onRenderItemColumn","column","Link","data-selection-invoke","String","Selection","selectionMode","onSelectionChanged","_draggedIndex","_items","_dragDropEvents","_getDragDropEvents","buildColumns","_overflowItems","_farItems","overflowItems","overflowButtonProps","MarqueeSelection","selection","DetailsList","setKey","selectionPreservedOnEmptyClick","onItemInvoked","onRenderItemColumn","dragDropEvents","columnReorderOptions","_getColumnReorderOptions","ariaLabelForSelectionColumn","ariaLabelForSelectAllCheckbox","checkButtonAriaLabel","handleColumnReorder","isNaN","Number","canDrop","dropContext","dragContext","canDrag","onDragEnter","onDragLeave","onDrop","_draggedItem","_insertBeforeItem","onDragStart","itemIndex","selectedItems","onDragEnd","isIndexSelected","getSelection","insertIndex","itm","Boards","setBoards","boardItems","setBoardItems","_boards","ErrorBoundary","hasError","info","DefaultButton","primary","viewDetails","componentStack","readOnly","rows","children","loadTheme","defaultFontStyle","fontFamily","small","medium","large","xLarge","getElementById","innerHTML","render","Customizer","FluentCustomizations","Fabric","start"],"mappings":"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","file":"static/js/main.f4db4ee8.chunk.js","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport ReactGridLayout, { Responsive } from \"react-grid-layout\";\nimport \"./Toolbox.css\";\nimport WidthProvider from \"./WidthProvider\"\n\n\nexport const breakpoints = {lg: 1200, md: 996, sm: 768, xs: 480, xxs: 240}\nvar ResponsiveReactGridLayout\nexport default class ToolboxLayout extends React.Component {\n  static defaultProps = {\n    className: \"layout\",\n    rowHeight: 30,\n    onLayoutChange: function () {},\n    cols: { lg: 12, md: 10, sm: 6, xs: 4, xxs: 2 },\n    initialLayout: generateLayout(),\n  };\n\n  constructor(props) {\n    super(props);\n    ResponsiveReactGridLayout = WidthProvider(Responsive,props.fixedWidth);\n    this.state = {\n      currentBreakpoint: \"lg\",\n      compactType: \"vertical\",\n      mounted: false,\n      // layouts: props.layouts\n      //   ? props.layouts\n      //   : {\n      //       lg: props.tools\n      //         ? props.tools.map((tool, ix) => {\n      //             return {\n      //               x: 0,\n      //               y: ix,\n      //               w: 3,\n      //               h: 3,\n\n      //               i: ix.toString(),\n\n      //               static: 0, //Math.random() < 0.05,\n      //             };\n      //           })\n      //         : props.initialLayout,\n      //     },\n      toolbox: { lg: [] },\n    };\n  }\n\n  componentDidMount() {\n    this.setState({ mounted: true });\n  }\n\n  generateDOM(x,y) {\n    var that = this;\n    \n    return _.map(this.props.layouts[this.state.currentBreakpoint], (l) => {\n      \n      var tile =\n        that.props.tools && that.props.tools[l.i] && that.props.tools[l.i].tile\n          ? that.props.tools[l.i].tile\n          : { title: l.i };\n          {var refresh = Date.now()}\n      return (\n        <div\n          style={{\n            backgroundColor: tile.color,\n            color: tile.textcolor,\n            cursor: !this.props.editingLayout ? \"pointer\" : \"default\",\n            overflow:\"hidden\"\n          }}\n          // onClick={() => {\n          //   if (this.props.onTileClick && !this.props.editingLayout) {\n          //     this.props.onTileClick(tile);\n          //   }\n          // }}\n          key={l.i}\n\n          data-grid={{w:l.w,h:l.h,x:l.x,y:l.y}}\n          className={l.static ? \"static\" : \"\"}\n        >\n       \n          <span >\n          \n        {/* {refresh} {l.w}x{l.h} */}\n            {that.props.getPin(l.i,l.w,l.h,refresh)} \n            </span>\n        </div>\n      );\n    });\n  }\n\n  onBreakpointChange = (breakpoint) => {\n    this.setState((prevState) => ({\n      currentBreakpoint: breakpoint,\n      toolbox: {\n        ...prevState.toolbox,\n        [breakpoint]:\n          prevState.toolbox[breakpoint] ||\n          prevState.toolbox[prevState.currentBreakpoint] ||\n          [],\n      },\n    }));\n  };\n\n  onCompactTypeChange = () => {\n    const { compactType: oldCompactType } = this.state;\n    const compactType =\n      oldCompactType === \"horizontal\"\n        ? \"vertical\"\n        : oldCompactType === \"vertical\"\n        ? null\n        : \"horizontal\";\n    this.setState({ compactType });\n  };\n\n  onTakeItem = (item) => {\n    this.setState((prevState) => ({\n      toolbox: {\n        ...prevState.toolbox,\n        [prevState.currentBreakpoint]: prevState.toolbox[\n          prevState.currentBreakpoint\n        ].filter(({ i }) => i !== item.i),\n      },\n      layouts: {\n        ...prevState.layouts,\n        [prevState.currentBreakpoint]: [\n          ...prevState.layouts[prevState.currentBreakpoint],\n          item,\n        ],\n      },\n    }));\n  };\n\n  onPutItem = (item) => {\n    this.setState((prevState) => {\n      return {\n        toolbox: {\n          ...prevState.toolbox,\n          [prevState.currentBreakpoint]: [\n            ...(prevState.toolbox[prevState.currentBreakpoint] || []),\n            item,\n          ],\n        },\n        layouts: {\n          ...prevState.layouts,\n          [prevState.currentBreakpoint]: prevState.layouts[\n            prevState.currentBreakpoint\n          ].filter(({ i }) => i !== item.i),\n        },\n      };\n    });\n  };\n\n  onLayoutChange = (layout, layouts) => {\n    saveToLS(\"layouts\", layouts);\n\n    if (this.props.persist) {\n      this.props.persist(layouts);\n    }\n    this.setState({ layouts });\n  };\n\n  onNewLayout = () => {\n    this.setState({\n      layouts: { lg: generateLayout() },\n    });\n  };\n  onResize = () =>{\n    if (!this.props.tools) return\n    \n    this.props.tools.forEach(tool => {\n      if (tool.onResize) tool.onResize()\n    });\n\n  }\n  render() {\n    return (\n      <div>\n        {/* <div>\n          Current Breakpoint: {this.state.currentBreakpoint} (\n          {this.props.cols[this.state.currentBreakpoint]} columns)\n        </div>\n        <div>\n          Compaction type:{\" \"}\n          {_.capitalize(this.state.compactType) || \"No Compaction\"}\n        </div>\n        <button onClick={this.onNewLayout}>Generate New Layout</button>\n        <button onClick={this.onCompactTypeChange}>\n          Change Compaction Type\n        </button> */}\n\n        {/* <ToolBox\n          items={this.state.toolbox[this.state.currentBreakpoint] || []}\n          onTakeItem={this.onTakeItem}\n        /> */}\n\n        <ResponsiveReactGridLayout\n       \n         breakpoints={breakpoints }\n         cols={{lg: 12, md: 10, sm: 6, xs: 4, xxs: 2}}\n          {...this.props}\n          \n          layouts={this.props.layouts}\n          onBreakpointChange={this.onBreakpointChange}\n          onLayoutChange={this.onLayoutChange}\n          // WidthProvider option\n          measureBeforeMount={false}\n          // I like to have it animate on mount. If you don't, delete `useCSSTransforms` (it's default `true`)\n          // and set `measureBeforeMount={true}`.\n          useCSSTransforms={true}\n          compactType={this.state.compactType}\n          preventCollision={!this.state.compactType}\n          onResize={this.onResize}\n          isDraggable={this.props.editMode}\n          isResizable={this.props.editMode}\n        >\n          {this.generateDOM(this)}\n        </ResponsiveReactGridLayout>\n      </div>\n    );\n  }\n}\n\nfunction getFromLS(key) {\n  let ls = {};\n  if (global.localStorage) {\n    try {\n      ls = JSON.parse(global.localStorage.getItem(\"rgl-8\")) || {};\n    } catch (e) {\n      /*Ignore*/\n    }\n  }\n  return ls[key];\n}\n\nfunction saveToLS(key, value) {\n  if (global.localStorage) {\n    global.localStorage.setItem(\n      \"rgl-8\",\n      JSON.stringify({\n        [key]: value,\n      })\n    );\n  }\n}\nfunction generateLayout() {\n  return _.map(_.range(0, 25), function (item, i) {\n    var y = Math.ceil(Math.random() * 4) + 1;\n    return {\n      x: (_.random(0, 5) * 2) % 12,\n      y: Math.floor(i / 6) * y,\n      w: 2,\n      h: y,\n      i: i.toString(),\n      static: Math.random() < 0.05,\n    };\n  });\n}\n","\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport ReactDOM from \"react-dom\";\n\n\n\n\n/*\n * A simple HOC that provides facility for listening to container resizes.\n */\nexport default function WidthProvider(\n  ComposedComponent,fixedWidth\n) {\n  return class WidthProvider extends React.Component {\n    static defaultProps = {\n      measureBeforeMount: false\n    };\n\n    static propTypes = {\n      // If true, will not render children until mounted. Useful for getting the exact width before\n      // rendering, to prevent any unsightly resizing.\n      measureBeforeMount: PropTypes.bool\n    };\n\n    state = {\n      width: 1200\n    };\n\n    mounted = false;\n\n    componentDidMount() {\n      this.mounted = true;\n\n      window.addEventListener(\"resize\", this.onWindowResize);\n      // Call to properly set the breakpoint and resize the elements.\n      // Note that if you're doing a full-width element, this can get a little wonky if a scrollbar\n      // appears because of the grid. In that case, fire your own resize event, or set `overflow: scroll` on your body.\n      this.onWindowResize();\n    }\n\n    componentWillUnmount() {\n      this.mounted = false;\n      window.removeEventListener(\"resize\", this.onWindowResize);\n    }\n    componentDidUpdate(prevProps,prevState) {\n      //debugger\n      if (this.props.fixedWidth && (this.props.fixedWidth  !== prevProps.fixedWidth) ){\n        //debugger\n        this.setState({width:this.props.fixedWidth })\n      }\n      \n    }\n    onWindowResize = () => {\n      if (!this.mounted) return;\n      // eslint-disable-next-line react/no-find-dom-node\n      const node = ReactDOM.findDOMNode(this); // Flow casts this to Text | Element\n            \n      if (node instanceof HTMLElement)\n        this.setState({ width:  node.offsetWidth < 1200 ? node.offsetWidth : 1200 });\n    };\n\n    render() {\n      const { measureBeforeMount, ...rest } = this.props;\n      if (measureBeforeMount && !this.mounted) {\n        return (\n          <div className={this.props.className} style={this.props.style} />\n        );\n      }\n\n      return <ComposedComponent {...rest} {...this.state} />;\n    }\n  };\n}\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAASAAAAEgARslrPgAABidJREFUeNrtnc1vHdUZh5/3nBlf29dJbOLgOOAoSkwwIBKgsVIRGqkSq1AhqNIVC6Ru2j+gfwe7dsMCWIBUsajKh6qibKCtKqSGCgioNB+kSTCRUUzs4I/Y95yXxb1JiO+YAGfiI5f38ca+I78+M898nDm/OWNRVcXIhsvdgB87JiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzJiAzxeoPFJia+oJLM7MgklRcVRlo9rFr5yjebyzXMUZmPpvh6uLV9GIKzcEmgyODXYu6BcTI8y+9xst//CtF4ZP+bgiRgwfu5/fP/Y7Nm5rrtvHqYHlxmTf+8CZnPziLS9x5YghMPjHJkd8eQdzNO3W3AIWFhSVmvpyrRcDclQU2YuamqizNLzE/O1+DgMjy4nLlsmKtXxIRJPEUJJJ8FsuIAFLPdmDtDbGxTsz/h5iAzJiAzJiAzJiAzJiAzBTpJb47c3PLzC+0SO2ZKtDocQwONnBuw/ZzgXUWMPX5AufPf4VLPO5UYWiwwf79PSbg+9B+DFVRTR9j2oA315XYNSAzJiAzJiAzJiAzJiAzJmA9+JZOX2U3VIGomtTdEyBG5ZszoIR2H76ejOB2d0QVrm2DxERJY7tWu823SMScE57+xWHuHd+ZfJOjqoyObKWvtweAkZF+ms0yWYAqNHr9bb0JKxslP/vVIfb9/MHkQEajsn3P9so9Tyon6YUIMdazJiLQiTZbUdtHRQ1lnUDZiQqXWy2iai1DHIVzFP5ae6GmrYATKCoaWBHKK+dePcb0O/9GUscMYmTT3p2M/+aXuN4Gbxw/zz8/mU7ec6Mqu0c28ezhcZDAi387xpnpi7jEPTWo8ug99/HUIz9laUV4/u0VTl7U5KGTEJXD93qOThasXvXua4Aqsx+dYerNf+ASQ/kYIsMzc+z+9ZNIbw//+WyWYx9OUSSG3K0YOTA/zDOP7QECx8+e4l+fnqRwnh96fEmn7h3NAfSRg6xE4d0zkXdPR1KfqGkF2DrgODrZvaxbgIA4hys8kijAiSDeX7/uOCd47/DJ525301HknaNwHp+4qyqCc45OjI53UDiSBQB4oeoavHY3tL4+hq76fgMNo61DU+0+IDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDMmIDNrCqgv7JNV32+gZznXoakVgUx7qmpsheTDI4aIhnB9WDdGJYSIJFZuxUiMN8aKQ4y0Yug0/4cHMiFGYoydKkKI7VgydVS6FSBUZAFQGcgIWx7YzY4nDtUWSbqyQBAm7trC4w/uqC2SLJyAeH6ya5yh/oFaIsmJHWMIQung4G7HHf1SSyT5wF3VbasO5VutdjBfB06gLK83JNQ0aVhEKDsiW6EdytdxyvDi8K6dBK4EiDWUVW6ka6upfFXBicvKp7OB1OQwKgz3OSa3K4UIJ/97kfMXZtIf81AYGurnof1jIMJ7py8zc+VqDXWVndua3Dc2SIgtPj73AZfnv+wElGl1d2y9m/HRvV1trJwp//aFJV4/vYhPWSFpH0T7tpXs29aD98pf3jrBn/78XvJ7I0JQHn5ojImJUfCeF46d4vipS8lZc4iRo4d2MTG2hasrS7z691c4cfZ9nEt8Y0AMHDnwJHtG7+mSWflknFz7SjwCRG7u90RVQlRE0k5D8dpFWG/UjaokliVEbnoKrl03QuKEkqixfYqsoHJX3ECxeb1Idx/qdm8LuxFbhdzi57oxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAZkxAatY79HQNV/YpJ1gOmlldNVK3K4pYnXV1Ft+kFC4ulalgF4vbG649sy+BKJCf3kjAypLR29vgffp76TuKQtE2qvVUzoapU9OxAovncnf7Rip9D00ygZeUhOxgsKXlcsqQ/kvFiKzy/WE8n2FMNr0CPC/c5eYnp6r5VUFmzb3snd8BET45MIsc4sryWP3UWH7UB+7RgaIMXDm4im+WryCiCS9M0NVGd5yJ3cPj3VFkmL/TzgvdhHOjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIjAnIzNezxiKEIKwxBgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOC0wOS0xMFQwNTo0MDowNiswMDowMFT52voAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTgtMDktMTBUMDU6NDA6MDYrMDA6MDAlpGJGAAAARnRFWHRzb2Z0d2FyZQBJbWFnZU1hZ2ljayA2LjcuOC05IDIwMTQtMDUtMTIgUTE2IGh0dHA6Ly93d3cuaW1hZ2VtYWdpY2sub3Jn3IbtAAAAABh0RVh0VGh1bWI6OkRvY3VtZW50OjpQYWdlcwAxp/+7LwAAABh0RVh0VGh1bWI6OkltYWdlOjpoZWlnaHQAMTkyDwByhQAAABd0RVh0VGh1bWI6OkltYWdlOjpXaWR0aAAxOTLTrCEIAAAAGXRFWHRUaHVtYjo6TWltZXR5cGUAaW1hZ2UvcG5nP7JWTgAAABd0RVh0VGh1bWI6Ok1UaW1lADE1MzY1NTgwMDZiJ+JmAAAAD3RFWHRUaHVtYjo6U2l6ZQAwQkKUoj7sAAAAVnRFWHRUaHVtYjo6VVJJAGZpbGU6Ly8vbW50bG9nL2Zhdmljb25zLzIwMTgtMDktMTAvZWI1MTNmMmE5ZWRkMzA1ZjhkZWEyODgzYTllYTNhNzguaWNvLnBuZ3XQqTUAAAAASUVORK5CYII=\"","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Tags = props => {\n  if (props && props.references) {\n    return (<div className=\"tags\" style={{ display: \"flex\",flexWrap:\"wrap\" }}>\n      {props.references.map((group,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", backgroundColor: group.color, color: group.textColor }}>\n          {group.title}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nTags.propTypes = {\n  references: PropTypes.array\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const Highlight = props => {\n  \nif (!props.text) return null\nif (!props.filter) return  props.text\n\n    var ix = props.text.toLowerCase().indexOf(props.filter.toLowerCase())\n   if (ix===-1){\n     return props.text\n   }\n\n   \n   var first = props.text.substr(0,ix)\n   var middle = props.text.substr(ix,props.filter.length)\n   var last = props.text.substr(ix+props.filter.length)\n  return (\n    <>\n   \n      <span>{first}</span>\n      <span style={props.style}>{middle}</span>\n       <span>{last}</span>\n    \n    </>\n  );\n};\nHighlight.propTypes = {\n  style: PropTypes.object,\n\n  filter: PropTypes.string,\n  text: PropTypes.string\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Tags } from \"./Tags\";\nimport { Highlight } from \"./Highlight\";\nimport  \"./tile.css\"\nexport const AppSuperTile = props => {\n  var tile = props.tile ? props.tile : {};\n  const [html, setHtml] = useState(\"\");\n\n  return (<>\n\n  {props.tileSize===1 &&\n    <div className=\"supertile\" style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n     <div  style={{\n       \n       margin: 10,\n       padding: 10,\n       backgroundColor: tile.color,\n       color: tile.textcolor,\n       width: 300,\n       height: 70,\n       maxHeight: 70,\n       borderRadius:35,\n       overflow: \"hide\"\n       \n     }}>\n       <div style={{ cursor: \"pointer\" }} onClick={() => {\n         if (props.onClick){\n           props.onClick(tile);\n                }\n   \n       }}>\n         <div style={{display:\"flex\"}}>\n           \n         <div style={{  margin: 8, marginTop:8, height: 40 }}>\n           <img style={{ height: \"auto\", width: 40 }} src={tile.icon} />\n         </div>\n           <div title={tile.title} style={{flexGrow:1,height:\"40px\",width:\"300px\", overflow:\"hidden\",lineHeight:\"40px\",marginTop:\"6px\",marginLeft:\"4px\", fontSize:\"24px\"}}>\n           <Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> \n           </div>\n          \n         <div style={{alignItems:\"flex-end\"}}>\n         <i\n                   style={{cursor:\"pointer\",display:\"none\"}}\n                     class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                     onClick={(e) => {\n                       if (props.onPinnedClicked){\n                         e.preventDefault()\n                         e.stopPropagation()\n                         props.onPinnedClicked(props)\n                       }\n                       \n                     }}\n                     aria-hidden=\"true\"\n                   ></i> \n         </div> </div>\n       \n         {/* <Tags references={tile.references} /> */}\n   \n       </div>\n     </div>\n     \n\n     </div>\n  }\n  {props.tileSize === 0 &&\n  <div style={{border:\"0px dashed grey\",margin:10,maxWidth:\"300px\"}}>\n     \n  <div style={{\n    margin: 10,\n    padding: 10,\n    backgroundColor: tile.color,\n    color: tile.textcolor,\n    width: 300,\n    height: 300,\n    maxHeight: 300,\n    overflow: \"auto\"\n  }}>\n    <div style={{ cursor: \"pointer\" }} onClick={() => {\n      if (props.onClick){\n        props.onClick(tile);\n             }\n\n    }}>\n      <div style={{display:\"flex\"}}><div style={{flexGrow:1}}><Highlight text={tile.title} filter={props.filter} style={props.highlightStyle} /> </div>\n      <div style={{alignItems:\"flex-end\"}}>\n      <i\n                style={{cursor:\"pointer\",display:\"none\"}}\n                  class={props.isPinned ? \"ms-Icon ms-Icon--PinnedFill\" : \"ms-Icon ms-Icon--Pinned\"}\n                  onClick={(e) => {\n                    if (props.onPinnedClicked){\n                      e.preventDefault()\n                      e.stopPropagation()\n                      props.onPinnedClicked(props)\n                    }\n                    \n                  }}\n                  aria-hidden=\"true\"\n                ></i> \n      </div>\n      </div>\n      \n      <div style={{ textAlign: \"center\", margin: 20, marginTop:40, height: 120 }}>\n        <img style={{ height: \"auto\", width: 112 }} src={tile.icon} />\n      </div>\n\n      <div style={{ maxHeight: 60, height: 60, overflow: \"auto\" }}>\n    \n\n        {tile.inShort}\n      </div>\n       <Tags references={tile.references} /> \n\n    </div>\n  </div>\n  \n  <div style={{ display: \"flex\", justifyContent: \"flex-end\" }}>\n        {/* {tile.jumpto && (<a style={{ height: 24 }} className=\"button\" href={tile.jumpto} rel=\"noopener noreferrer\"  target=\"_blank\">\n          Jump to\n            </a>)} */}\n        {tile.externalArticle && (<a style={{ height: 24 }} className=\"button\" href={tile.externalArticle} rel=\"noopener noreferrer\"  target=\"_blank\">\n           More info\n            </a>)}\n      </div>\n  </div>\n  }\n  </>);\n};\nAppSuperTile.propTypes = {\n  tile: PropTypes.object,\n  onClose: PropTypes.func,\n  filter : PropTypes.string,\n  highlightStyle : PropTypes.object,\n  isPinned : PropTypes.bool,\n  onPinnedClicked:PropTypes.func,\n  tileSize:PropTypes.number\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nexport const ViewErrors = props => {\n  if (props && props.errors) {\n    return (<div className=\"tags\" >\n      {props.errors.map((error,key) => {\n        return <div key={key} style={{ padding: \"4px\", margin: \"4px\", }}>\n          When trying {error.context}, you got \n          {JSON.stringify(error)}\n        </div>;\n      })}\n    </div>);\n  }\n  else {\n    return null;\n  }\n};\nViewErrors.propTypes = {\n  errors: PropTypes.array\n};\n","import React, { useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./groupover.css\";\nimport {\n  getTheme,\n  mergeStyleSets,\n  FontWeights,\n  ContextualMenu,\n  Toggle,\n  DefaultButton,\n  Modal,\n  IDragOptions,\n  IconButton,\n  IIconProps,\n} from \"office-ui-fabric-react\";\nconst dragOptions = {\n  moveMenuItemText: \"Move\",\n  closeMenuItemText: \"Close\",\n  menu: ContextualMenu,\n};\nconst cancelIcon = { iconName: \"Cancel\" };\nconst theme = getTheme();\nconst contentStyles = mergeStyleSets({\n  container: {\n    display: \"flex\",\n    flexFlow: \"column nowrap\",\n    alignItems: \"stretch\",\n  },\n  header: [\n    // tslint:disable-next-line:deprecation\n    theme.fonts.xLargePlus,\n    {\n      flex: \"1 1 auto\",\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\n      color: theme.palette.neutralPrimary,\n      display: \"flex\",\n      alignItems: \"center\",\n      fontWeight: FontWeights.semibold,\n      padding: \"12px 12px 14px 24px\",\n    },\n  ],\n  body: {\n    flex: \"4 4 auto\",\n    padding: \"0 24px 24px 24px\",\n    overflowY: \"hidden\",\n    selectors: {\n      p: { margin: \"14px 0\" },\n      \"p:first-child\": { marginTop: 0 },\n      \"p:last-child\": { marginBottom: 0 },\n    },\n  },\n});\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\nconst iconButtonStyles = {\n  root: {\n    color: theme.palette.neutralPrimary,\n    marginLeft: \"auto\",\n    marginTop: \"4px\",\n    marginRight: \"2px\",\n  },\n  rootHovered: {\n    color: theme.palette.neutralDark,\n  },\n};\nexport const GroupMouseOver = (props) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  return (\n    <div className=\"groupOver\">\n      <div className=\"groupOverLink\">\n        <div style={{ display: \"flex\" }}>\n          <div\n            style={{ flexGrow: 1 }}\n            onClick={(e) => {\n              setIsModalOpen(true);\n              e.preventDefault();\n            }}\n          >\n            Open{\" \"}\n          </div>\n          <div style={{backgroundColor:\"red\",color:\"white\"}}\n            onClick={(e) => {\n              e.preventDefault();\n              \n              if (props.onSave) {\n                props.onSave();\n              }\n            }}\n          >\n            Save\n          </div>\n        </div>\n      </div>\n\n      <Modal\n        titleAriaId={1}\n        isOpen={isModalOpen}\n        onDismiss={() => setIsModalOpen(false)}\n        isBlocking={false}\n        containerClassName={contentStyles.container}\n        dragOptions={dragOptions}\n      >\n        <div>\n          <span>Lorem Ipsum</span>\n          <IconButton\n            styles={iconButtonStyles}\n            iconProps={cancelIcon}\n            ariaLabel=\"Close popup modal\"\n            onClick={() => setIsModalOpen(false)}\n          />\n        </div>\n        <div className={contentStyles.body}></div>\n      </Modal>\n    </div>\n  );\n};\n\n\nexport const PinMouseOver = (props) => {\n  const [isModalOpen, setIsModalOpen] = useState(false);\n\n  return (\n    <div className=\"groupOver\" style={{zIndex:3}}>\n      <div className=\"groupOverLink\">\n        <div style={{ display: \"flex\" }}>\n          <div\n            style={{ flexGrow: 1 }}\n            onClick={(e) => {\n              setIsModalOpen(true);\n              e.preventDefault();\n            }}\n          >\n            Open{\" \"}\n          </div>\n          <div style={{backgroundColor:\"red\",color:\"white\"}}\n            onClick={(e) => {\n              \n              e.preventDefault();\n              \n              if (props.onRemove) {\n                props.onRemove();\n              }\n            }}\n          >\n            Remove\n          </div>\n        </div>\n      </div>\n\n      <Modal\n        titleAriaId={1}\n        isOpen={isModalOpen}\n        onDismiss={() => setIsModalOpen(false)}\n        isBlocking={false}\n        containerClassName={contentStyles.container}\n        dragOptions={dragOptions}\n      >\n        <div>\n          <span>Lorem Ipsum</span>\n          <IconButton\n            styles={iconButtonStyles}\n            iconProps={cancelIcon}\n            ariaLabel=\"Close popup modal\"\n            onClick={() => setIsModalOpen(false)}\n          />\n        </div>\n        <div className={contentStyles.body}></div>\n      </Modal>\n    </div>\n  );\n};\n","export const EVENT = {\n  LANDING: \"landing\",\n  ONBOARDING: \"onboarding\",\n  SEARCHING: \"user-searched-for\",\n  SEARCHCLICKED: \"user-clicked-search\",\n  TILECLICKED: \"user-clicked-tile\",\n  TABCLICKED: \"user-clicked-tab\",\n  DETAILSTOGGLED: \"user-toggle-details\",\n  MEMBERSHIPSREAD:\"memberships-read\"\n};\nObject.freeze(EVENT);\n// var d = [\n//     \"init\",\n//     \"logEvent\",\n//     \"logRevenue\",\n//     \"setUserId\",\n//     \"setUserProperties\",\n//     \"setOptOut\",\n//     \"setVersionName\",\n//     \"setDomain\",\n//     \"setDeviceId\",\n//     \"enableTracking\",\n//     \"setGlobalUserProperties\",\n//     \"identify\",\n//     \"clearUserProperties\",\n//     \"setGroup\",\n//     \"logRevenueV2\",\n//     \"regenerateDeviceId\",\n//     \"groupIdentify\",\n//     \"onInit\",\n//     \"logEventWithTimestamp\",\n//     \"logEventWithGroups\",\n//     \"setSessionId\",\n//     \"resetSessionId\",\n//   ];\nexport function who(upn) {\n  if (!window.amplitude) return;\n  if (!upn) return;\n  var amp =  window.amplitude.getInstance()\n  if (!amp) return\n  \n  amp.setUserId(upn);\n\n  var s = upn.split(\"@\");\n  if (s.length === 2) {\n    amp.setDomain(s[1]);\n  }\n}\n\nexport function trace(event, details) {\n  if (!window.amplitude) return;\n  var amp =  window.amplitude.getInstance()\n  if (!amp) return\n  amp.logEvent(event, details);\n  console.log(\"trace\",event, details);\n}\n","import json from \"format-json\";\nimport _ from \"lodash\";\nimport request from \"request\";\nimport axios from \"axios\";\nimport { addElementAtIndex } from \"@fluentui/react\";\nexport var graph = {};\n\nfunction extractEmails(text) {\n  return text.match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9._-]+)/gi);\n}\n\ngraph.analyseMembers = (token, emailAddresses, cb) => {\n  var addresses = [];\n\n  var ar1 = emailAddresses.split(\"\\n\");\n  ar1.forEach((element1) => {\n    var ar2 = element1.split(\";\");\n    ar2.forEach((element2) => {\n      var smptAddresses = extractEmails(element2);\n      smptAddresses.forEach((smtp) => {\n        addresses.push({\n          checked: false,\n          smtp,\n        });\n      });\n    });\n  });\n\n  var results = [];\n  var x = addresses.length;\n  addresses.forEach((address) => {\n    graph.readUser(token, address.smtp, 0, (err, user) => {\n      x--;\n      address.user = user;\n      address.err = err;\n      results.push(address);\n      if (x < 1) {\n        cb(null, results);\n        address.checked = true;\n      }\n    });\n  });\n};\ngraph.invite = (token, emailAddress, invitationRedirectUrl, cb) => {\n  var msg = {\n    invitedUserEmailAddress: emailAddress,\n    inviteRedirectUrl: invitationRedirectUrl,\n    invitedUserDisplayName: emailAddress,\n    sendInvitationMessage: false,\n    invitedUserMessageInfo: {\n      customizedMessageBody:\n        \"We are really happy to invite you to the JUMPTO365 #Insider program \",\n      ccRecipients: [\n        {\n          emailAddress: {\n            name: \"Niels\",\n            address: \"niels@jumpto365.com\",\n          },\n        },\n      ],\n    },\n  };\n  post(token, `https://graph.microsoft.com/v1.0/invitations`, msg, function (\n    err,\n    response\n  ) {\n    if (err) {\n      return cb(err);\n    }\n    cb(null, response);\n  });\n};\ngraph.addcrm = (token, emailAddress, first, last, tag, cb) => {\n  var msg = {\n    properties: [\n      {\n        property: \"firstname\",\n        value: first,\n      },\n      {\n        property: \"lastname\",\n        value: last,\n      },\n      {\n        property: \"internal_categories\",\n        value: tag,\n      },\n      // {\n      //   \"property\": \"phone\",\n      //   \"value\": \"@{body('Signin')['mobilePhone']}\"\n      // },\n      // {\n      //   \"property\": \"jobtitle\",\n      //   \"value\": \"@{body('Signin')['jobTitle']}\"\n      // },\n      // {\n      //   \"property\": \"country\",\n      //   \"value\": \"@{body('Signin')['country']}\"\n      // }\n    ],\n  };\n\n  post2(\n    token,\n    `https://api.hubapi.com/contacts/v1/contact/createOrUpdate/email/${emailAddress}/?hapikey=f305d92f-b379-4063-95fb-57e9d56976f2`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null, response);\n    }\n  );\n};\ngraph.addmember = (token, userId, groupId, cb) => {\n  var msg = {\n    \"@odata.id\": `https://graph.microsoft.com/beta/directoryObjects/${userId}`,\n  };\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/members/$ref`,\n    msg,\n    function (err, response) {\n      if (err) {\n        return cb(err);\n      }\n      cb(null);\n    }\n  );\n};\n\ngraph.getSharePointList = (\n  token,\n  host,\n  site,\n  list,\n  listfilter,\n  itemfilter,\n  cb\n) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items?${listfilter}`,\n    function (e, items) {\n      if (e) return cb(e);\n      var itemList = [];\n\n      function next() {\n        if (items.length === 0) return cb(null, itemList);\n        var item = items.pop();\n\n        get(\n          token,\n          `https://graph.microsoft.com/v1.0/sites/${host}:${site}:/lists/${list}/items/${item.id}?${itemfilter}`,\n          function (e, item) {\n            if (e) return cb(e);\n            itemList.push(item);\n            next();\n          }\n        );\n      }\n\n      next();\n    }\n  );\n};\n\ngraph.getPages = (token, host, site, cb) => {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${host}:${site}`,\n    function (e, site) {\n      if (e) return cb(e);\n\n      get(\n        token,\n        `https://graph.microsoft.com/beta/sites/${site.id}/pages`,\n        function (e, items) {\n          if (e) return cb(e);\n\n          return cb(null, items);\n        }\n      );\n    }\n  );\n};\ngraph.readGroupMembers = function (token, groupId, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/beta/groups/\" +\n      groupId +\n      \"/members?$select=mail,department,displayName,country,accountEnabled,userPrincipalName,givenName,surname,id\",\n    cb\n  );\n};\n\n\ngraph.readGroupMemberShipFor = function (token, upn, cb) {\n  get(token, \"https://graph.microsoft.com/v1.0/users/\" + upn + \"/memberOf\", cb);\n};\n\ngraph.readManager = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName + \"/manager\",\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\ngraph.readUser = function (token, userPrincipalName, index, cb) {\n  get(\n    token,\n    \"https://graph.microsoft.com/v1.0/users/\" + userPrincipalName,\n    cb,\n    null,\n    index\n  );\n};\n\ngraph.matchingGroups = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=startsWith(displayName,'${searchText}')`,\n    cb\n  );\n};\n\ngraph.findGroup = function (token, searchText, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/groups?$select=displayName,id,mail,mailNickname,groupTypes,description&$filter=mailNickname eq '${searchText}'`,\n    cb\n  );\n};\n\ngraph.getGroupDocuments = function (token, groupId, folderName, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root:${folderName}:/children`,\n    cb\n  );\n};\n\ngraph.getGroupDrive = function (token, groupId, cb) {\n  get(token, `https://graph.microsoft.com/beta/groups/${groupId}/drive`, cb);\n};\ngraph.getGroupSite = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/sites/root`,\n    cb\n  );\n};\n\ngraph.getDriveChildren = function (token, driveId, itemId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/drives/${driveId}/items/${itemId}/children`,\n    cb\n  );\n};\n\ngraph.getGroupRootFolders = function (token, groupId, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/beta/groups/${groupId}/drive/items/root/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteDrive = function (token, id, path, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${id}/drive/root:/${path}:/children`,\n    cb\n  );\n};\n\ngraph.getSharePointSiteByName = function (token, hostName, relativePath, cb) {\n  get(\n    token,\n    `https://graph.microsoft.com/v1.0/sites/${hostName}:/sites/${relativePath}`,\n    cb\n  );\n};\n\ngraph.copyfile = function (\n  token,\n  groupNickName,\n  fromFolder,\n  fromName,\n  toFolder,\n  toName,\n  cb\n) {\n  graph.findGroup(token, groupNickName, function (err, groups) {\n    if (err) return cb(err);\n    if (groups.length !== 1) return cb(\"Did't find a unique group\");\n    var group = groups[0];\n    graph.getGroupDocuments(token, group.id, \"/\" + fromFolder, function (\n      err,\n      fromItems\n    ) {\n      if (err) return cb(err);\n      var match = _.find(fromItems, { name: fromName });\n      graph.getGroupRootFolders(token, group.id, function (err, targetFolders) {\n        if (err) return cb(err);\n        var destFolder = _.find(targetFolders, { name: toFolder });\n        if (!destFolder) return cb(\"Did't find target folder\");\n        graph.newDoc(\n          token,\n          group.id,\n          match.id,\n          destFolder.parentReference.driveId,\n          destFolder.id,\n          toName,\n          function (err, result) {\n            if (err) return cb(err);\n            return cb(null, result);\n          }\n        );\n      });\n    });\n  });\n};\n\nfunction lookupFile(token, driveId, id, name, iterations, cb) {\n  // Content have been copied\n  graph.getDriveChildren(token, driveId, id, function (err, result) {\n    if (err) {\n      return cb(err);\n    }\n    // content of destination folder\n\n    for (let index = 0; index < result.length; index++) {\n      const file = result[index];\n\n      console.log(\"Comparing\", file.name, name);\n      if (file.name === name) {\n        // match found\n        console.log(\"Match found\");\n        return cb(null, file);\n      }\n    }\n\n    var iteration = 0;\n    function retry() {\n      console.log(\"Retrying\", iterations);\n      //\n      if (iteration > 10) {\n        return cb(\n          `Think that the file has been created, but could not find a reference to if. Filename is ${name} - Tryed ${iterations} to find it `\n        );\n      }\n      lookupFile(token, driveId, id, name, iterations + 1, cb);\n    }\n    // no match found so we will wait a second a try again\n    setTimeout(retry, 1000);\n  });\n}\n\ngraph.newDoc = function (token, sourceGroupId, itemId, driveId, id, name, cb) {\n  post(\n    token,\n    `https://graph.microsoft.com/beta/groups/${sourceGroupId}/drive/items/${itemId}/copy`,\n    {\n      parentReference: {\n        driveId: driveId,\n        id: id,\n      },\n      name: name,\n    },\n    function (err) {\n      // no result from that call - by design from Microsoft\n      if (err) {\n        return cb(err);\n      }\n\n      // so we fill try to find a referece our self\n      lookupFile(token, driveId, id, name, 0, cb);\n    }\n  );\n};\nexport const graphWithPromise = {};\ngraphWithPromise.me = (token) => {\n  return new Promise((resolve, reject) => {\n    get(\n      token,\n      \"https://graph.microsoft.com/v1.0/me/\",\n      (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      },\n      null\n    );\n  });\n};\n\nclass Client {\n  constructor() {\n    this.token = auth.getAccessToken();\n  }\n  get = (url) => {\n    return new Promise((resolve, reject) => {\n      get(this.token, url, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n\n  post = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      post(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n\n  patch = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      patch(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  put = (url, payload) => {\n    return new Promise((resolve, reject) => {\n      put(this.token, url, payload, (error, result) => {\n        if (error) {\n          return reject(error);\n        }\n        return resolve(result);\n      });\n    });\n  };\n  getRaw = (url) => {\n    return getRaw(this.token, url);\n  };\n  getImage = (url) => {\n    return getImage(this.token, url);\n  };\n}\n\nfunction imageToBase64(blob) {\n  return new Promise((resolve, reject) => {\n    try {\n      var reader = new FileReader();\n\n      reader.onload = function () {\n        var blobAsDataUrl = reader.result;\n\n        resolve(blobAsDataUrl);\n      };\n\n      reader.readAsDataURL(new Blob([blob]));\n    } catch (error) {\n      debugger;\n      resolve(null);\n    }\n  });\n}\nconst get2 = (url) => {\n  var client = new Client();\n  return client.get(url);\n};\n\nconst patch2 = (url, payload) => {\n  var client = new Client();\n  return client.patch(url, payload);\n};\nconst post2 = (url, payload) => {\n  var client = new Client();\n  return client.post(url, payload);\n};\nconst put2 = (url, payload) => {\n  var client = new Client();\n  return client.put(url, payload);\n};\n/**\n *\n */\nexport const me = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me\");\n};\nexport const myGroups = () => {\n  return get2(\"https://graph.microsoft.com/v1.0/me/memberOf\");\n};\nexport const readTeam = (id) => {\n  return get2(\"https://graph.microsoft.com/v1.0/groups/\" + id);\n};\n\nexport const readTeamChannelMessages = (groupId,channelId) => {\n  return get2(`https://graph.microsoft.com/beta/teams/${groupId}/channels/${channelId}/messages`);\n};\n\n\nexport const getMyExtention = (extensionName) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`\n  );\n};\n\nexport const getOneDriveFolder = (folderNameWithOutInitialSlash) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}`\n  );\n};\nexport const getOneDriveFolderContent = (folderNameWithOutInitialSlash) => {\n  return get2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${folderNameWithOutInitialSlash}:/children`\n  );\n};\n\nexport const getOneDriveFile = (folderNameWithOutInitialSlash, filename) => {\n  return new Promise(async (resolve, reject) => {\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\n      (e) => {\n        reject(e);\n      }\n    );\n    if (!folder) return;\n\n    get2(\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}`\n    )\n      .then((file) => {\n        axios\n          .get(file[\"@microsoft.graph.downloadUrl\"])\n          .then((response) => {\n            resolve(response.data);\n          })\n          .catch((e) => {\n            reject(e);\n          });\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n};\n\nexport const saveOneDriveFile = (\n  folderNameWithOutInitialSlash,\n  filename,\n  payload\n) => {\n  return new Promise(async (resolve, reject) => {\n    console.log(\"Size of payload\", payload.length);\n    var folder = await getOneDriveFolder(folderNameWithOutInitialSlash).catch(\n      (e) => {\n        reject(e);\n      }\n    );\n    if (!folder) return;\n\n    put2(\n      `https://graph.microsoft.com/v1.0/me/drive/items/${folder.id}:/${filename}:/content`,\n      payload\n    )\n      .then((result) => {\n        resolve(result);\n      })\n      .catch((e) => {\n        reject(e);\n      });\n  });\n};\n\nexport const createOneDriveFolder = (folderNameWithOutInitialSlash) => {\n  const driveItem = {\n    name: folderNameWithOutInitialSlash,\n    folder: {},\n    \"@microsoft.graph.conflictBehavior\": \"replace\",\n  };\n\n  return post2(\n    `https://graph.microsoft.com/v1.0/me/drive/root/children`,\n    driveItem\n  );\n};\n\nexport const createOneDriveFolderChild = (\n  parentFolderNameWithOutInitialSlash,\n  folderNameWithOutInitialSlash\n) => {\n  const driveItem = {\n    name: folderNameWithOutInitialSlash,\n    folder: {},\n    \"@microsoft.graph.conflictBehavior\": \"replace\",\n  };\n\n  return post2(\n    `https://graph.microsoft.com/v1.0/me/drive/root:/${parentFolderNameWithOutInitialSlash}:/children`,\n    driveItem\n  );\n};\n\nexport const saveMyExtention = (extensionName, data) => {\n  return new Promise(async (resolve, reject) => {\n    var existing = await getMyExtention(extensionName).catch((e) => {});\n    if (!existing) {\n      addMyExtention(extensionName, data)\n        .then((r) => {\n          resolve(r);\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    } else {\n      updateMyExtention(extensionName, data)\n        .then((r) => {\n          resolve(r);\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    }\n  });\n};\nexport const updateMyExtention = (extensionName, data) => {\n  var payload = {\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n    extensionName: extensionName,\n    ...data,\n  };\n  return patch2(\n    `https://graph.microsoft.com/v1.0/me/extensions/${extensionName}`,\n    payload\n  );\n};\nexport const addMyExtention = (extensionName, data) => {\n  var payload = {\n    \"@odata.type\": \"#microsoft.graph.openTypeExtension\",\n    extensionName: extensionName,\n    ...data,\n  };\n  return post2(`https://graph.microsoft.com/v1.0/me/extensions`, payload);\n};\n\nexport const teamMemberships = (reportProgessPercent) => {\n  var client = new Client();\n  return new Promise(async (resolve, reject) => {\n    try {\n      var memberships = await client\n        .get(\"https://graph.microsoft.com/v1.0/me/memberOf\")\n        .catch((error) => reject(error));\n      var pending = 0;\n      var groups = [];\n\n      if (!memberships) return reject(\"Not able to read membership\");\n\n      //memberships = [memberships[0]];\n      var total = memberships.length;\n      var processed = 0;\n      if (reportProgessPercent) reportProgessPercent(0);\n      memberships.map(async (value) => {\n        pending++;\n\n        var group = await readGroup(value, client);\n\n        processed++;\n        if (reportProgessPercent) reportProgessPercent(processed / total);\n        groups.push(group);\n\n        pending--;\n        if (pending === 0) {\n          return resolve(\n            groups.sort((a, b) => {\n              if (a.text < b.text) {\n                return -1;\n              }\n              if (a.text > b.text) {\n                return 1;\n              }\n              return 0;\n            })\n          );\n        }\n      });\n    } catch (error) {\n      debugger;\n      reject(error);\n    }\n  }, null);\n};\n\nexport var auth = {};\n\nauth.getAccessToken = function () {\n  return sessionStorage.getItem(\"access_token\");\n};\n\nfunction readGroup(value, client) {\n  return new Promise(async (resolve, reject) => {\n    var group = {\n      ...value,\n      key: value.id,\n      text: value.title ? value.title : value.displayName,\n      title: value.description,\n    };\n    var photo = await client\n      .getImage(\n        `https://graph.microsoft.com/v1.0/groups/${value.id}/photo/$value`\n      )\n      .catch((error) => {\n        debugger;\n        console.log(\"Photo read error\");\n      });\n    if (photo && photo.indexOf(\"data:application/json\") > -1) photo = null;\n\n    var details = await client\n      .get(`https://graph.microsoft.com/v1.0/teams/${value.id}`)\n      .catch((error) => console.log(\"Team details read error\"));\n    (value.creationOptions ? value.creationOptions : []).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    (value.resourceProvisioningOptions\n      ? value.resourceProvisioningOptions\n      : []\n    ).forEach((v) => {\n      if (v === \"YammerProvisioning\") group.hasYammer = true;\n      if (v === \"ProvisionGroupHomepage\") group.hasSharePoint = true;\n    });\n    \n    // https://www.techmikael.com/2017/11/retrieving-teams-and-yammer-endpoints.html\n    var channels = await readChannels(client, value).catch((e) => {});\n    var endPoints = await readEndpoints(client, value).catch((e) => {});\n    group.hasTeams = channels !== undefined;\n    group.data = {\n      endPoints,\n      details,\n      photo,\n      channels: channels,\n    };\n    resolve(group);\n  });\n}\n\nasync function readChannels(client, value) {\n  var queue = 0;\n  return new Promise(async (resolve, reject) => {\n    var channels = await client\n      .get(`https://graph.microsoft.com/beta/teams/${value.id}/channels`)\n      .catch((error) => {\n        console.log(\"Channel read error\");\n      });\n    if (!channels) return resolve();\n\n    channels.forEach(async (channel) => {\n      queue++;\n      var tabs = await client\n        .get(\n          `https://graph.microsoft.com/beta/teams/${value.id}/channels/${channel.id}/tabs`\n        )\n        .catch((error) => {\n          console.log(\"Channel read tabs\", error);\n        });\n\n      channel.tabs = tabs;\n      queue--;\n      if (queue === 0) {\n        resolve(channels);\n      }\n    });\n  });\n}\n\nasync function readEndpoints(client, value) {\n  return client.get(\n    `https://graph.microsoft.com/beta/groups/${value.id}/endpoints`\n  );\n}\n\nfunction post(token, url, body, cb) {\n  axios\n    .post(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\n\nfunction patch(token, url, body, cb) {\n  axios\n    .patch(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\n\nfunction put(token, url, body, cb) {\n  axios\n    .put(url, body, {\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    })\n    .then((result) => {\n      cb(null, result.data);\n    })\n    .catch((e) => {\n      cb(e);\n    });\n}\nexport function getRaw(token, url) {\n  console.log(\"getting\", url);\n\n  return new Promise((resolve, reject) => {\n    request.get(\n      {\n        url: url,\n        headers: {\n          authorization: \"Bearer \" + token,\n        },\n      },\n      function (err, response, body) {\n        if (err) {\n          return reject(err);\n        }\n        resolve({ body, response });\n      }\n    );\n  });\n}\n\nfunction getImage(token, url) {\n  return new Promise((resolve, reject) => {\n    try {\n      var xhr = new XMLHttpRequest();\n\n      xhr.onload = function () {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(xhr.response);\n      };\n\n      xhr.open(\"GET\", url);\n      xhr.setRequestHeader(\"Authorization\", \"Bearer \" + token);\n      xhr.responseType = \"blob\";\n      xhr.send();\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n\nexport function get(token, url, cb, appendTo, index, retrycount) {\n  console.log(\"getting\", url, appendTo === true);\n  request.get(\n    {\n      url: url,\n      headers: {\n        \"content-type\": \"application/json\",\n        authorization: \"Bearer \" + token,\n      },\n    },\n    function (err, response, body) {\n      var parsedBody;\n\n      if (err) {\n        var errCounter = retrycount ? retrycount + 1 : 1;\n        if (errCounter > 3) {\n          return cb(err, null, index);\n        } else {\n          // retry\n          console.log(\"retry #\", errCounter);\n          return get(token, url, cb, appendTo, index, errCounter);\n        }\n      }\n\n      parsedBody = JSON.parse(body);\n      if (parsedBody.error) {\n        return cb(parsedBody.error, null, index);\n      }\n\n      if (parsedBody[\"@odata.nextLink\"]) {\n        var data;\n        if (!appendTo) {\n          data = parsedBody.value;\n        } else {\n          data = appendTo.concat(parsedBody.value);\n        }\n\n        return get(token, parsedBody[\"@odata.nextLink\"], cb, data, index);\n      }\n\n      if (appendTo) {\n        cb(null, appendTo.concat(parsedBody.value), index);\n      } else {\n        if (parsedBody.value) {\n          cb(null, parsedBody.value, index);\n        } else {\n          cb(null, parsedBody, index);\n        }\n      }\n    }\n  );\n}\n","import {\n  me,\n  myGroups,\n  readTeam,\n  getMyExtention,\n  saveMyExtention,\n  getOneDriveFolder,\n  createOneDriveFolder,\n  getOneDriveFolderContent,\n  createOneDriveFolderChild,\n  getOneDriveFile,\n  saveOneDriveFile,\n} from \"./OfficeGraph\";\n\nimport projectInfo from \"../../package.json\";\nimport _ from \"lodash\";\nimport Axios from \"axios\";\nexport const extentionName = \"com.ztickybar.tools\";\nexport const OURPATH = \"Apps/jumpto365.com\";\nexport const BOARDSPATH = \"Apps/jumpto365.com/boards\";\nexport const BOARDS = \"boards\";\n\nexport const OURCONFIGFILENAME = \"launchpad.json\";\nexport const BOARDINDEXFILENAME = \"index-contexts.json\"\n\nexport function saveCache(memberships) {\n  return new Promise((resolve, reject) => {\n    var membershipIndex = [];\n    var queue = 0;\n    memberships.forEach((membership) => {\n      membershipIndex.push(membership.id);\n      queue++;\n\n      saveOneDriveFile(OURPATH, cachedFileName(membership.id), membership).then(\n        () => {\n          queue--;\n          if (queue < 1) {\n            saveOneDriveFile(OURPATH, \"memberships.json\", membershipIndex)\n              .then(() => {\n                resolve(membershipIndex);\n              })\n              .catch((e) => {\n                reject(e);\n              });\n          }\n        }\n      );\n    });\n  });\n}\n\nfunction cachedFileName(id) {\n  return \"membership.\" + id + \".json\";\n}\n\nexport function readCache() {\n  return new Promise(async (resolve, reject) => {\n    var membershipIndex = await getOneDriveFile(\n      OURPATH,\n      \"memberships.json\"\n    ).catch((e) => {\n      reject(e);\n    });\n    if (!membershipIndex) return;\n    var queue = 0;\n    var memberships = [];\n    membershipIndex.forEach((id) => {\n      queue++;\n      getOneDriveFile(OURPATH, cachedFileName(id))\n        .then((data) => {\n          memberships.push(data);\n          queue--;\n          if (queue < 1) {\n            resolve(memberships);\n          }\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    });\n  });\n}\n\n/**\n * Verifies access to all endpoints used for the LaunchPad app\n *\n * @param {*} setCheckMe Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckMyExtention  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckOneDrive  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckOneDriveFiles  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckMemberships  Callback accepting a string - \"OK\" or an error\n * @param {*} setCheckTeam  Callback accepting a string - \"OK\" or an error\n */\nexport async function verifyAccessForLanuchPad(\n  setCheckMe,\n  setCheckMyExtention,\n  setCheckOneDrive,\n  setCheckOneDriveFiles,\n  setCheckMemberships,\n  setCheckTeam\n) {\n  me()\n    .then((m) => {\n      setCheckMe(\"OK\");\n    })\n    .catch((e) => {\n      setCheckMe(e.message);\n    });\n\n  var extention = await saveMyExtention(extentionName, {\n    hello: \"world\",\n  }).catch((e) => {\n    setCheckMyExtention(e.message);\n  });\n  if (extention || extention === \"\") {\n    setCheckMyExtention(\"OK\");\n  }\n\n  getOneDriveFolder(OURPATH)\n    .then((r) => {\n      setCheckOneDrive(\"OK\");\n      checkAccessToConfig();\n    })\n    .catch(async (e) => {\n      var f = await getOneDriveFolder(\"Apps\").catch((e) => {});\n      if (f) {\n        var child = await createOneDriveFolderChild(\n          \"Apps\",\n          \"jumpto365.com\"\n        ).catch((e) => {\n          setCheckOneDrive(e.message);\n        });\n        if (child) {\n          setCheckOneDrive(\"OK\");\n          checkAccessToConfig();\n        }\n      } else {\n        var child = await createOneDriveFolder(\"Apps\").catch((e) => {\n          setCheckOneDrive(e.message);\n        });\n        child = await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\").catch(\n          (e) => {\n            setCheckOneDrive(e.message);\n          }\n        );\n        if (child) {\n          setCheckOneDrive(\"OK\");\n          checkAccessToConfig();\n        }\n      }\n    });\n\n  myGroups()\n    .then((memberships) => {\n      setCheckMemberships(\"OK\");\n      var teamId;\n      memberships.forEach((member) => {\n        if (member.displayName) {\n          if (!teamId) {\n            teamId = member.id;\n          }\n        }\n      });\n      if (teamId) {\n        readTeam(teamId)\n          .then((m) => {\n            setCheckTeam(\"OK\");\n          })\n          .catch((e) => {\n            setCheckTeam(e.message);\n          });\n      } else {\n        setCheckTeam(\"Didn't find any Microsoft Teams memberships\");\n      }\n    })\n    .catch((e) => {\n      setCheckMemberships(e.message);\n    });\n\n  async function checkAccessToConfig() {\n    var settings = await getOneDriveFile(OURPATH, OURCONFIGFILENAME).catch(\n      async (e) => {\n        var file = await saveOneDriveFile(OURPATH, OURCONFIGFILENAME, {\n          version: projectInfo.version,\n        }).catch((e) => {\n          setCheckOneDriveFiles(e.message);\n        });\n        if (file) {\n          setCheckOneDriveFiles(\"OK\");\n        }\n      }\n    );\n    if (settings) {\n      setCheckOneDriveFiles(\"OK\");\n      checkAccessToContexts();\n    }\n  }\n}\n\nexport async function checkAccessToContexts() {\n  await createOneDriveFolderChild(\"Apps\", \"jumpto365.com\");\n  await createOneDriveFolderChild(OURPATH, BOARDS);\n}\n\nexport function saveBoard(memberships, name) {\n  return new Promise(async (resolve, reject) => {\n    await createOneDriveFolderChild(BOARDSPATH, name);\n    var currentBoardPath = BOARDSPATH + \"/\" + name;\n    var membershipIndex = [];\n    var queue = 0;\n    memberships.forEach((membership) => {\n      membershipIndex.push(membership.id);\n      queue++;\n\n      saveOneDriveFile(\n        currentBoardPath,\n        cachedFileName(membership.id),\n        membership\n      ).then(() => {\n        queue--;\n        if (queue < 1) {\n          saveOneDriveFile(\n            currentBoardPath,\n            \"memberships.json\",\n            membershipIndex\n          )\n            .then(() => {\n              resolve(membershipIndex);\n            })\n            .catch((e) => {\n              reject(e);\n            });\n        }\n      });\n    });\n  });\n}\n\nexport function readBoard(name) {\n  return new Promise(async (resolve, reject) => {\n    var currentBoardPath = BOARDSPATH + \"/\" + name;\n    var membershipIndex = await getOneDriveFile(\n      currentBoardPath,\n      \"memberships.json\"\n    ).catch((e) => {\n      reject(e);\n    });\n    if (!membershipIndex) return;\n    var queue = 0;\n    var memberships = [];\n    membershipIndex.forEach((id) => {\n      queue++;\n      getOneDriveFile(currentBoardPath, cachedFileName(id))\n        .then((data) => {\n          memberships.push(data);\n          queue--;\n          if (queue < 1) {\n            resolve(memberships);\n          }\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    });\n  });\n}\n\nvar buffer = {\n  layouts: { pending: false },\n};\n\nfunction delaywriteLayouts() {\n  setTimeout(() => {\n    console.log(\"delaywriteLayouts\");\n    if (!buffer.layouts.pending) {\n      return;\n    }\n    if (buffer.layouts.writing) {\n      return delaywriteLayouts();\n    }\n    writeLayouts(\n      buffer.layouts.folder,\n      buffer.layouts.file,\n      buffer.layouts.data\n    );\n  }, 2000);\n}\n\nexport function writeLayouts(folder, file, data) {\n  // if (data.myTeams.length === 0) {\n  //   console.log(\"Ignoring writeLayouts with no teams\")\n  //   return}\n  return new Promise(async (resolve, reject) => {\n    console.log(\"writeLayouts\");\n    if (buffer && buffer.layouts && buffer.layouts.writing) {\n      if (_.isEqual(buffer.layouts.data, data)) {\n        console.log(\"writeLayouts no changes\");\n        return resolve();\n      }\n      buffer.layouts.pending = true;\n      buffer.layouts.data = data;\n      buffer.layouts.file = file;\n      buffer.layouts.folder = folder;\n      delaywriteLayouts();\n      return resolve();\n    }\n\n    try {\n      buffer.layouts.writing = true;\n      buffer.layouts.current = data;\n\n      await saveOneDriveFile(folder, file, data);\n      buildIndexOfLaunzhBoards()\n      resolve();\n    } catch (error) {\n      console.log(\"writeLayouts > error\", error);\n      return reject(error);\n    } finally {\n      buffer.layouts.writing = false;\n    }\n  });\n}\n\nexport function readLayouts(folder, file) {\n  return getOneDriveFile(folder, file);\n}\n\nexport function readBoardFiles() {\n  return getOneDriveFolderContent(BOARDSPATH);\n}\n\nexport function readBoards() {\n  return new Promise(async (resolve, reject) => {\n    var files = await getOneDriveFolderContent(BOARDSPATH).catch((e) => {\n      reject(e);\n    });\n    if (!files) return; // rejected in catch - hopefully (-;\n\n    var pending = 0;\n    var results = [];\n    files.forEach((file) => {\n      pending++;\n      Axios.get(file[\"@microsoft.graph.downloadUrl\"])\n        .then((result) => {\n          pending--;\n          results.push({\n            file,\n            content: result.data,\n          });\n          if (pending < 1) {\n            resolve(results);\n          }\n        })\n        .catch((e) => {\n          reject(e);\n        });\n    });\n  });\n}\nexport function teamsLink(href) {\n  if (href) {\n    var part1 = href.split(\"https://teams.microsoft.com/l/team/\");\n    var part2 = part1[1].split(\"/conversations?\");\n    var part3 = href.split(\"groupId=\");\n    var part4 = part3[1].split(\"&\");\n    var part5 = href.split(\"tenantId=\");\n    var threadId = part2[0];\n    var groupId = part4[0];\n    var tenantId = part5[1];\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    return conversationsHref;\n  } else {\n    return null;\n  }\n}\nexport function teamsLink2(href) {\n  if (href) {\n    var part1 = href.split(\"https://teams.microsoft.com/l/channel/\");\n    var part2 = part1[1].split(\"/conversations?\");\n    var part3 = href.split(\"groupId=\");\n    var part4 = part3[1].split(\"&\");\n    var part5 = href.split(\"tenantId=\");\n    var threadId = part2[0];\n    var groupId = part4[0];\n    var tenantId = part5[1];\n    var conversationsHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/conversations/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    var filesHref = `https://teams.microsoft.com/_?tenantId=${tenantId}#/files/unknown?groupId=${groupId}&threadId=${threadId}&ctx=channel`;\n    return conversationsHref;\n  } else {\n    return null;\n  }\n}\nexport function getHref(team){\n  var href =\n  team && team.data && team.data.details ? team.data.details.webUrl : \"\";\n  if (team.data ) {\n    var uniqueEndPoints = _.groupBy(\n      team.data.endPoints ? team.data.endPoints : [],\n      (endPoint) => {\n        return endPoint.providerName;\n      }\n    );\n  }\n    var conversationsHref =\n      team && team.tile\n        ? team.tile.jumpto\n          ? team.tile.jumpto\n          : team.tile.externalArticle\n        : uniqueEndPoints[\"Yammer\"]\n        ? uniqueEndPoints[\"Yammer\"][0].uri\n        : teamsLink(href);\n\n    return conversationsHref\n}\n\n\n/**\n * Read all context for a given user and build an index of where a given URL is found\n */\nexport function buildIndexOfLaunzhBoards() {\n  return new Promise(async (resolve, reject) => {\n    var index = {}\n    var ctxs = await readBoards()\n    \n    ctxs.forEach(ctx => {\n      try {\n        \n     var fullname = ctx.file.name.split(\".\")\n     var name = fullname ? fullname[0] : ctx.file.name\n  \n\n\n      ctx.content.myTeams.forEach(team => {\n        \n        var href = getHref(team)\n        if (!index[href]){\n          index[href] = [{name,color:\"#000000\",backgroundColor:\"#b3e6a9\"}]\n        }else{\n          index[href].push({name,color:\"#000000\",backgroundColor:\"#b3e6a9\"})\n        }\n        \n      });\n    } catch (error) {\n        console.log(\"indexLaunzhContexts\",error)\n    }\n    });\n    await saveOneDriveFile(OURPATH, BOARDINDEXFILENAME , index);\n  });\n}\n\nexport function readIndexOfLaunzhBoards() {\n  return getOneDriveFile(OURPATH, BOARDINDEXFILENAME);\n}","import React, {\n  Component,\n  useState,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n} from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Highlight } from \"./Highlight\";\nimport Masonry from \"react-masonry-css\";\nimport moment from \"moment\";\nimport \"./masonry.css\";\nimport { GroupMouseOver, PinMouseOver } from \"./MouseOver\";\nimport _ from \"lodash\";\nimport { EVENT, trace } from \"../helpers/trace\";\n\nimport { getHref, teamsLink, teamsLink2 } from \"../helpers/LaunchPad\";\nimport \"./tile.css\";\nimport { navigate } from \"@reach/router\";\nimport { ActionButton, Button, IconButton } from \"@fluentui/react\";\nimport { readTeamChannelMessages } from \"../helpers/OfficeGraph\";\nconst breakpointColumnsObj = {\n  default: 11,\n\n  3600: 11,\n\n  3300: 10,\n  3000: 9,\n  2700: 8,\n  2400: 7,\n\n  2100: 6,\n  1800: 5,\n  1500: 4,\n  1200: 3,\n  900: 2,\n  600: 1,\n  //300: 1,\n};\nexport const useContainerDimensions = (myRef) => {\n  const getDimensions = () => ({\n    width: myRef.current.offsetParent.offsetWidth,\n    height: myRef.current.offsetParent.offsetHeight,\n  });\n\n  const [dimensions, setDimensions] = useState({ width: 0, height: 0 });\n\n  useEffect(() => {\n    if (myRef.current) {\n      setDimensions(getDimensions());\n    }\n  }, []);\n\n  return dimensions;\n};\nexport const ViewTeams = (props) => {\n  const [viewChannels, setViewChannels] = useState(props.details);\n  const [viewDates, setViewDates] = useState(false);\n\n  if (props && props.memberShips) {\n    var memberShips = _.cloneDeep(props.memberShips);\n\n    if (props.tiles) {\n      props.tiles.forEach((tile) => {\n        //debugger\n        memberShips.push({\n          displayName: tile.title,\n          tile,\n        });\n      });\n\n      memberShips = _.sortBy(memberShips, [\"displayName\"]);\n    }\n    return (\n      <div\n        className=\"tags\"\n        style={{\n          padding: \"4px\",\n          margin: \"4px\",\n          fontSize: \"16px\",\n          display: \"flex\",\n          flexWrap: \"wrap\",\n          minWidth: \"300px\",\n        }}\n      >\n        <Masonry\n          breakpointCols={breakpointColumnsObj}\n          className=\"my-masonry-grid\"\n          columnClassName=\"my-masonry-grid_column\"\n        >\n          {/* array of JSX items */}\n\n          {memberShips.map((team, key) => {\n            //    if ((!team.resourceProvisioningOptions || !team.resourceProvisioningOptions.length > 0) && (team.creationOptions && !team.creationOptions.length > 0)) return null\n            //if ( team[\"@odata.type\"] === \"#microsoft.graph.directoryRole\") return null\n            // Profoe: \"https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=profile\"\n\n            return (\n              <ViewTeam\n                {...props}\n                key={key}\n                team={team}\n                viewChannels={props.details}\n                viewDates={viewDates}\n                onSaveTeam={props.onSaveTeam}\n              />\n            );\n          })}\n        </Masonry>\n      </div>\n    );\n  } else {\n    return null;\n  }\n};\n\nexport function ViewTeam(props) {\n  const viewChannels = props.viewChannels;\n  const [viewDates, setViewDates] = useState(props.viewDates);\n  const [mouseOver, setMouseOver] = useState(false);\n  const componentRef = useRef();\n\n  const team = props.team ? props.team : {};\n\n  function logo(show, icon) {\n    if (!show) return null;\n    var c = \"ms-fontSize-28 ms-Icon ms-Icon--\" + icon;\n    return <i className={c} style={{ padding: \"4px\" }} aria-hidden=\"true\"></i>;\n  }\n\n  // Notebook https://365adm.sharepoint.com/_layouts/groupstatus.aspx?id=786dc6d7-766f-46df-ac4b-d6883597061f&target=notebook\"\n  // Planner \"https://tasks.office.com/365adm.onmicrosoft.com/en-US/Home/Group/786dc6d7-766f-46df-ac4b-d6883597061f\"\n\n  var conversationsHref = getHref(team);\n\n  var details =\n    team.data && team.data.details\n      ? team.data.details\n      : {\n          displayName: team.title\n            ? team.title\n            : team.displayName\n            ? team.displayName\n            : team[\"@odata.type\"],\n        };\n  var photo = team.data ? team.data.photo : null;\n  var channels = team.data && team.data.channels ? team.data.channels : [];\n\n  if (props.isPinned) {\n    //const { width, height } = useContainerDimensions(componentRef,props.refreshCount)\n    var width = componentRef.current\n      ? componentRef.current.offsetParent.offsetWidth - 2\n      : 0;\n    var height = componentRef.current\n      ? componentRef.current.offsetParent.offsetHeight - 2\n      : 0;\n\n    return (\n      <div\n        ref={componentRef}\n        className=\"pinnedTile\"\n        style={{ position: \"relative\" }}\n        onClick={() => {\n          if (!props.editMode) {\n            window.open(conversationsHref);\n          }\n        }}\n      >\n        <div\n          style={{ position: \"absolute\", right: 4, top: 4, display: \"flex\" }}\n        >\n          <div>\n            {logo(team.hasTeams, \"TeamsLogo\")}\n            {logo(team.hasSharePoint, \"SharepointLogo\")}\n            {logo(team.hasYammer, \"YammerLogo\")}\n          </div>\n        </div>\n        <div\n          style={{\n            position: \"absolute\",\n            right: 10,\n            bottom: 4,\n            display: \"flex\",\n          }}\n        >\n          {\" \"}\n          <div style={{ flexGrow: 1 }}>{team.visibility}</div>\n        </div>\n        <div\n          style={{ display: \"flex\" }}\n          onMouseEnter={() => {\n            setMouseOver(true);\n          }}\n          onMouseLeave={() => {\n            setMouseOver(false);\n          }}\n          style={{\n            width,\n            height,\n            xborder: \"1px dashed red\",\n            xborderRadius: \"20px\",\n          }}\n        >\n          <div style={{ display: \"flex\" }}>\n            <div>\n              {props.editMode && mouseOver && (\n                <div style={{ position: \"absolute\", right: \"0\" }}>\n                  {\" \"}\n                  <span\n                    className=\"ms-Icon ms-Icon--Delete tiledelete\"\n                    onClick={() => {\n                      if (props.onRemovePin) {\n                        props.onRemovePin(props.pinId);\n                      }\n                    }}\n                  ></span>\n                </div>\n              )}\n              {/* {width}x{height} - {props.width}x{props.height} {props.refreshCounter} */}\n              {photo && (\n                <div className=\"\" style={{ minWidth: \"48px\" }}>\n                  <img\n                    className=\"pinnedTile2\"\n                    src={photo}\n                    style={{\n                      height: \"48px\",\n                      width: \"48px\",\n                    }}\n                  ></img>\n                </div>\n              )}\n              {team.tile && team.tile.icon && (\n                <div\n                  className=\"pinnedTile2\"\n                  style={{\n                    backgroundColor: team.tile.color,\n                    minWidth: \"48px\",\n                  }}\n                >\n                  <img\n                    src={team.tile.icon}\n                    style={{\n                      margin: \"12px\",\n                      height: \"24px\",\n                      width: \"24px\",\n                    }}\n                  ></img>\n                </div>\n              )}\n            </div>\n            <div\n              className=\"ms-font-xl \"\n              style={{\n                padding: \"8px\",\n                marginRight: \"20px\",\n                lineHeight: \"32px\",\n                flexGrow: 1,\n              }}\n            >\n              {team.displayName}\n              {team.channel && (\n                <div className=\"channelListing\">\n                  <ul style={{ xdisplay: \"none\", marginTop: \"10px\" }}>\n                    <TeamChannel\n                      team={team}\n                      viewMode\n                      channel={team.channel}\n                      details={true}\n                    />\n                  </ul>{\" \"}\n                </div>\n              )}\n            </div>\n          </div>\n          {mouseOver && (\n            <ListTags\n              indexLaunzhContexts={props.indexLaunzhContexts}\n              href={conversationsHref}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n  if (team.tile) {\n    return (\n      <div\n        onMouseEnter={() => {\n          setMouseOver(true);\n        }}\n        onMouseLeave={() => {\n          setMouseOver(false);\n        }}\n        style={{\n          paddingLeft: \"0px\",\n          margin: \"10px\",\n          fontSize: \"16px\",\n          xdisplay: \"flex\",\n          border: \"1px solid #dddddd\",\n          minWidth: \"290px\",\n          maxWidth: \"290px\",\n        }}\n      >\n        <span\n          onClick={() => {\n            trace(EVENT.TILECLICKED, {\n              \"tile-key\": team.tile.key,\n              href: team.tile.externalArticle,\n            });\n          }}\n        >\n          <a\n            className=\"TeamLink\"\n            href={team.tile.externalArticle}\n            rel=\"noopener noreferrer\"\n            target=\"_blank\"\n          >\n            <div>\n              <div\n                style={{\n                  minWidth: \"288px\",\n                  paddingLeft: \"0px\",\n                  paddingBottom: \"0px\",\n                  position: \"relative\",\n                }}\n              >\n                {mouseOver && (\n                  <div\n                    style={{\n                      position: \"absolute\",\n                      right: \"10px\",\n                      top: \"10px\",\n                      zIndex: \"1\",\n                      backgroundColor: \"#ffffffcc\",\n                    }}\n                  >\n                    <ActionButton\n                      styles={{ fontSize: \"24px\" }}\n                      iconProps={{ iconName: \"Save\" }}\n                      ariaLabel=\"Save\"\n                      onClick={(event) => {\n                        if (props.onSaveTeam) {\n                          event.preventDefault(); // Let's stop this event.\n                          event.stopPropagation(); // Really this time.\n                          props.onSaveTeam(team);\n                        }\n                      }}\n                    >\n                      Save Tile\n                    </ActionButton>\n                  </div>\n                )}\n                {team.tile.icon && (\n                  <div\n                    className=\"teamTitleBar\"\n                    style={{\n                      backgroundColor: team.tile.color,\n                      marginTop: \"-20px\",\n                      minWidth: \"280px\",\n                    }}\n                  >\n                    <img\n                      src={team.tile.icon}\n                      style={{\n                        margin: \"70px\",\n                        height: \"140px\",\n                        width: \"140px\",\n                      }}\n                    ></img>\n                  </div>\n                )}\n              </div>\n              <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\n                <div\n                  className=\"ms-font-xl \"\n                  style={{\n                    padding: \"8px\",\n                    lineHeight: \"32px\",\n                    textAlign: \"center\",\n                  }}\n                >\n                  <Highlight\n                    text={team.tile.title}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n              </div>\n            </div>\n\n            {team.tile.inShort && (\n              <div\n                className=\"ms-font-m\"\n                style={{\n                  fontStyle: \"italic\",\n                  marginTop: \"10px\",\n                  paddingLeft: \"20px\",\n                  paddingRight: \"20px\",\n                  margin: \"0px\",\n                }}\n              >\n                <div style={{ fontStyle: \"italic\", marginTop: \"8px\" }}>\n                  <Highlight\n                    text={team.tile.inShort}\n                    filter={props.filter}\n                    style={props.highlightStyle}\n                  />\n                </div>\n              </div>\n            )}\n          </a>\n        </span>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      onMouseEnter={() => {\n        setMouseOver(true);\n      }}\n      onMouseLeave={() => {\n        setMouseOver(false);\n      }}\n      style={{\n        paddingLeft: \"0px\",\n        margin: \"10px\",\n        fontSize: \"16px\",\n        xdisplay: \"flex\",\n        border: \"1px solid #dddddd\",\n        minWidth: \"290px\",\n        maxWidth: \"290px\",\n      }}\n    >\n      <a\n        className=\"TeamLink\"\n        href={conversationsHref}\n        rel=\"noopener noreferrer\"\n        target=\"_blank\"\n      >\n        <div>\n          <div\n            style={{\n              minWidth: \"290px\",\n              paddingLeft: \"0px\",\n              paddingBottom: \"0px\",\n              position: \"relative\",\n            }}\n          >\n            {mouseOver && (\n              <div\n                style={{\n                  position: \"absolute\",\n                  right: \"10px\",\n                  top: \"10px\",\n                  zIndex: \"1\",\n                  backgroundColor: \"#ffffffcc\",\n                }}\n              >\n                <ActionButton\n                  styles={{ fontSize: \"24px\" }}\n                  iconProps={{ iconName: \"Save\" }}\n                  ariaLabel=\"Save\"\n                  onClick={(event) => {\n                    if (props.onSaveTeam) {\n                      event.preventDefault(); // Let's stop this event.\n                      event.stopPropagation(); // Really this time.\n                      props.onSaveTeam(team);\n                    }\n                  }}\n                >\n                  Save Tile\n                </ActionButton>\n              </div>\n            )}\n            {photo && (\n              <img\n                className=\"teamImage\"\n                src={photo}\n                style={{\n                  height: \"288px\",\n                  width: \"288px\",\n                  marginLeft: \"0px\",\n                }}\n              ></img>\n            )}\n          </div>\n          <div className=\"teamTitleBar\" style={{ minWidth: \"280px\" }}>\n            <div\n              className=\"ms-font-xl \"\n              style={{\n                padding: \"8px\",\n                lineHeight: \"32px\",\n                textAlign: \"center\",\n              }}\n            >\n              <Highlight\n                text={details.displayName}\n                filter={props.filter}\n                style={props.highlightStyle}\n              />\n            </div>\n          </div>\n          <div style={{ border: \"0px solid #dddddd\", paddingBottom: \"4px\" }}>\n            <div\n              style={{\n                display: \"flex\",\n                marginRight: \"10px\",\n                marginLeft: \"10px\",\n                marginTop: \"10px\",\n              }}\n            >\n              <div style={{ flexGrow: 1 }}>{team.visibility}</div>\n              <div>\n                {logo(team.hasTeams, \"TeamsLogo\")}\n                {logo(team.hasSharePoint, \"SharepointLogo\")}\n                {logo(team.hasYammer, \"YammerLogo\")}\n              </div>\n            </div>\n\n            {/* {team.data.endPoints && \n              team.data.endPoints.map((endPoint, key) => {\n             // if (endPoint.providerName===\"Yammer\") debugger\n              return <div key={key}><a target=\"_blank\" href={endPoint.uri}>{endPoint.providerName} ({endPoint.capability})</a></div>;\n              })} */}\n          </div>\n        </div>\n        {details.displayName !== details.description && (\n          <div\n            className=\"ms-font-m\"\n            style={{\n              fontStyle: \"italic\",\n              marginTop: \"10px\",\n              paddingLeft: \"20px\",\n              paddingRight: \"20px\",\n              margin: \"0px\",\n            }}\n          >\n            {details.description}\n          </div>\n        )}\n        {viewChannels && (\n          <div className=\"ms-font-l ms-fontWeight-bold\">\n            {channels.length > 1 && (\n              <div style={{ marginTop: \"10px\", marginLeft: \"20px\" }}>\n                Channels\n              </div>\n            )}\n            <div className=\"channelListing\">\n              <ul style={{ xdisplay: \"none\", marginTop: \"10px\" }}>\n                {channels.map((channel, key) => {\n                  if (channel.displayName === \"$General\") {\n                    return null;\n                  }\n                  return (\n                    <TeamChannel\n                      {...props}\n                      noMessages\n                      key={key}\n                      channel={channel}\n                      details={details}\n                    />\n                  );\n                })}\n              </ul>\n            </div>\n          </div>\n        )}\n        <div>\n          {viewDates && (\n            <div style={{ display: \"xflex\" }}>\n              {team.expirationDateTime && (\n                <div style={{ flexGrow: 1 }}>\n                  Expires in {moment(team.expirationDateTime).fromNow(true)}\n                </div>\n              )}\n              {/* {team.renewedDateTime && (<div style={{ flexGrow: 1 }}>\n                     Renewed {moment(team.renewedDateTime).toNow(true)} a go\n          </div>)} */}\n            </div>\n          )}{\" \"}\n        </div>\n      </a>\n    </div>\n  );\n}\nfunction Messages(props) {\n  if (!props.messages) return null;\n  return (\n    <div style={{ overflow: \"auto\", height: \"200px\" }}>\n      {_.sortBy(props.messages,\"createdDateTime\").map((message, key) => {\n        var show = message.body && message.body.content && message.body.content !== \"\" ? true:false\n        if (!show) return null\n        return (\n          <div key={key}>\n            <a href={message.webUrl} target=\"_blank\" style={{color:\"inherit\",textDecoration:\"none\"}}>\n             \n\n              {message.from && message.from.user && (\n                <div>\n                <div><b>{message.from.user.displayName} ({moment( message.createdDateTime).fromNow()})</b></div>\n              \n                </div>\n              )}\n                <div>\n              {message.body.content}\n              </div>\n            </a>\n          </div>\n        );\n      })}\n    </div>\n  );\n}\nfunction TeamChannel(props) {\n  useEffect(() => {\n    async function load() {\n      if (!props.noMessages &&  props.team && props.channel) {\n        var _messages = await readTeamChannelMessages(\n          props.team.id,\n          props.channel.id\n        ).catch(() => {});\n        setMessages(_messages);\n      }\n    }\n    load();\n  }, [props.team,props.channel]);\n  const [mouseOver, setMouseOver] = useState(false);\n  const [messages, setMessages] = useState(null);\n\n  var channel = props.channel ? props.channel : {};\n\n  var details = props.details ? props.details : {};\n  var team = props.team ? props.team : {};\n\n  return (\n    <li\n      key={props.key}\n      className={`ms-font-m ${props.viewMode ? \"\" : \"teamchannelSelectMode\"} `}\n      onMouseEnter={() => {\n        setMouseOver(true);\n      }}\n      onMouseLeave={() => {\n        setMouseOver(false);\n      }}\n    >\n      <div\n        style={{\n          color: channel.membershipType === \"private\" ? \"red\" : \"#000000\",\n        }}\n      >\n        {mouseOver && !props.viewMode && (\n          <div\n            style={{\n              position: \"relative\",\n            }}\n          >\n            <div\n              style={{\n                position: \"absolute\",\n                right: \"4px\",\n                top: \"4px\",\n                zIndex: \"1\",\n              }}\n            >\n              <IconButton\n                styles={{ fontSize: \"24px\" }}\n                iconProps={{ iconName: \"Save\" }}\n                ariaLabel=\"Save\"\n                onClick={(event) => {\n                  if (props.onSaveChannel) {\n                    event.preventDefault(); // Let's stop this event.\n                    event.stopPropagation(); // Really this time.\n                    props.onSaveChannel(team, channel);\n                  }\n                }}\n              />\n            </div>{\" \"}\n          </div>\n        )}\n        <Highlight\n          text={channel.displayName}\n          filter={props.filter}\n          style={props.highlightStyle}\n        />\n      </div>\n      {channel.description && (\n        <div style={{ fontSize: \"smaller\", fontStyle: \"italic\" }}>\n          <Highlight\n            text={channel.description}\n            filter={props.filter}\n            style={props.highlightStyle}\n          />\n        </div>\n      )}\n      {channel.tabs && (\n        <div className=\"channelTabs\">\n          <ul>\n            <li>\n              {\" \"}\n              <span\n                onClick={() => {\n                  trace(EVENT.TABCLICKED, {\n                    \"team-name\": details.displayName,\n                    \"channel-name\": channel.displayName,\n                    href: channel.filesLink,\n                  });\n                }}\n              >\n                <a href={channel.generalLink} target=\"_blank\">\n                  General\n                </a>\n              </span>\n            </li>\n            <li>\n              <span\n                onClick={() => {\n                  trace(EVENT.TABCLICKED, {\n                    \"team-name\": details.displayName,\n                    \"channel-name\": channel.displayName,\n                    href: channel.filesLink,\n                  });\n                }}\n              >\n                <a href={channel.filesLink} target=\"_blank\">\n                  Files\n                </a>\n              </span>\n            </li>\n            {_.sortBy(channel.tabs, [\"sortOrderIndex\"]).map((tab, ix) => {\n              return (\n                <li key={ix}>\n                  <span\n                    onClick={() => {\n                      trace(EVENT.TABCLICKED, {\n                        \"team-name\": details.displayName,\n                        \"channel-name\": channel.displayName,\n                        \"tab-name\": tab.displayName,\n                        href: channel.filesLink,\n                      });\n                    }}\n                  >\n                    <a\n                      href={\n                        tab.configuration && tab.configuration.websiteUrl\n                          ? tab.configuration.websiteUrl\n                          : tab.webUrl\n                      }\n                      target=\"_blank\"\n                    >\n                      <Highlight\n                        text={decodeURIComponent(tab.displayName)}\n                        filter={props.filter}\n                        style={props.highlightStyle}\n                      />\n                    </a>\n                  </span>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      )}\n      {messages && <Messages messages={messages} />}\n    </li>\n  );\n}\n\nexport function ListTags(props) {\n  //debugger\n  if (!props.indexLaunzhContexts) return null;\n\n  if (!props.indexLaunzhContexts[props.href]) return null;\n  return (\n    <div style={{ margin: \"8px\", position: \"absolute\", bottom: \"0\", right: 0 }}>\n      {props.indexLaunzhContexts[props.href].map((tag, key) => {\n        return (\n          <span\n            onClick={() => {\n              window.location.href = `/board/${tag.name}`;\n            }}\n            className=\"tag\"\n            key={key}\n            style={{ color: tag.color, backgroundColor: tag.backgroundColor }}\n          >\n            #{tag.name}\n          </span>\n        );\n      })}\n    </div>\n  );\n}\n","import React from \"react\";\nimport logo from \"./default/favicon-96x96.png\";\n\nexport default {\n  clientId: \"443ae28d-8cf8-42fd-ba63-f403ac085ead\",\n  directoryId: \"common\",\n  scopes: \"user.readwrite Files.ReadWrite.All\",// group.read.all \",\n  title: \"Tools\",\n  logo, \n  defaultTableAPI: \"https://api.jumpto365.com/table/hexatown.com/PTO365\",\n  niels: \"niels@jumpto365.com\",\n  teamsIntegration: true,\n  options: [],\n  components: {\n    header: (\n      <div style={{ marginTop: \"49px\" }}>\n        <div\n          style={{\n            borderBottom: \"1px solid #cccccc\",\n            position: \"fixed\",\n            backgroundColor: \"#ffffff\",\n            width: \"100vw\",\n            left: 0,\n            top: 0,\n            zIndex: 1\n          }}\n        >\n          <div\n            style={{ display: \"flex\", padding:\"10px\" }}\n          >\n            <div style={{ flexGrow: 1 ,display: \"flex\"}}>\n              <div >\n                <a style={{ color:\"inherit\",textDecoration:\"none\" }}\n                \n                href=\"/\" target=\"_blank\"> <div \n              \n              className=\"ms-font-xxl\"\n              style={{\n                marginLeft: \"16px\",\n\n                lineHeight: \"36px\",\n                padding: \"0px\",\n                color: \"333\",\n              }}>\n              LAUNZH</div>\n                  {/* <img style={{ height: \"48px\", padding: \"4px\" }} src={logo} /> */}\n                </a>\n              </div>\n             \n\n            </div>\n            <div\n              \n              \n            >\n              \n            </div>\n            <div style={{ flexGrow: 1 }}>\n              <div style={{ minWidth: \"150px\" }}>&nbsp;</div>\n            </div>\n          </div>\n        </div>\n      </div>\n    ),\n  },\n};\n","export function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent( s3[1]);\n    }\n  }\n  return search;\n}\n","import React from \"react\";\nimport _ from \"lodash\";\nimport \"./BreakPointSelector.css\"\nexport default function BreakPointSelector(props) {\n  var breakPoints = props && props.breakpoints ? _.keys(props.breakpoints) : [];\n\n  return (\n    <div className=\"breakpoints\" style={{ display: \"flex\" }}>\n      {breakPoints.map((breakPoint, key) => {\n        return <div key={key} className={`breakpoint ${breakPoint===props.selected?\"selected\":\"\"}`} \n        \n        onClick={()=>{\n            \n            if (props.onSelect){\n                props.onSelect(breakPoint)\n            }\n        }}\n        >{breakPoint}</div>;\n      })}\n    </div>\n  );\n}\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\n\nimport { TextField, Dropdown, DropdownBase } from \"@fluentui/react\";\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\n\nimport { initializeIcons } from \"@uifabric/icons\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\nimport React, { useEffect, useState, useRef } from \"react\";\nimport \"react-grid-layout/css/styles.css\";\nimport \"react-resizable/css/styles.css\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport \"./App.css\";\nimport { AppSuperTile } from \"./components/AppSuperTile\";\nimport ToolboxLayout, { breakpoints } from \"./components/ToolboxLayout\";\nimport { ViewErrors } from \"./components/ViewErrors\";\nimport { ViewTeam, ViewTeams } from \"./components/ViewTeams\";\nimport config from \"./config\";\nimport \"./css/normalize.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport \"./css/webflow.css\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport {\n  BOARDSPATH,\n  readCache,\n  readLayouts,\n  saveCache,\n  writeLayouts,\n  readBoardFiles,\n  readIndexOfLaunzhBoards,\n} from \"./helpers/LaunchPad\";\nimport { teamMemberships, getOneDriveFolder } from \"./helpers/OfficeGraph\";\nimport { EVENT, trace } from \"./helpers/trace\";\n\nimport {\n  CommandBar,\n  getTheme,\n  Coachmark,\n  DirectionalHint,\n  mergeStyleSets,\n  FontWeights,\n  ContextualMenu,\n  Toggle,\n  DefaultButton,\n  Modal,\n  IDragOptions,\n  IconButton,\n  IIconProps,\n  Spinner,\n  Label,\n} from \"office-ui-fabric-react\";\n\nimport { navigate } from \"@reach/router\";\nimport BreakPointSelector from \"./components/BreakPointSelector\";\nimport {\n  MessageBarButton,\n  Link,\n  Stack,\n  StackItem,\n  MessageBar,\n  MessageBarType,\n  ChoiceGroup,\n  IStackProps,\n} from \"office-ui-fabric-react\";\n\nconst dragOptions = {\n  moveMenuItemText: \"Move\",\n  closeMenuItemText: \"Close\",\n  menu: ContextualMenu,\n};\nconst cancelIcon = { iconName: \"Cancel\" };\nconst theme = getTheme();\nconst contentStyles = mergeStyleSets({\n  container: {\n    display: \"flex\",\n    flexFlow: \"column nowrap\",\n    alignItems: \"stretch\",\n  },\n  header: [\n    // tslint:disable-next-line:deprecation\n    theme.fonts.xLargePlus,\n    {\n      flex: \"1 1 auto\",\n      borderTop: `4px solid ${theme.palette.themePrimary}`,\n      color: theme.palette.neutralPrimary,\n      display: \"flex\",\n      alignItems: \"center\",\n      fontWeight: FontWeights.semibold,\n      padding: \"12px 12px 14px 24px\",\n    },\n  ],\n  body: {\n    flex: \"4 4 auto\",\n    padding: \"0 24px 24px 24px\",\n    minWidth: \"95vw\",\n    minHeight: \"90vh\",\n    overflowY: \"hidden\",\n    selectors: {\n      p: { margin: \"14px 0\" },\n      \"p:first-child\": { marginTop: 0 },\n      \"p:last-child\": { marginBottom: 0 },\n    },\n  },\n});\nconst toggleStyles = { root: { marginBottom: \"20px\" } };\nconst iconButtonStyles = {\n  root: {\n    color: theme.palette.neutralPrimary,\n    marginLeft: \"auto\",\n    marginTop: \"4px\",\n    marginRight: \"2px\",\n  },\n  rootHovered: {\n    color: theme.palette.neutralDark,\n  },\n};\nvar logSearchTimer;\nvar searchInfo;\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\ninitializeIcons();\n\nexport default function App(props) {\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n  const inFrame = inIframe();\n  const searchIconRef = useRef();\n  const [showTabFeature, setThowTabFeature] = useState(\n    config.teamsIntegration || upnIs(config.niels)\n  );\n  const [titlegraphics, setTitlegraphics] = useState(\"\");\n  const [filter, _setFilter] = useState(\"\");\n  const [search, setSearch] = useState(\"\");\n  const [tiles, setTiles] = useState([]);\n  const [useAuthentication, setUseAuthentication] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isZoomed, setIsZoomed] = useState(false);\n  const [currentTile, setCurrentTile] = useState(null);\n  const [me, setMe] = useState({});\n  const [ztickyFolder, setZtickyFolder] = useState({});\n  var [myTools, setMyTools] = useState([]);\n  const [myTeams, setMyTeams] = useState([]);\n  const [ztickyRef, setZtickyRef] = useState(\"\");\n  const [tileSize, setTileSize] = useState(1);\n  const [errors, setErrors] = useState([]);\n  const [memberships, setMemberships] = useState([]);\n  const [contexts, setContexts] = useState([]);\n  const [selectedBoard, setSelectedBoard] = useState(props.board);\n  const [siteUrlLabel, setSiteUrlLabel] = useState(\"\");\n  const [siteUrlHref, setSiteUrlHref] = useState(\"\");\n  const [refreshing, setRefresing] = useState(false);\n  const [progress, setProgress] = useState(\"\");\n  const [progressPercent, setProgressPercent] = useState(null);\n  const [showTable, setShowTable] = useState(false);\n  const [editingLayout, setEditingLayout] = useState(true);\n  const [showFilterOptions, setShowFilterOptions] = useState(false);\n  const [tableUrl, setTableUrl] = useState(\"\");\n  const [layouts, setLayouts] = useState({\n    lg: [\n      // {\n      //   x: 0,\n      //   y: Infinity,\n      //   w: 3,\n      //   h: 3,\n      //   i: \"1\",\n      //   static: 0, //Math.random() < 0.05,\n      // },\n    ],\n  });\n  const [currentPivot, setCurrentPivot] = useState(\"pinned\");\n  const [refreshCounter, setRefreshCounter] = useState(0);\n  const [tags, setTags] = useState([]);\n  const [showDetails, _setShowDetails] = useState(true);\n  const [showCatalogue, _setShowCatalogue] = useState(!inIframe());\n  const [editMode, _setEditMode] = useState(false); //!inIframe());\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [tableApiSelected, setTableApiSelected] = useState(\n    \"https://api.jumpto365.com/table/jumpto365.com/APAC%20DIGITAL%20WORKPLACE\"\n  );\n  const [selectedGroup, setSelectedGroup] = useState(\"\");\n  const [groups, setGroups] = useState([]);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [selectedBreakPoint, setSelectedBreakPoint] = useState(\"lg\");\n  const [isMounted, setIsMounted] = useState(false);\n  const [isDirty, setIsDirty] = useState(false);\n  const [showWarning, setShowWarning] = useState(true);\n  const [indexLaunzhContexts, setIndexLaunzhContexts] = useState([]);\n  const [myDrive,setMyDrive] = useState(\"\")\n  function setEditMode(on) {\n    if (on) {\n      setIsDirty(false);\n    }\n    _setEditMode(on);\n  }\n  function setShowDetails(on) {\n    _setShowDetails(on);\n    trace(EVENT.DETAILSTOGGLED, { on });\n  }\n  function setShowCatalogue(on) {\n    _setShowCatalogue(on);\n    setIsModalOpen(true);\n    trace(EVENT.SEARCHCLICKED, { on });\n  }\n\n  function setFilter(value) {\n    setSearch(value);\n    if (_.startsWith(value, \".\")) {\n    } else {\n      _setFilter(value);\n    }\n  }\n\n  const _setTags = (t) => {\n    debugger;\n    setTags(t);\n  };\n\n  const removePin = (pinId) => {\n    var keys = _.keys(layouts);\n    keys.forEach((key) => {\n      layouts[key].splice(pinId, 1);\n\n      layouts[key] = layouts[key].map((m, ix) => {\n        m.i = ix.toString();\n        return m;\n      });\n    });\n\n    myTeams.splice(pinId, 1);\n\n    setLayouts(layouts);\n\n    setMyTeams(myTeams);\n    setRefreshCounter(refreshCounter + 1);\n  };\n\n  const getPin = (id, width, height, refresh) => {\n    var team = myTeams[parseInt(id)];\n    return (\n      <ViewTeam\n        indexLaunzhContexts={indexLaunzhContexts}\n        editMode={editMode}\n        refreshCounter={refresh}\n        key={id}\n        width={width}\n        height={height}\n        team={team}\n        pinId={parseInt(id)}\n        isPinned\n        onRemovePin={removePin}\n      />\n    );\n  };\n  const addChannel = (team, channel) => {\n    addPin(team, channel);\n  };\n  const addPin = (team, channel) => {\n    var _team = _.cloneDeep(team);\n\n    _team.channel = channel;\n    var id = myTeams.push(_team);\n    var keys = _.keys(layouts);\n    keys.forEach((key) => {\n      id = layouts[key].length.toString();\n      layouts[key].push({\n        team: team.id,\n        x: 0,\n        y: id * 2,\n        w: 2,\n        h: 2,\n\n        i: id,\n      });\n    });\n\n    setLayouts(layouts);\n    setEditMode(true);\n    setRefreshCounter(refreshCounter + 1);\n    setIsModalOpen(false);\n    setMyTeams(myTeams);\n  };\n  const showSearch = () => {\n    setShowCatalogue(!showCatalogue);\n    setRefreshCounter(refreshCounter + 1);\n  };\n  useEffect(() => {\n    async function load() {\n      if (selectedBoard){\n        window.document.title = \"LAUNZH - \" + selectedBoard\n      }\n      // db.table(\"myTiles\").toArray().then(tiles=>{setMyTiles(tiles)})\n\n      if (showTabFeature) initGraph(false);\n\n      var search = getSearchParametersFromHRef(window.location.href);\n      if (search.ztickyref) {\n        setZtickyRef(search.ztickyref);\n      }\n      var href = search.src ? search.src : config.defaultTableAPI;\n      setIndexLaunzhContexts(await readIndexOfLaunzhBoards().catch(() => {})); // might not be one\n      readBoardFiles()\n        .then((files) => {\n          var ctxs = [];\n          files.forEach((file) => {\n            if (_.endsWith(file.name.toLowerCase(), \".json\")) {\n              var key = file.name.split(\".\")[0];\n              ctxs.push({ key: key, text: key });\n            }\n          });\n          setContexts(ctxs);\n        })\n        .catch((error) => {\n          //errors.push({ context: \"readContexts\", error });\n          //setErrors(errors);\n          //setIsMounted(true);\n        });\n      if (!isLoaded) {\n        setIsLoaded(true);\n        var l = await readLayouts(BOARDSPATH, boardFileName()).catch((e) => {});\n        if (l) {\n          setMyTeams(l.myTeams);\n          setLayouts(l.layouts);\n          setRefreshCounter(refreshCounter + 1);\n        }\n        setIsMounted(true);\n      }\n\n      setTableUrl(config.defaultTableAPI);\n      readGrid(href, config.defaultTableKey);\n\n      if (!myDrive){\n        var  drive = await getOneDriveFolder(BOARDSPATH).catch(()=>{})\n        if (drive){\n       \n          setMyDrive(drive.webUrl)\n      }\n      }\n\n    }\n\n    load();\n  }, [refreshCounter]);\n\n  function readGrid(href, tableId) {\n    axios.get(href).then(({ data }) => {\n      setTitlegraphics(data.titlegraphics);\n      var tiles = [];\n      if (data.grid) {\n        var groups = {};\n        var groupRefs = {};\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.groupSetting) {\n              groups[cell.groupSetting.title] = {\n                groupSetting: cell.groupSetting,\n                members: cell.members,\n              };\n              if (cell.members) {\n                cell.members.forEach((id) => {\n                  var refs = groupRefs[id] ? groupRefs[id] : [];\n                  refs.push(cell.groupSetting);\n                  groupRefs[id] = refs;\n                });\n              }\n            }\n          });\n        });\n\n        var g = _.keys(groups);\n        var ga = g.map((name) => {\n          return { title: name, ...groups[name] };\n        });\n\n        setGroups(_.sortBy(ga, [\"title\"]));\n\n        data.grid.forEach((row) => {\n          return row.forEach((cell) => {\n            if (cell.tile && cell.tile.title) {\n              var tile = { ...cell.tile };\n              tile.sortKey = _.toLower(cell.tile.title);\n              tile.tableId = tableId;\n              tile.correlation =\n                href +\n                \"#\" +\n                (tile.key\n                  ? tile.key\n                  : tile.title\n                  ? tile.title.toLowerCase()\n                  : tile.id);\n              var references = groupRefs[cell.id];\n              tile.references = references;\n              tiles.push(tile);\n            }\n          });\n        });\n      }\n\n      setTiles(_.sortBy(tiles, [\"sortKey\"]));\n    });\n  }\n\n  async function initGraph(refresh) {\n    try {\n      if (refresh) {\n      }\n      var queueCount = 0;\n\n      // await OfficeGraph.initStorage();\n\n      var localCache = localStorage.getItem(\"memberships\");\n      var cachedMemberships;\n      try {\n        if (localCache && !refresh) {\n          cachedMemberships = JSON.parse(localCache);\n          setMemberships(cachedMemberships);\n\n          return;\n        }\n      } catch (error) {}\n\n      setRefresing(true);\n      cachedMemberships = await readCache().catch((error) => {\n        errors.push({ context: \"readCache\", error });\n        setErrors(errors);\n      });\n\n      if (cachedMemberships && !refresh) {\n        setMemberships(cachedMemberships);\n        localStorage.setItem(\"memberships\", JSON.stringify(cachedMemberships));\n        setRefresing(false);\n      } else {\n        queueCount++;\n        setProgress(\"Loading\");\n        teamMemberships((percent) => {\n          setProgressPercent(percent);\n        })\n          .then(async (memberships) => {\n            await saveCache(memberships).catch((error) => {\n              errors.push({ context: \"saveCache\", error });\n              setErrors(errors);\n            });\n            localStorage.setItem(\"memberships\", JSON.stringify(memberships));\n            queueCount--;\n            if (queueCount === 0) setRefresing(false);\n            trace(EVENT.MEMBERSHIPSREAD, {\n              \"count-memberships\": memberships.length,\n            });\n            setMemberships(memberships);\n\n            setProgress(\"\");\n          })\n          .catch((error) => {\n            debugger;\n            queueCount--;\n            if (queueCount <= 0) setRefresing(false);\n            errors.push({ context: \"OfficeGraph.teamMemberships()\", error });\n            setErrors(errors);\n            setProgress(\"\");\n          });\n      }\n      return;\n      // OfficeGraph.initTileStorage()\n      //   .then(async (ztickyFolder) => {\n      //     setZtickyFolder(ztickyFolder);\n      //     queueCount++;\n\n      //     var [layouts, properties, version] = await OfficeGraph.readLayouts(\n      //       ztickyFolder\n      //     );\n      //     //debugger\n      //     var myTools = [];\n      //     if (version < 0) {\n      //       var tileFolders = await OfficeGraph.getMyTools(\n      //         ztickyFolder,\n      //         refresh\n      //       );\n      //       myTools = tileFolders.map((folder) => {\n      //         return {\n      //           title: folder.tile ? folder.tile.title : folder.name,\n      //           tile: folder.tile,\n      //         };\n      //       });\n      //     } else {\n      //       myTools = properties.tiles.map((tile) => {\n      //         if (!tile) return null;\n\n      //         return { title: tile.title, tile };\n      //       });\n      //     }\n\n      //     queueCount--;\n      //     if (queueCount === 0) setRefresing(false);\n      //     setMyTools(myTools);\n      //     setLayouts(layouts);\n      //   })\n      //   .catch((error) => {\n      //     queueCount--;\n      //     if (queueCount <= 0) setRefresing(false);\n      //     errors.push({ context: \"OfficeGraph.initStorage()\", error });\n      //     setErrors(errors);\n      //   });\n    } catch (error) {\n      errors.push({ context: \"initGraph\", error });\n      setErrors(errors);\n    }\n  }\n\n  function matchFilter(tile) {\n    if (!filter) return true;\n    var match =\n      tile &&\n      tile.title &&\n      tile.title.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.inShort &&\n        tile.inShort.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        tile &&\n        tile.subTitle &&\n        tile.subTitle.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n\n    return match;\n  }\n\n  function matchTeam(team) {\n    var include = true;\n    if (tags.length > 0) {\n      include = false;\n      tags.forEach((tag) => {\n        switch (tag.id) {\n          case \"sharepoint\":\n            if (team.hasSharePoint) {\n              include = true;\n            }\n            break;\n          case \"teams\":\n            if (team.hasTeams) {\n              include = true;\n            }\n\n            break;\n          case \"yammer\":\n            if (team.hasYammer) {\n              include = true;\n            }\n            break;\n          case \"private\":\n            if (team.visibility === \"Private\") {\n              include = true;\n            }\n            break;\n          case \"public\":\n            if (team.visibility === \"Public\") {\n              include = true;\n            }\n            break;\n          default:\n            break;\n        }\n      });\n    }\n    if (!include) return false;\n    if (!filter) return true;\n    var details = team.data && team.data.details ? team.data.details : {};\n    var channels = team.data && team.data.channels ? team.data.channels : [];\n    var match =\n      details.displayName &&\n      details.displayName.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    if (!match)\n      match =\n        details.description &&\n        details.description.toLowerCase().indexOf(filter.toLowerCase()) !== -1;\n    channels.forEach((channel) => {\n      if (!match) {\n        match =\n          channel.displayName &&\n          channel.displayName.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n      if (!match) {\n        match =\n          channel.description &&\n          channel.description.toLowerCase().indexOf(filter.toLowerCase()) !==\n            -1;\n      }\n    });\n\n    return match;\n  }\n  function persistLayouts(newLayouts) {\n    if (!isMounted) {\n      console.log(\"not mounted, persistLayouts dropped\");\n      return;\n    }\n    setLayouts(newLayouts);\n    setIsDirty(true);\n  }\n  async function saveLayout() {\n    if (!isMounted) {\n      console.log(\"not mounted, persistLayouts dropped\");\n      return;\n    }\n\n    console.log(\"persistLayouts\");\n\n    await writeLayouts(BOARDSPATH, boardFileName(), {\n      layouts,\n      myTeams,\n    }).catch((error) => {\n      errors.push({ context: \"  writeLayouts\", error });\n      setErrors(errors);\n    });\n\n    setIsDirty(false);\n  }\n\n  var filteredTiles = !filter && tags.length === 0 ? tiles : [];\n  var filteredMyTools = !filter && tags.length === 0 ? myTools : [];\n  var filteredMemberShips = !filter && tags.length === 0 ? memberships : [];\n  var filteredSiteLinks = !filter && tags.length === 0 ? [] : [];\n  var siteUrl = ztickyRef ? new URL(ztickyRef) : null;\n  if (filter || tags.length > 0) {\n    tiles.forEach((tile) => {\n      if (matchFilter(tile)) {\n        filteredTiles.push(tile);\n      }\n    });\n    myTools.forEach((folder) => {\n      if (matchFilter(folder.tile)) {\n        filteredMyTools.push(folder);\n      }\n    });\n\n    memberships.forEach((team) => {\n      if (matchTeam(team)) {\n        filteredMemberShips.push(team);\n      }\n    });\n\n    // if (\n    //   searchInfo &&\n    //   searchInfo[\"search-for\"] &&\n    //   searchInfo[\"search-for\"] === filter\n    // )\n    //   return;\n\n    // searchInfo = {\n    //   \"search-for\": filter,\n    //   \"found-memberships\": filteredMemberShips.length,\n    //   \"found-tiles\": filteredMyTools.length,\n    // };\n\n    if (logSearchTimer) {\n      console.log(\"Postponing search trace\");\n      clearTimeout(logSearchTimer);\n    }\n    console.log(\"Timeing search trace\");\n    logSearchTimer = setTimeout(() => {\n      console.log(\"sending search trace\");\n      trace(EVENT.SEARCHING, searchInfo);\n      logSearchTimer = null;\n    }, 1000);\n  }\n\n  const dropdownStyles = {\n    dropdown: { flexGrow: 1,border:\"1px\" },\n  };\n\n  if (!props || (!props.auth && props.auth.user)) {\n    return (\n      <div>\n        <h1>Sorry - You cannot get in here</h1>\n        {JSON.stringify(\n          props && props.auth && props.auth.error ? props.auth.error : \"\"\n        )}\n      </div>\n    );\n  }\n  var editorCanvasWidth = editMode ? breakpoints[selectedBreakPoint] : null;\n  const buttonProps = {\n    text: \"Try it\",\n  };\n\n  const buttonProps2 = {\n    text: \"Try it again\",\n  };\n\n  return (\n    <div>\n      {!inFrame && config.components.header}\n      {/* <CommandBar\n        // items={_items}\n        // overflowItems={_overflowItems}\n        // overflowButtonProps={overflowProps}\n        farItems={[\n          // {\n          //   key: \"tile\",\n          //   text: \"Grid view\",\n          //   // This needs an ariaLabel since it's icon-only\n          //   ariaLabel: \"Filter view\",\n          //   iconOnly: true,\n          //   iconProps: { iconName: \"Filter\" },\n          //   onClick: () => {\n          //     if (showFilterOptions) {\n          //       setFilter(\"\");\n          //     }\n          //     setShowFilterOptions(!showFilterOptions);\n          //   }\n          // }\n        ]}\n        ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n      /> */}\n      <div>\n        {\" \"}\n        {errors.length !== 0 && (\n          <div>\n            <ViewErrors errors={errors} />\n          </div>\n        )}\n        {progress && (\n          <div\n            style={{\n              backgroundColor: \"white\",\n              width: \"100vw\",\n              position: \"fixed\",\n              top: \"0px\",\n              zIndex: 2,\n            }}\n          >\n            <ProgressIndicator\n              percentComplete={progressPercent}\n              xlabel=\"Example title\"\n              xdescription={progress}\n            />\n          </div>\n        )}\n        <img\n          style={{\n            display: \"none\",\n            height: \"64px\",\n            margin: \"13px\",\n            position: \"fixed\",\n            bottom: \"0px\",\n            right: \"0px\",\n          }}\n          src={titlegraphics}\n        ></img>\n        {!isZoomed && (\n          <div style={{ display: \"flex\" }}>\n            {\" \"}\n            <div\n              style={{\n                display: \"xnone\",\n                paddingRight: \"8px\",\n                position: \"fixed\",\n                bottom: \"0px\",\n                backgroundColor: \"white\",\n              }}\n            >\n              {showTabFeature && (\n                <div>\n                  <i\n                    style={{ cursor: \"pointer\", padding: \"4px\" }}\n                    className=\"ms-Icon ms-Icon--Refresh\"\n                    onClick={() => {\n                      initGraph(true);\n                    }}\n                    aria-hidden=\"true\"\n                  ></i>{\" \"}\n                  {refreshing && <>Loading</>}\n                </div>\n              )}\n            </div>\n            {!inFrame && (\n              <div\n                style={{\n                  position: \"fixed\",\n                  right: 0,\n                  top: 0,\n                  zIndex: 32,\n                  marginRight: \"16px\",\n                  width: \"calc(100vw - 200px)\"\n                }}\n              >\n                <div style={{ display: \"flex\" }}>\n                  {editMode && (\n                    <>\n                      <div style={{ marginTop: \"16px\", marginRight: \"8px\" }}>\n                        Screen width&nbsp;\n                      </div>\n                      <div>\n                        <BreakPointSelector\n                          selected={selectedBreakPoint}\n                          breakpoints={breakpoints}\n                          onSelect={(breakPoint) => {\n                            setSelectedBreakPoint(breakPoint);\n                          }}\n                        />\n                      </div>\n                    </>\n                  )}\n                  <div\n                    style={{\n                      marginLeft: \"16px\",\n                      marginTop: \"12px\",\n                      flexGrow: 1,\n                    }}\n                  >\n                    <Dropdown\n                      disabled={showTable}\n                      placeholder=\"Select board\"\n                      selectedKey={selectedBoard}\n                      \n                      xlabel=\"View as\"\n                      onChanged={(option, index) => {\n                        setSelectedBoard(option.key);\n                        window.location.href = `/board/${option.key}`;\n\n                        //debugger\n                      }}\n                      options={contexts.map((ctx) => {\n                        return { key: ctx.key, text: ctx.text };\n                      })}\n                      styles={dropdownStyles}\n                    />\n                  </div>\n                  {editMode && (\n                    <>\n                      <div style={{ marginTop: \"8px\" }}>\n                        <IconButton\n                          styles={{ fontSize: \"24px\" }}\n                          disabled={!isDirty}\n                          iconProps={{ iconName: \"Save\" }}\n                          ariaLabel=\"Save\"\n                          onClick={() => saveLayout()}\n                        />\n                      </div>\n                    </>\n                  )}\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>Edit</div>\n\n                  <div style={{ marginTop: \"16px\" }}>\n                    <Toggle\n                      checked={editMode}\n                      onChange={(e, checked) => {\n                        setEditMode(checked);\n                        setRefreshCounter(refreshCounter + 1);\n                      }}\n                    />\n                  </div>\n                  <div style={{ marginTop: \"4px\" }}>\n                    <CommandBar\n                      farItems={[\n                        // {\n                        //   key: \"tile\",\n                        //   text: \"Grid view\",\n                        //   // This needs an ariaLabel since it's icon-only\n                        //   ariaLabel: \"Grid view\",\n                        //   iconOnly: true,\n                        //   iconProps: { iconName: \"Tiles\" },\n                        //   onClick: () => console.log(\"Tiles\"),\n                        // },\n                        {\n                          key: \"info\",\n                          text: \"Info\",\n                          // This needs an ariaLabel since it's icon-only\n                          ariaLabel: \"Info\",\n                          iconOnly: true,\n                          iconProps: { iconName: \"CollapseMenu\" },\n                          onClick: () => console.log(\"Info\"),\n                          subMenuProps: {\n                            items: [\n                              {\n                                key: \"allBoards\",\n                                text: \"Boards\",\n                                iconProps: { iconName: \"AllApps\" },\n                                onClick: () => {\n                                  navigate(\"/boards\");\n                                }, // optional\n                              },\n                              {\n                                key: \"check\",\n                                text: \"Check\",\n                                iconProps: { iconName: \"ReceiptCheck\" },\n                                onClick: () => {\n                                  navigate(\"/check\");\n                                }, // optional\n                              },\n                              {\n                                key: \"onedrive\",\n                                text: \"OneDrive files\",\n                                disabled: !myDrive,\n                                iconProps: { iconName: \"OneDriveLogo\" },\n                                onClick: () => {\n                                  window.open(myDrive);\n                                }, // optional\n                              },\n\n\n                              \n\n\n                            ],\n                          },\n                        },\n                      ]}\n                      ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n                    />\n                  </div>\n\n                  {/* <div style={{ marginTop: \"16px\" }}>\n                    <Toggle\n                      checked={showCatalogue}\n                      onChange={(e, checked) => {\n                        setShowCatalogue(checked);\n                        setRefreshCounter(refreshCounter + 1);\n                      }}\n                    />\n                  </div> */}\n                </div>\n              </div>\n            )}\n            <div style={{ flexGrow: \"1\" }}>\n              <div\n                style={{\n                  display: \"flex\",\n                  flexWrap: \"wrap\",\n                  marginTop: \"8px\",\n                }}\n              >\n                <div style={{ padding: \"0px\", marginLeft: \"8px\", flexGrow: 1 }}>\n                  {/* <TextField\n                    autoFocus={true}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  /> */}\n\n                  {/* */}\n                </div>{\" \"}\n              </div>\n              <div\n                style={{\n                  position: \"fixed\",\n                  right: 0,\n                  bottom: 0,\n                  zIndex: 32,\n                }}\n              >\n                <div style={{ display: \"flex\" }}>\n                  <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                    <i\n                      ref={searchIconRef}\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\n                      className=\"ms-Icon ms-Icon--Add tilesearch\"\n                      onClick={() => {\n                        showSearch();\n                      }}\n                      aria-hidden=\"true\"\n                    ></i>\n                  </div>\n                </div>\n              </div>\n              <div style={editMode ? { backgroundColor: \"#666666\" } : {}}>\n                <div\n                  style={\n                    editMode\n                      ? {\n                          marginRight: \"auto\",\n                          marginLeft: \"auto\",\n                          width: editorCanvasWidth,\n                          minHeight: \"100vh\",\n                          backgroundColor: \"#ffffff\",\n                        }\n                      : {}\n                  }\n                >\n                  {!isMounted && (\n                    <div style={{ height: \"90vh\", marginTop: \"40vh\" }}>\n                      <Spinner label=\"Assembling your board ...\" />\n                    </div>\n                  )}\n                  {isMounted && myTeams.length === 0 && showWarning && (\n                    <MessageBar\n                      messageBarType={MessageBarType.warning}\n                      isMultiline={false}\n                      onDismiss={() => {\n                        setShowWarning(false);\n                      }}\n                      dismissButtonAriaLabel=\"Close\"\n                      actions={\n                        <div>\n                          <MessageBarButton\n                            onClick={() => {\n                              setEditMode(true);\n                              setShowWarning(false);\n                              showSearch();\n                            }}\n                          >\n                            {\" \"}\n                            Add Launzh Tiles\n                          </MessageBarButton>\n                        </div>\n                      }\n                    >\n                      Hi, nothing on this board\n                    </MessageBar>\n                  )}\n\n                  <Coachmark\n                    target={searchIconRef}\n                    positioningContainerProps={{\n                      directionalHint: DirectionalHint.topAutoEdge,\n                      doNotLayer: false,\n                    }}\n                    ariaAlertText=\"A Coachmark has appeared\"\n                    ariaDescribedBy={\"coachmark-desc1\"}\n                    ariaLabelledBy={\"coachmark-label1\"}\n                    ariaDescribedByText={\n                      \"Press enter or alt + C to open the Coachmark notification\"\n                    }\n                    ariaLabelledByText={\"Coachmark notification\"}\n                  >\n                    Welcome to the land of Coachmarks!\n                  </Coachmark>\n                  <ToolboxLayout\n                    indexLaunzhContexts={indexLaunzhContexts}\n                    tools={myTools}\n                    layouts={layouts}\n                    persist={persistLayouts}\n                    editMode={editMode}\n                    getPin={getPin}\n                    onRemovePin={removePin}\n                    fixedWidth={editorCanvasWidth}\n                    onTileClick={(tile) => {\n                      setCurrentTile(tile);\n                      setIsZoomed(true);\n                    }}\n                  />\n                </div>\n              </div>\n\n              {/* {siteUrl && (\n                 \n                    <h3>Which tools do you find good for this site?</h3>\n                    <div>{siteUrl.hostname}</div>\n                    <TextField\n                      label=\"Label\"\n                      placeholder=\"Enter label for this link\"\n                      value={siteUrlLabel}\n                      onChange={(e, value) => {\n                        setSiteUrlLabel(value);\n                      }}\n                    ></TextField>\n                    <TextField\n                      label=\"URL\"\n                      placeholder=\"Enter URL\"\n                      value={siteUrlHref}\n                      onChange={(e, value) => {\n                        setSiteUrlHref(value);\n                      }}\n                    ></TextField>\n                    <PrimaryButton\n                      text=\"Share link\"\n                      disabled={!siteUrlHref && !siteUrlLabel ? true : false}\n                    />\n                  </PivotItem>\n                )} */}\n              {/* <PivotItem\n                  key=\"catalogue\"\n                  headerText=\"Catalogue\"\n                  itemCount={filteredTiles.length}\n                > */}\n              {showTable && (\n                <>\n                  <div style={{ textAlign: \"right\" }}>\n                    <i\n                      style={{ cursor: \"pointer\", padding: \"4px\" }}\n                      class=\"ms-Icon ms-Icon--OpenInNewWindow\"\n                      onClick={() => {\n                        window.open(tableUrl, \"_blank\");\n                      }}\n                      aria-hidden=\"true\"\n                    ></i>\n                  </div>\n                  <iframe\n                    style={{\n                      border: \"0\",\n                      height: \"calc(100vh - 150px\",\n                      width: \"95vw\",\n                    }}\n                    src={tableUrl}\n                  ></iframe>\n                </>\n              )}\n              {/* {showCatalogue && showTabFeature && memberships.length > 0 && ( */}\n              <Modal\n                titleAriaId={1}\n                isOpen={isModalOpen}\n                onDismiss={() => setIsModalOpen(false)}\n                isBlocking={false}\n                containerClassName={contentStyles.container}\n                xdragOptions={dragOptions}\n              >\n                <div style={{ display: \"flex\" }}>\n                  <div style={{ flexGrow: 1 }}></div>\n                  <div>\n                    <IconButton\n                      styles={iconButtonStyles}\n                      iconProps={cancelIcon}\n                      ariaLabel=\"Close popup modal\"\n                      onClick={() => setIsModalOpen(false)}\n                    />\n                  </div>\n                </div>\n                <div className={contentStyles.body}>\n                  <TextField\n                    autoFocus={false}\n                    disabled={showTable}\n                    xlabel=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Start typing any characters to filter. If you turn on 'Show details' you get a highlight match \"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                  <div style={{ display: \"flex\" }}>\n                    <div style={{ padding: \"16px\", marginTop: \"0px\" }}>\n                      Show details\n                    </div>\n                    <div style={{ marginTop: \"16px\" }}>\n                      <Toggle\n                        checked={showDetails}\n                        onChange={(e, checked) => {\n                          setShowDetails(checked);\n                          setRefreshCounter(refreshCounter + 1);\n                        }}\n                      />\n                    </div>\n                    <div>\n                      {/* <ReactTags\n                    placeholder=\"Filter by tag, like Yammer, Teams ...\"\n                    autofocus={false}\n                    tags={tags}\n                    suggestions={[\n                      {\n                        name: \"Teams\",\n                        id: \"teams\",\n                      },\n                      {\n                        name: \"SharePoint\",\n                        id: \"sharepoint\",\n                      },\n                      {\n                        name: \"Yammer\",\n                        id: \"yammer\",\n                      },\n                      {\n                        name: \"Private\",\n                        id: \"private\",\n                      },\n                      {\n                        name: \"Public\",\n                        id: \"public\",\n                      },\n                    ]}\n                    handleDelete={(i) => {\n                      const tgs = tags.slice(0);\n                      tgs.splice(i, 1);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                    handleAddition={(tag) => {\n                      var tgs = [].concat(tags, tag);\n                      setTags(tgs);\n                      setRefreshCounter(refreshCounter + 1);\n                    }}\n                  />  */}\n                    </div>\n                  </div>\n\n                  <ViewTeams\n                    onSaveTeam={addPin}\n                    onSaveChannel={addChannel}\n                    refreshCounter={refreshCounter}\n                    tiles={filteredTiles}\n                    details={showDetails}\n                    memberShips={filteredMemberShips}\n                    filter={filter}\n                    highlightStyle={{ backgroundColor: \"yellow\" }}\n                  />\n                </div>\n              </Modal>\n              {/* )} */}\n              {!showTable && !showTabFeature && (\n                <div style={{ display: \"flex\", flexWrap: \"wrap\" }}>\n                  {filteredTiles.length === 0 && (\n                    <div>\n                      <h2>Sorry. No matches for \"{filter}\"</h2>\n                      {/* <h1>\n                        <a href=\"https://christianiabpos.sharepoint.com/sites/intranets-tools#missing-a-link\">\n                          Request a link\n                        </a>\n                      </h1> */}\n                    </div>\n                  )}\n                  {filteredTiles.map((tile, key) => {\n                    if (selectedGroup) {\n                      var match = false;\n\n                      if (!tile.references) return null;\n                      tile.references.forEach((r) => {\n                        if (r.title === selectedGroup) {\n                          match = true;\n                        }\n                      });\n                      if (!match) return null;\n                    }\n                    return (\n                      <AppSuperTile\n                        tileSize={tileSize}\n                        key={key}\n                        filter={filter}\n                        highlightStyle={{\n                          backgroundColor: \"yellow\",\n                          color: \"#333\",\n                        }}\n                        tile={tile}\n                        onPinnedClicked={(props) => {\n                          if (props.tile) {\n                            addPin(props.tile);\n                          }\n                        }}\n                        onClick={(tile) => {\n                          if (window.amplitude) {\n                            if (\n                              props &&\n                              props.auth &&\n                              props.auth.user &&\n                              props.auth.user.userPrincipalName\n                            )\n                              window.amplitude\n                                .getInstance()\n                                .identify(props.auth.user.userPrincipalName);\n                            window.amplitude\n                              .getInstance()\n                              .logEvent(\"tool\", tile);\n                          }\n                          if (tile.jumpto && !tile.messageBeforeLaunch) {\n                            return window.open(tile.jumpto, \"_blank\");\n                          }\n                          setCurrentTile(tile);\n                          setIsZoomed(true);\n                        }}\n                      />\n                    );\n                  })}\n                </div>\n              )}\n\n              {/* \n\n              */}\n            </div>\n            {showFilterOptions && (\n              <div\n                style={{\n                  borderLeft: \"1px solid #dddddd\",\n                  borderTop: \"1px solid #dddddd\",\n                  padding: \"8px\",\n                  float: \"right\",\n                  minWidth: \"300px\",\n                }}\n              >\n                <div style={{ padding: \"0px\" }}>\n                  <TextField\n                    label=\"Filter\"\n                    value={search}\n                    onChange={(e, newValue) => {\n                      setFilter(newValue);\n                    }}\n                    placeholder=\"Filter the list of tools\"\n                    iconProps={{ iconName: \"Filter\" }}\n                  />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      {false && props && props.auth && props.auth.user && (\n        <div style={{ textAlign: \"center\" }}>\n          You are signed in as \"{props.auth.user.displayName}\" with upn{\" \"}\n          {props.auth.user.userPrincipalName}\". Visit your Office profile at\n          &nbsp;\n          <a href=\"https://portal.office.com/account/#apps\" target=\"_blank\">\n            https://portal.office.com/account/#apps\n          </a>\n        </div>\n      )}\n    </div>\n  );\n\n  function boardFileName() {\n    var name = props.board ? props.board : \"default\";\n    return `${name}.json`;\n  }\n}\nfunction newFunction() {\n  return (\n    <div>\n      <div></div>\n      <div></div>\n    </div>\n  );\n}\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\nimport React, { Component, useState, useEffect } from \"react\";\nimport { getSearchParametersFromHRef } from \"./helpers\";\nimport \"./App.css\";\nimport \"./css/normalize.css\";\nimport \"./css/webflow.css\";\nimport \"./css/swimlane-process-map.webflow.css\";\nimport axios from \"axios\";\nimport _ from \"lodash\";\n\n\n\nimport { ProgressIndicator } from \"@fluentui/react/lib/ProgressIndicator\";\nimport { Toggle } from \"@fluentui/react/lib/Toggle\";\n\nimport config from \"./config\";\nimport ReactTags from \"react-tag-autocomplete\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\nimport { running } from \"animejs\";\n\nimport {verifyAccessForLanuchPad} from \"./helpers/LaunchPad\"\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nexport default function Onboard(props) {\n  const [checkMe, setCheckMe] = useState(\"pending\");\n  const [checkMemberships, setCheckMemberships] = useState(\"pending\");\n  const [checkTeam, setCheckTeam] = useState(\"pending\");\n  const [checkMyExtention, setCheckMyExtention] = useState(\"pending\");\n  const [checkOneDrive, setCheckOneDrive] = useState(\"pending\");\n  const [checkOneDriveFiles, setCheckOneDriveFiles] = useState(\"pending\");\n  \n\n  const upnIs = (upn) => {\n    try {\n      return props.auth.user.userPrincipalName === upn;\n    } catch (error) {\n      return false;\n    }\n  };\n\n  const inFrame = inIframe();\n\n  useEffect(() => {\n    async function run() {\n      await verifyAccessForLanuchPad(setCheckMe, setCheckMyExtention, setCheckOneDrive, setCheckOneDriveFiles, setCheckMemberships, setCheckTeam);\n    }\n    run();\n  }, []);\n\n  return (\n    <div>\n      <div className=\"OnboardingContainer\" dir=\"ltr\">\n        {!inFrame && config.components.header}\n        \n        {/* <div className=\"ms-fontSize-32\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\n          Checking is everything have been setup for you\n        </div> */}\n       \n        {/* <div>\n          <div className=\"ms-fontSize-20\" style={{lineHeight:\"24px\",textAlign:\"center\"}}>\n          <p >jumpto365 are committed to leave your data within your own system, what is yours stay with you. \n          We do not copy any of your information what so ever, period!</p>\n\n           <p>But to make our app work for you, we need your organisation to trust us with the following areas</p>\n\n          \n          </div>\n          <p className=\"ms-fontSize-20\">Allow access to the following areas</p>\n          <ul>\n            <li>\n              <p className=\"ms-fontWeight-bold\">Read and write access to your profile and OneDrive (User.ReadWrite.All)</p>\n              <p>\n                We need this permission to be able to store your preferences as\n                well as your cached data on your profile, and access to store data into your OneDrive.\n              </p>\n              <p>\n                That in order to be able to give you the best performance and to\n                comply with good data pricavy.\n              </p>\n            </li>\n            <li>\n              <p className=\"ms-fontWeight-bold\">Read access to your Groups (Group.Read.All)</p>\n              <p>\n                We need this permission to be able to read details about your\n                group membership and the name, description and tab on your channels in Teams \n              </p>\n            </li>\n          </ul>\n        </div> */}\n        <div>\n          <p className=\"ms-fontSize-20\">Verifying access</p>\n          <ul>\n            <li>Checking access to your profile: ({checkMe})</li>\n            <li>Checking access to your extension: ({checkMyExtention})</li>\n            <li>Checking access to your memberships: ({checkMemberships})</li>\n            <li>Checking access to your teams: ({checkTeam})</li>\n            <li>\n              Checking access to your OneDriver folders: ({checkOneDrive})\n            </li>\n            <li>\n              Checking access to the OneDrive files which we maintain: ({checkOneDriveFiles})\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n  );\n}","/****\n * \n * \n *  version \n *  1.0 \n * \n * \n * \n */\nimport Axios from \"axios\";\nimport moment from \"moment\";\nexport function getSearchParametersFromHRef(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"?\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nexport function getSearchParametersFromHash(href) {\n  if (!href) return {};\n  var search = {};\n  var s1 = href.split(\"#\");\n  if (s1.length > 1) {\n    var s2 = s1[1].split(\"&\");\n    for (let index = 0; index < s2.length; index++) {\n      const s3 = s2[index].split(\"=\");\n      search[s3[0]] = decodeURIComponent(s3[1]);\n    }\n  }\n  return search;\n}\n\nconst GETACCESSTOKEN = \"getAccessToken\";\nconst RESTOREURL = \"restoreUrl\";\nconst GETGRAPHUSER = \"getGraphUser\";\nconst LOGIN = \"login\";\nconst ACCESSTOKEN = \"access_token\";\nconst ACCESSEXPIRES = \"access_expires\";\n\nfunction isAccessTokenExpired() {\n  try {\n    var exp = sessionStorage.getItem(ACCESSEXPIRES);\n    var expiresIn = moment(exp);\n    var now = moment();\n    var x = now.diff(expiresIn);\n    return x > 0 ? true : false;\n  } catch (error) {\n    return true;\n  }\n}\n\n/**\n * Based on session storage - if no auth token is present, or if is to old, a auth sequence is initiated\n * @param {*} config \n * @param {*} callBackNotifyIfInteractionIsRequired \n */\nexport function authenticate(config, callBackNotifyIfInteractionIsRequired,options) {\n  // https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-implicit-grant-flow\n\n  return new Promise((resolve, reject) => {\n    var redirect_uri =\n      (window.location.hostname === \"localhost\"\n        ? window.location.protocol\n        : \"https:\") +\n      \"//\" +\n      window.location.hostname +\n      (window.location.port !== 80 &&\n      window.location.port !== 443 &&\n      window.location.port !== \"\"\n        ? \":\" + window.location.port\n        : \"\") +\n      \"/\";\n    // window.location.pathname;\n\n    var host = `https://login.microsoftonline.com/${config.directoryId}/oauth2/v2.0/authorize`;\n    var client_id = config.clientId;\n    var response_type = \"id_token\";\n    var response_mode = \"fragment\";\n    var scope = config.scopes;\n\n    var seq = \"\"; // sessionStorage.getItem(\"authseq\");\n    var search = getSearchParametersFromHash(window.location.href);\n\n    var search2 = getSearchParametersFromHRef(window.location.href);\n    //debugger\n\n    if (search.id_token) {\n      seq = GETACCESSTOKEN;\n    } else if (search.access_token) {\n      seq = RESTOREURL;\n    } else if (search.login) {\n      seq = LOGIN;\n    } else if (seq === \"\") {\n      if (sessionStorage.getItem(ACCESSTOKEN)) {\n        seq = isAccessTokenExpired() ? GETACCESSTOKEN : GETGRAPHUSER;\n      } else {\n        seq = GETACCESSTOKEN;\n      }\n    }\n\n    if (search.error || search2.error) {\n      var e = search.error ? search.error : search2.error;\n      \n      var handled = false;\n      switch (e) {\n        case \"interaction_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired();\n          }\n          sessionStorage.removeItem(\"accesstoken\");\n          sessionStorage.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&response_type=${response_type}&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n         // window.location.href = url;\n          return;\n          break;\n        case \"consent_required\":\n          if (callBackNotifyIfInteractionIsRequired) {\n            callBackNotifyIfInteractionIsRequired();\n          }\n          //debugger;\n          sessionStorage.removeItem(\"accesstoken\");\n          sessionStorage.removeItem(\"idtoken\");\n\n          var url = `${host}?client_id=${client_id}&prompt=consent&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n          window.location.href = url;\n          return;\n          break;\n        case \"invalid_request\":\n          \n          break\n          case \"access_denied\":\n          \n            break\n        default:\n          if (sessionStorage.setItem(\"returnto\", \"/\"))\n            window.location.href = \"#login\";\n          return;\n          handled = true;\n          break;\n      }\n      if (!handled) {\n        var errorMessage = search.error_description\n        ? search.error_description\n        : search2.error\n        // alert(errorMessage\n          \n        // );\n        //window.location.href = sessionStorage.getItem(\"returnto\");\n        reject(errorMessage)\n        return;\n      }\n    }\n\n    switch (seq) {\n      case LOGIN:\n        sessionStorage.setItem(\"returnto\", window.location.href);\n      \n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}&nonce=1`;\n        window.location.href = url;\n        return;\n        break;\n      case GETACCESSTOKEN:\n        sessionStorage.setItem(\"returnto\", window.location.href);\n    \n        var url = `${host}?client_id=${client_id}&prompt=none&response_type=token&redirect_uri=${redirect_uri}&response_mode=${response_mode}&scope=${scope}`;\n        window.location.href = url;\n        return;\n        break;\n      case GETGRAPHUSER:\n        sessionStorage.removeItem(\"returnto\");\n\n        Axios.get(\"https://graph.microsoft.com/v1.0/me\", {\n          headers: {\n            \"content-type\": \"application/json\",\n            authorization: `Bearer ${sessionStorage.getItem(ACCESSTOKEN)}`,\n          },\n        })\n          .then((result) => {\n            resolve({ user: result.data });\n          })\n          .catch((error) => {\n            var txt = error.response.data.error.message;\n            if (\n              error &&\n              error.response &&\n              error.response.data &&\n              error.response.data.error\n            ) {\n              //alert(error.response.data.error.message)\n              resolve({ error: error.response.data.error.message });\n            } else {\n              resolve({ error });\n            }\n          });\n        break;\n\n      case RESTOREURL:\n        if (search.access_token) {\n          sessionStorage.setItem(ACCESSTOKEN, search.access_token);\n\n          var expires = moment().add(search.expires_in, \"s\");\n\n          sessionStorage.setItem(ACCESSEXPIRES, expires.toISOString());\n          if (sessionStorage.getItem(\"returnto\"))\n            window.location.href = sessionStorage.getItem(\"returnto\");\n          return;\n        } else {\n          window.location.reload();\n        }\n        resolve();\n        break;\n\n      default:\n        resolve({\n          error:\n            \"Sorry to have put you in this situation, but our authentication logic is not able to detect the next step to taka so we cannot let you in\",\n        });\n        break;\n    }\n  });\n}\n","import React from \"react\";\nimport { Link } from \"office-ui-fabric-react/lib/Link\";\nimport {\n  DetailsList,\n  Selection,\n  IColumn,\n  buildColumns,\n  IColumnReorderOptions,\n  IDragDropEvents,\n  IDragDropContext,\n} from \"office-ui-fabric-react/lib/DetailsList\";\nimport { MarqueeSelection } from \"office-ui-fabric-react/lib/MarqueeSelection\";\nimport { getTheme, mergeStyles } from \"office-ui-fabric-react/lib/Styling\";\nimport _ from \"lodash\";\nimport {\n  CommandBar,\n  ICommandBarItemProps,\n} from \"office-ui-fabric-react/lib/CommandBar\";\nimport { IButtonProps } from \"office-ui-fabric-react/lib/Button\";\n\nconst overflowProps = { ariaLabel: \"More commands\" };\nconst theme = getTheme();\nconst margin = \"0 30px 20px 0\";\nconst dragEnterClass = mergeStyles({\n  backgroundColor: theme.palette.neutralLight,\n});\nconst controlWrapperClass = mergeStyles({\n  display: \"flex\",\n  flexWrap: \"wrap\",\n});\nconst textFieldStyles = {\n  root: { margin: margin },\n  fieldGroup: { maxWidth: \"100px\" },\n};\nconst togglesStyles = { root: { margin } };\n\nexport class DragableDetailsList extends React.Component {\n  _selection;\n\n  _dragDropEvents;\n  _draggedItem;\n  _draggedIndex;\n\n  componentDidUpdate(prevProps, prevState) {\n    if (!_.isEqual(prevProps.items, this.props.items)) {\n      this.setState({\n        items: this.props.items,\n        columns: buildColumns(this.props.items, true),\n      });\n    }\n  }\n  cmdItems = () => {\n    var items = [];\n\n    switch (this._selection.getSelectedCount()) {\n      case 0:\n        items = [\n          {\n            key: \"newItem\",\n            text: \"New\",\n            cacheKey: \"myCacheKey\", // changing this key will invalidate this item's cache\n            iconProps: { iconName: \"Add\" },\n            //   subMenuProps: {\n            //     items: [\n            //       {\n            //         key: 'emailMessage',\n            //         text: 'Email message',\n            //         iconProps: { iconName: 'Mail' },\n            //         ['data-automation-id']: 'newEmailButton', // optional\n            //       },\n            //       {\n            //         key: 'calendarEvent',\n            //         text: 'Calendar event',\n            //         iconProps: { iconName: 'Calendar' },\n            //       },\n            //     ],\n            //   },\n          },\n          {\n            key: \"upload\",\n            text: \"Upload\",\n            iconProps: { iconName: \"Upload\" },\n            href: \"https://developer.microsoft.com/en-us/fluentui\",\n          }\n          \n        ];\n        break;\n      case 1:\n        items = [\n          {\n            key: \"share\",\n            text: \"Share\",\n\n            iconProps: { iconName: \"Share\" },\n            onClick: () => console.log(\"Share\"),\n          },\n          {\n            key: \"download\",\n            text: \"Download\",\n   \n            iconProps: { iconName: \"Download\" },\n            onClick: () => console.log(\"Download\"),\n          },\n         \n          {\n            key: \"delete\",\n            text: \"Delete\",\n \n            iconProps: { iconName: \"Delete\" },\n            onClick: () => console.log(\"Delete\"),\n          },\n        ];\n        break;\n      default:\n        items = [\n          {\n            key: \"share\",\n            text: \"Share\",\n\n            iconProps: { iconName: \"Share\" },\n            onClick: () => console.log(\"Share\"),\n          },\n          \n          {\n            key: \"download\",\n            text: \"Download\",\n\n            iconProps: { iconName: \"Download\" },\n            onClick: () => console.log(\"Download\"),\n          },\n          {\n            key: \"delete\",\n            text: \"Delete\",\n \n            iconProps: { iconName: \"Delete\" },\n            onClick: () => console.log(\"Delete\"),\n          },\n        ];\n        break;\n    }\n\n    return items;\n  };\n  constructor(props) {\n    super(props);\n    var that = this;\n    this._selection = new Selection({\n      selectionMode: 2,\n      onSelectionChanged: (x, y) => {\n        console.log(this._draggedIndex);\n        this.setState({ _items: this.cmdItems() });\n      },\n    });\n\n    this._dragDropEvents = this._getDragDropEvents();\n    this._draggedIndex = -1;\n    //const items = [] // createListItems(10, 0);\n\n    this.state = {\n      items: props.items,\n      columns: buildColumns(props.items, true),\n      isColumnReorderEnabled: false,\n      frozenColumnCountFromStart: \"0\",\n      frozenColumnCountFromEnd: \"0\",\n      _items: this.cmdItems(),\n\n      _overflowItems: [\n        {\n          key: \"move\",\n          text: \"Move to...\",\n          onClick: () => console.log(\"Move to\"),\n          iconProps: { iconName: \"MoveToFolder\" },\n        },\n        {\n          key: \"copy\",\n          text: \"Copy to...\",\n          onClick: () => console.log(\"Copy to\"),\n          iconProps: { iconName: \"Copy\" },\n        },\n        {\n          key: \"rename\",\n          text: \"Rename...\",\n          onClick: () => console.log(\"Rename\"),\n          iconProps: { iconName: \"Edit\" },\n        },\n      ],\n\n      _farItems: [\n        // {\n        //   key: \"tile\",\n        //   text: \"Grid view\",\n        //   // This needs an ariaLabel since it's icon-only\n        //   ariaLabel: \"Grid view\",\n        //   iconOnly: true,\n        //   iconProps: { iconName: \"Tiles\" },\n        //   onClick: () => console.log(\"Tiles\"),\n        // },\n        {\n          key: \"info\",\n          text: \"Info\",\n          // This needs an ariaLabel since it's icon-only\n          ariaLabel: \"Info\",\n          iconOnly: true,\n          iconProps: { iconName: \"Info\" },\n          onClick: () => console.log(\"Info\"),\n        },\n      ],\n    };\n  }\n\n  render() {\n    const {\n      items,\n      columns,\n      isColumnReorderEnabled,\n      frozenColumnCountFromStart,\n      frozenColumnCountFromEnd,\n      _items,\n      _overflowItems,\n      _farItems,\n    } = this.state;\n\n    return (\n      <div>\n        <CommandBar\n          items={_items}\n          overflowItems={_overflowItems}\n          overflowButtonProps={overflowProps}\n          farItems={_farItems}\n          ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n        />\n        <MarqueeSelection selection={this._selection}>\n          <DetailsList\n            setKey=\"items\"\n            items={items}\n            columns={columns}\n            selection={this._selection}\n            selectionPreservedOnEmptyClick={true}\n            onItemInvoked={this._onItemInvoked}\n            onRenderItemColumn={this._onRenderItemColumn}\n            dragDropEvents={this._dragDropEvents}\n            columnReorderOptions={\n              this.state.isColumnReorderEnabled\n                ? this._getColumnReorderOptions()\n                : undefined\n            }\n            ariaLabelForSelectionColumn=\"Toggle selection\"\n            ariaLabelForSelectAllCheckbox=\"Toggle selection for all items\"\n            checkButtonAriaLabel=\"Row checkbox\"\n          />\n        </MarqueeSelection>\n      </div>\n    );\n  }\n\n  _handleColumnReorder = (draggedIndex, targetIndex) => {\n    const draggedItems = this.state.columns[draggedIndex];\n    const newColumns = [...this.state.columns];\n\n    // insert before the dropped item\n    newColumns.splice(draggedIndex, 1);\n    newColumns.splice(targetIndex, 0, draggedItems);\n    this.setState({ columns: newColumns });\n  };\n\n  _getColumnReorderOptions() {\n    return {\n      frozenColumnCountFromStart: parseInt(\n        this.state.frozenColumnCountFromStart,\n        10\n      ),\n      frozenColumnCountFromEnd: parseInt(\n        this.state.frozenColumnCountFromEnd,\n        10\n      ),\n      handleColumnReorder: this._handleColumnReorder,\n    };\n  }\n\n  _validateNumber(value) {\n    return isNaN(Number(value))\n      ? `The value should be a number, actual is ${value}.`\n      : \"\";\n  }\n\n  _onChangeStartCountText = (event, text) => {\n    this.setState({ frozenColumnCountFromStart: text });\n  };\n\n  _onChangeEndCountText = (event, text) => {\n    this.setState({ frozenColumnCountFromEnd: text });\n  };\n\n  _onChangeColumnReorderEnabled = (ev, checked) => {\n    this.setState({ isColumnReorderEnabled: checked });\n  };\n\n  _getDragDropEvents() {\n    return {\n      canDrop: (dropContext, dragContext) => {\n        return true;\n      },\n      canDrag: (item) => {\n        return true;\n      },\n      onDragEnter: (item, event) => {\n        // return string is the css classes that will be added to the entering element.\n        return dragEnterClass;\n      },\n      onDragLeave: (item, event) => {\n        return;\n      },\n      onDrop: (item, event) => {\n        if (this._draggedItem) {\n          this._insertBeforeItem(item);\n        }\n      },\n      onDragStart: (item, itemIndex, selectedItems, event) => {\n        this._draggedItem = item;\n        this._draggedIndex = itemIndex;\n      },\n      onDragEnd: (item, event) => {\n        this._draggedItem = undefined;\n        this._draggedIndex = -1;\n      },\n    };\n  }\n\n  _onItemInvoked = (item) => {\n    alert(`Item invoked: ${item.name}`);\n  };\n\n  _onRenderItemColumn = (item, index, column) => {\n    const key = column.key;\n    if (key === \"name\") {\n      return <Link data-selection-invoke={true}>{item[key]}</Link>;\n    }\n\n    return String(item[key]);\n  };\n\n  _insertBeforeItem(item) {\n    const draggedItems = this._selection.isIndexSelected(this._draggedIndex)\n      ? this._selection.getSelection()\n      : [this._draggedItem];\n\n    const insertIndex = this.state.items.indexOf(item);\n    const items = this.state.items.filter(\n      (itm) => draggedItems.indexOf(itm) === -1\n    );\n\n    items.splice(insertIndex, 0, ...draggedItems);\n\n    this.setState({ items });\n  }\n}\n","/* \nTool Catalogue\n\nCopyright (c) jumpto365, Inc\n\nAll rights reserved.\n\nMIT License\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"\"Software\"\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED *AS IS*, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n * \n * Written by Niels Gregers Johansen <niels@jumpto365.com>, December 2019\n */\nimport React, { Component, useState, useEffect } from \"react\";\n\nimport \"../App.css\";\nimport \"../css/normalize.css\";\nimport \"../css/webflow.css\";\nimport \"../css/swimlane-process-map.webflow.css\";\n\nimport _ from \"lodash\";\nimport {\n\n  readBoards,\n} from \"../helpers/LaunchPad\";\nimport { DragableDetailsList } from \"../components/DragableDetailsList\";\nimport { CommandBar } from \"@fluentui/react\";\n\nimport config from \"../config\";\n\n\n\n\nfunction inIframe() {\n  try {\n    return window.self !== window.top;\n  } catch (e) {\n    return true;\n  }\n}\nexport default function Boards(props) {\n  const [boards, setBoards] = useState([]);\n  const [boardItems, setBoardItems] = useState([]);\n  const inFrame = inIframe();\n\n  useEffect(() => {\n    async function run() {\n      var _boards = await readBoards()\n      setBoards(_boards);\n      var boardItems = (_boards?_boards:[]).map(board=>{\n        \n        return {\n          name:board.file.name,\n          color:\"#000000\",backgroundColor:\"#b3e6a9\",\n          items: board.content.myTeams.length + \" items\"\n        }\n      })\n      \n      setBoardItems(boardItems)\n      // await verifyAccessForLanuchPad(setCheckMe, setCheckMyExtention, setCheckOneDrive, setCheckOneDriveFiles, setCheckMemberships, setCheckTeam);\n    }\n    run();\n  }, []);\n\n  return (\n    <div>\n       {!inFrame && config.components.header}\n      <CommandBar />\n  <DragableDetailsList items={boardItems}/>\n    </div>\n  );\n}\n\nfunction LaunzhContext(props) {\n  if (!props.launzhContext) return null\n  \n  return <div>\n{props.launzhContext.file.webUrl}\n\n  </div>;\n}\n\n\n\n\n\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport Onboard from \"./Onboard\";\nimport config from \"./config\";\nimport { authenticate } from \"./authenticate\";\n\nimport { FluentCustomizations } from \"@uifabric/fluent-theme\";\nimport { Customizer, mergeStyles, Fabric } from \"office-ui-fabric-react\";\nimport { loadTheme } from \"@fluentui/react\";\nimport { EVENT, who, trace } from \"./helpers/trace\";\n\nimport { Router, Link } from \"@reach/router\";\nimport {\n  MessageBarButton,\n  DefaultButton,\n} from \"office-ui-fabric-react/lib/Button\";\nimport Boards from \"./containers/Boards\";\nimport { indexLaunzhBoards } from \"./helpers/LaunchPad\";\n\nexport default class ErrorBoundary extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error) {\n    // Update state so the next render will show the fallback UI.\n    return { hasError: true };\n  }\n\n  componentDidCatch(error, info) {\n    // You can also log the error to an error reporting service\n    this.setState({ error, info });\n    console.log(\"componentDidCatch\", error, info);\n    //logErrorToMyService(error, info);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      // You can render any custom fallback UI\n      return (\n        <div className=\"pageBody\">\n          <h1 className=\"errorCenterHeader\">\n            Sorry! Something not working as expected\n          </h1>\n          {this.state.error && this.state.error.message && (\n            <h2>{this.state.error.message}</h2>\n          )}\n          <div className=\"errorCenterHeader\">\n            <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                primary\n                text=\"Visit our Help Center\"\n                onClick={() => {\n                  window.open(\n                    \"https://jumpto365.zendesk.com/hc/en-us\",\n                    \"_blank\"\n                  );\n                }}\n              />\n            </div>\n            <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                text=\"Check service availabiliy\"\n                onClick={() => {\n                  window.open(\"https://uptime.com/s/overview\", \"_blank\");\n                }}\n              />\n            </div>\n            {/* <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                text=\"File a support request\"\n                onClick={() => {\n                  if (window.zE) {\n                    zE(function() {\n                      debugger;\n                    });\n                  }\n                }}\n              />\n            </div> */}\n\n            <div>\n              <DefaultButton\n                style={{ margin: \"16px\", width: \"300px\" }}\n                text=\"View error details\"\n                onClick={() => {\n                  this.setState({ viewDetails: true });\n                }}\n              />\n            </div>\n          </div>\n          {this.state.info &&\n          this.state.info.componentStack &&\n          this.state.viewDetails ? (\n            <div>\n              <textarea\n                style={{ width: \"100%\" }}\n                readOnly\n                rows=\"30\"\n                cols=\"80\"\n                value={this.state.info.componentStack}\n              />{\" \"}\n            </div>\n          ) : null}\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nvar x = loadTheme({\n  defaultFontStyle: {\n    fontFamily: \"Monaco, Menlo, Consolas\",\n    fontWeight: \"regular\",\n  },\n  fonts: {\n    small: {\n      fontSize: \"11px\",\n    },\n    medium: {\n      fontSize: \"13px\",\n    },\n    large: {\n      fontSize: \"20px\",\n      fontWeight: \"semibold\",\n    },\n    xLarge: {\n      fontSize: \"22px\",\n      fontWeight: \"semibold\",\n    },\n  },\n});\n\n// // Inject some global styles\n// mergeStyles({\n//   selectors: {\n//     ':global(body), :global(html), :global(#root)': {\n//       margin: 0,\n//       padding: 0,\n//       height: '100vh'\n//     }\n//   }\n// });\nasync function start() {\n  var auth = await authenticate(config, () => {\n    // this is where you can send a signal to a host that intercati ons is required\n  }).catch((error) => {\n    console.log(error);\n    document.getElementById(\"root\").innerHTML = error;\n    return;\n  });\n\n  if (auth && auth.user) {\n    who(auth.user.userPrincipalName);\n    const key = \"HASLANDED\";\n\n    var landed = sessionStorage.getItem(key);\n    if (!landed) {\n      trace(EVENT.LANDING);\n      sessionStorage.setItem(key, \"1\");\n    }\n\n    ReactDOM.render(\n      <Customizer {...FluentCustomizations}>\n        <Fabric theme={x}>\n          <ErrorBoundary auth={auth}>\n            <Router>\n              <Onboard path=\"/check\" />\n              <Boards path=\"/boards\" />\n              <App auth={auth} path=\"/\" />\n              <App auth={auth} path=\"/board/:board\" />\n              <App auth={auth} path=\"/board\" />\n            </Router>\n          </ErrorBoundary>\n        </Fabric>\n      </Customizer>,\n      document.getElementById(\"root\")\n    );\n  } else {\n    ReactDOM.render(\n      <Customizer {...FluentCustomizations}>\n        <Fabric theme={x}>\n          <ErrorBoundary auth={auth}>\n            <h1>Sorry, can't let you in</h1>\n            <Onboard />\n          </ErrorBoundary>\n        </Fabric>\n      </Customizer>,\n      document.getElementById(\"root\")\n    );\n  }\n}\n\nstart();\n"],"sourceRoot":""}